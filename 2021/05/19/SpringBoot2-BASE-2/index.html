<!DOCTYPE html>
<html lang="en">
<head>

    <!--[if lt IE 9]>
        <style>body {display: none; background: none !important} </style>
        <meta http-equiv="Refresh" Content="0; url=//outdatedbrowser.com/" />
    <![endif]-->

<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="format-detection" content="telephone=no" />
<meta name="author" content="Sevattal" />



<meta name="description" content="SpringBoot2 基础篇 2转载：https:&#x2F;&#x2F;blog.csdn.net&#x2F;u011863024&#x2F;article&#x2F;details&#x2F;113667634 1. 配置文件-yaml的用法同以前的properties用法 YAML 是 “YAML Ain’t Markup Language”（YAML 不是一种标记语言）的递归缩写。在开发的这种语言时，YAML 的意思其实是：“Yet Anothe">
<meta property="og:type" content="article">
<meta property="og:title" content="SpringBoot2-BASE-2">
<meta property="og:url" content="http://yoursite.com/2021/05/19/SpringBoot2-BASE-2/index.html">
<meta property="og:site_name" content="Sevattal">
<meta property="og:description" content="SpringBoot2 基础篇 2转载：https:&#x2F;&#x2F;blog.csdn.net&#x2F;u011863024&#x2F;article&#x2F;details&#x2F;113667634 1. 配置文件-yaml的用法同以前的properties用法 YAML 是 “YAML Ain’t Markup Language”（YAML 不是一种标记语言）的递归缩写。在开发的这种语言时，YAML 的意思其实是：“Yet Anothe">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://yoursite.com/2021/05/19/SpringBoot2-BASE-2/1.png">
<meta property="og:image" content="http://yoursite.com/2021/05/19/SpringBoot2-BASE-2/2.png">
<meta property="og:image" content="http://yoursite.com/2021/05/19/SpringBoot2-BASE-2/3.png">
<meta property="og:image" content="http://yoursite.com/2021/05/19/SpringBoot2-BASE-2/4.png">
<meta property="og:image" content="http://yoursite.com/2021/05/19/SpringBoot2-BASE-2/5.png">
<meta property="og:image" content="http://yoursite.com/2021/05/19/SpringBoot2-BASE-2/6.png">
<meta property="og:image" content="http://yoursite.com/2021/05/19/SpringBoot2-BASE-2/7.png">
<meta property="article:published_time" content="2021-05-19T06:17:31.000Z">
<meta property="article:modified_time" content="2022-11-18T01:11:44.080Z">
<meta property="article:author" content="Sevattal">
<meta property="article:tag" content="Spring">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://yoursite.com/2021/05/19/SpringBoot2-BASE-2/1.png">

<link rel="apple-touch-icon" href= "/apple-touch-icon.png">


    <link rel="alternate" href="/atom.xml" title="Sevattal" type="application/atom+xml">



    <link rel="shortcut icon" href="/favicon.png">



    <link href="//cdn.bootcss.com/animate.css/3.5.1/animate.min.css" rel="stylesheet">



    <link href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.css" rel="stylesheet">



    <script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
    <link href="//cdn.bootcss.com/pace/1.0.2/themes/blue/pace-theme-minimal.css" rel="stylesheet">



<link rel="stylesheet" href="/css/style.css">




<link href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">


<title>SpringBoot2-BASE-2 | Sevattal</title>

<script src="//cdn.bootcss.com/jquery/2.2.4/jquery.min.js"></script>
<script src="//cdn.bootcss.com/clipboard.js/1.5.10/clipboard.min.js"></script>

<script>
    var yiliaConfig = {
        fancybox: true,
        animate: true,
        isHome: false,
        isPost: true,
        isArchive: false,
        isTag: false,
        isCategory: false,
        fancybox_js: "//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.js",
        scrollreveal: "//cdn.bootcss.com/scrollReveal.js/3.1.4/scrollreveal.min.js",
        search: true
    }
</script>


    <script> yiliaConfig.jquery_ui = [false]; </script>



    <script> yiliaConfig.rootUrl = "\/";</script>






<meta name="generator" content="Hexo 6.3.0"></head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        <a href="/" class="profilepic">
            <img src="/img/my_img1.png" class="animated zoomIn">
        </a>
        <hgroup>
          <h1 class="header-author"><a href="/"></a></h1>
        </hgroup>

        

        
            <form id="search-form">
            <input type="text" id="local-search-input" name="q" placeholder="search..." class="search form-control" autocomplete="off" autocorrect="off" searchonload="false" />
            <i class="fa fa-times" onclick="resetSearch()"></i>
            </form>
            <div id="local-search-result"></div>
            <p class='no-result'>No results found <i class='fa fa-spinner fa-pulse'></i></p>
        


        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        <div class="icon-wrap icon-link hide" data-idx="2">
                            <div class="loopback_l"></div>
                            <div class="loopback_r"></div>
                        </div>
                        
                        
                        <div class="icon-wrap icon-me hide" data-idx="3">
                            <div class="user"></div>
                            <div class="shoulder"></div>
                        </div>
                        
                    </div>
                    
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>Menu</li>
                        <li>Tags</li>
                        
                        <li>Friends</li>
                        
                        
                        <li>About Me</li>
                        
                    </ul>
                </div>
            </div>
        

        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a href="/">主页</a></li>
                        
                            <li><a href="/tags/">标签云</a></li>
                        
                            <li><a href="/about_me/">关于我</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa Email" href="mailto:923762269@qq.com" title="Email"></a>
                            
                                <a class="fa GitHub" target="_blank" rel="noopener" href="https://sevattal.github.io" title="GitHub"></a>
                            
                        </ul>
                    </nav>
                </section>
                
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/ACL/" rel="tag">ACL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ASM/" rel="tag">ASM</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Ansible/" rel="tag">Ansible</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Backup/" rel="tag">Backup</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Bus/" rel="tag">Bus</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CRM/" rel="tag">CRM</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Cisco/" rel="tag">Cisco</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Config/" rel="tag">Config</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Consul/" rel="tag">Consul</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Corosync-Pacemaker-CRM/" rel="tag">Corosync-Pacemaker-CRM</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Crontab/" rel="tag">Crontab</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DG/" rel="tag">DG</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DM-Database/" rel="tag">DM Database</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DRBD/" rel="tag">DRBD</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/EIGRP/" rel="tag">EIGRP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/EXP/" rel="tag">EXP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Elasticsearch/" rel="tag">Elasticsearch</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Eureka/" rel="tag">Eureka</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/FFmpeg/" rel="tag">FFmpeg</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/FlashBack/" rel="tag">FlashBack</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Flask-SQLalchemy/" rel="tag">Flask-SQLalchemy</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/GCC/" rel="tag">GCC</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/GateWay/" rel="tag">GateWay</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HTML/" rel="tag">HTML</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HUAWEI/" rel="tag">HUAWEI</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hexo/" rel="tag">Hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hystrix/" rel="tag">Hystrix</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Interview/" rel="tag">Interview</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JMeter/" rel="tag">JMeter</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Job/" rel="tag">Job</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Kubernetes/" rel="tag">Kubernetes</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/LVM/" rel="tag">LVM</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Lightroom/" rel="tag">Lightroom</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Mail/" rel="tag">Mail</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Maven/" rel="tag">Maven</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MongDB/" rel="tag">MongDB</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Mysql/" rel="tag">Mysql</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Mysql-Lock/" rel="tag">Mysql-Lock</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MysqlDump/" rel="tag">MysqlDump</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NAT/" rel="tag">NAT</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NTP/" rel="tag">NTP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Nacos/" rel="tag">Nacos</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Neo4j/" rel="tag">Neo4j</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Netty/" rel="tag">Netty</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NetworkCard/" rel="tag">NetworkCard</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Nginx/" rel="tag">Nginx</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Nmap/" rel="tag">Nmap</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/OSPF/" rel="tag">OSPF</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/OpenFeign/" rel="tag">OpenFeign</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/OpenSSH/" rel="tag">OpenSSH</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Oracle/" rel="tag">Oracle</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Oracle-RAC/" rel="tag">Oracle RAC</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Oracle-Inspection/" rel="tag">Oracle-Inspection</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Oracle-Name/" rel="tag">Oracle-Name</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PGPool-II/" rel="tag">PGPool-II</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Postgres/" rel="tag">Postgres</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Postgres-PGPool-II/" rel="tag">Postgres+PGPool-II</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Postgres-Copy/" rel="tag">Postgres-Copy</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Procedure/" rel="tag">Procedure</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RAC/" rel="tag">RAC</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RMAN/" rel="tag">RMAN</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Rancher/" rel="tag">Rancher</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Redis/" rel="tag">Redis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Redis-AOF/" rel="tag">Redis-AOF</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Redis-Cluster/" rel="tag">Redis-Cluster</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Redis-Copy/" rel="tag">Redis-Copy</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Redis-Memory/" rel="tag">Redis-Memory</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Redis-RDB/" rel="tag">Redis-RDB</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Redis-Sentinel/" rel="tag">Redis-Sentinel</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Regedit/" rel="tag">Regedit</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Restore/" rel="tag">Restore</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Ribbon/" rel="tag">Ribbon</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Route/" rel="tag">Route</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SNMP/" rel="tag">SNMP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SSH/" rel="tag">SSH</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/STP/" rel="tag">STP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Scrapy/" rel="tag">Scrapy</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Sentinel/" rel="tag">Sentinel</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ShareDisk/" rel="tag">ShareDisk</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Sleuth/" rel="tag">Sleuth</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Spring/" rel="tag">Spring</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Spring-Security/" rel="tag">Spring Security</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Stream/" rel="tag">Stream</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Supervisor/" rel="tag">Supervisor</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Swap/" rel="tag">Swap</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Switch/" rel="tag">Switch</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TinyProxy/" rel="tag">TinyProxy</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Tomcat/" rel="tag">Tomcat</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Trigger/" rel="tag">Trigger</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/USB/" rel="tag">USB</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/VLAN/" rel="tag">VLAN</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/VMware/" rel="tag">VMware</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/VTP/" rel="tag">VTP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Video-Clip/" rel="tag">Video-Clip</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/XtraBackup/" rel="tag">XtraBackup</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Yaml/" rel="tag">Yaml</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Zabbix/" rel="tag">Zabbix</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Zookeeper/" rel="tag">Zookeeper</a></li></ul>
                    </div>
                </section>
                
                
                
                <section class="switch-part switch-part3">
                    <div id="js-friends">
                    
                      <a class="main-nav-link switch-friends-link" target="_blank" rel="noopener" href="https://sevattal.github.com/">GitHub</a>
                    
                    </div>
                </section>
                

                
                
                <section class="switch-part switch-part4">
                
                    <div id="js-aboutme">乌拉乌拉乌拉乌拉乌拉乌拉</div>
                </section>
                
            </div>
        </div>
    </header>                
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页"></a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                <img src="/img/my_img1.png" class="animated zoomIn">
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="回到主页"></a></h1>
            </hgroup>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/">主页</a></li>
                
                    <li><a href="/tags/">标签云</a></li>
                
                    <li><a href="/about_me/">关于我</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa Email" target="_blank" href="mailto:923762269@qq.com" title="Email"></a>
                            
                                <a class="fa GitHub" target="_blank" href="https://sevattal.github.io" title="GitHub"></a>
                            
                        </ul>
            </nav>
        </header>                
    </div>
    <link class="menu-list" tags="Tags" friends="Friends" about="About Me"/>
</nav>
      <div class="body-wrap"><article id="post-SpringBoot2-BASE-2" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2021/05/19/SpringBoot2-BASE-2/" class="article-date">
      <time datetime="2021-05-19T06:17:31.000Z" itemprop="datePublished">2021-05-19</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      SpringBoot2-BASE-2
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/JAVA/">JAVA</a>
    </div>


        
    <div class="article-tag tagcloud">
        <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Spring/" rel="tag">Spring</a></li></ul>
    </div>

        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h1 id="SpringBoot2-基础篇-2"><a href="#SpringBoot2-基础篇-2" class="headerlink" title="SpringBoot2 基础篇 2"></a>SpringBoot2 基础篇 2</h1><p>转载：<a target="_blank" rel="noopener" href="https://blog.csdn.net/u011863024/article/details/113667634">https://blog.csdn.net/u011863024/article/details/113667634</a></p>
<h2 id="1-配置文件-yaml的用法"><a href="#1-配置文件-yaml的用法" class="headerlink" title="1. 配置文件-yaml的用法"></a>1. 配置文件-yaml的用法</h2><p>同以前的properties用法</p>
<p>YAML 是 “YAML Ain’t Markup Language”（YAML 不是一种标记语言）的递归缩写。在开发的这种语言时，YAML 的意思其实是：“Yet Another Markup Language”（仍是一种标记语言）。</p>
<p><strong>非常适合用来做以数据为中心的配置文件。</strong></p>
<h3 id="基本语法"><a href="#基本语法" class="headerlink" title="基本语法"></a>基本语法</h3><pre><code>key: value；kv之间有空格
大小写敏感
使用缩进表示层级关系
缩进不允许使用tab，只允许空格
缩进的空格数不重要，只要相同层级的元素左对齐即可
&#39;#&#39;表示注释
字符串无需加引号，如果要加，单引号’’、双引号&quot;&quot;表示字符串内容会被 转义、不转义
</code></pre>
<h3 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型"></a>数据类型</h3><p><strong>字面量：单个的、不可再分的值。date、boolean、string、number、null</strong></p>
<pre><code>k: v
</code></pre>
<span id="more"></span>

<p><strong>对象：键值对的集合。map、hash、set、object</strong></p>
<pre><code>#行内写法：  
k: &#123;k1:v1,k2:v2,k3:v3&#125;
#或
k: 
  k1: v1
  k2: v2
  k3: v3
</code></pre>
<p><strong>数组：一组按次序排列的值。array、list、queue</strong></p>
<pre><code>#行内写法：  
k: [v1,v2,v3]
#或者
k:
 - v1
 - v2
 - v3
</code></pre>
<h3 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h3><pre><code>@Data
public class Person &#123;
    private String userName;
    private Boolean boss;
    private Date birth;
    private Integer age;
    private Pet pet;
    private String[] interests;
    private List&lt;String&gt; animal;
    private Map&lt;String, Object&gt; score;
    private Set&lt;Double&gt; salarys;
    private Map&lt;String, List&lt;Pet&gt;&gt; allPets;
&#125;

@Data
public class Pet &#123;
    private String name;
    private Double weight;
&#125;
</code></pre>
<p><strong>用yaml表示以上对象</strong></p>
<pre><code>person:
  userName: zhangsan
  boss: false
  birth: 2019/12/12 20:12:33
  age: 18
  pet: 
    name: tomcat
    weight: 23.4
  interests: [篮球,游泳]
  animal: 
    - jerry
    - mario
  score:
    english: 
      first: 30
      second: 40
      third: 50
    math: [131,140,148]
    chinese: &#123;first: 128,second: 136&#125;
  salarys: [3999,4999.98,5999.99]
  allPets:
    sick:
      - &#123;name: tom&#125;
      - &#123;name: jerry,weight: 47&#125;
    health: [&#123;name: mario,weight: 47&#125;]
</code></pre>
<h2 id="2-配置文件-自定义类绑定的配置提示"><a href="#2-配置文件-自定义类绑定的配置提示" class="headerlink" title="2. 配置文件-自定义类绑定的配置提示"></a>2. 配置文件-自定义类绑定的配置提示</h2><p>You can easily generate your own configuration metadata file from items annotated with @ConfigurationProperties by using the spring-boot-configuration-processor jar. The jar includes a Java annotation processor which is invoked as your project is compiled.——link</p>
<p>自定义的类和配置文件绑定一般没有提示。若要提示，添加如下依赖：</p>
<pre><code>&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-configuration-processor&lt;/artifactId&gt;
    &lt;optional&gt;true&lt;/optional&gt;
&lt;/dependency&gt;

&lt;!-- 下面插件作用是工程打包时，不将spring-boot-configuration-processor打进包内，让其只在编码的时候有用 --&gt;
&lt;build&gt;
    &lt;plugins&gt;
        &lt;plugin&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;
            &lt;configuration&gt;
                &lt;excludes&gt;
                    &lt;exclude&gt;
                        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
                        &lt;artifactId&gt;spring-boot-configuration-processor&lt;/artifactId&gt;
                    &lt;/exclude&gt;
                &lt;/excludes&gt;
            &lt;/configuration&gt;
        &lt;/plugin&gt;
    &lt;/plugins&gt;
&lt;/build&gt;
</code></pre>
<h2 id="3-web场景-web开发简介"><a href="#3-web场景-web开发简介" class="headerlink" title="3. web场景-web开发简介"></a>3. web场景-web开发简介</h2><p>Spring Boot provides auto-configuration for Spring MVC that works well with most applications.(大多场景我们都无需自定义配置)</p>
<p>The auto-configuration adds the following features on top of Spring’s defaults:</p>
<pre><code>Inclusion of ContentNegotiatingViewResolver and BeanNameViewResolver beans.
    内容协商视图解析器和BeanName视图解析器

Support for serving static resources, including support for WebJars (covered later in this document)).
    静态资源（包括webjars）

Automatic registration of Converter, GenericConverter, and Formatter beans.
    自动注册 Converter，GenericConverter，Formatter

Support for HttpMessageConverters (covered later in this document).
    支持 HttpMessageConverters （后来我们配合内容协商理解原理）

Automatic registration of MessageCodesResolver (covered later in this document).
    自动注册 MessageCodesResolver （国际化用）

Static index.html support.
    静态index.html 页支持

Custom Favicon support (covered later in this document).
    自定义 Favicon

Automatic use of a ConfigurableWebBindingInitializer bean (covered later in this document).
    自动使用 ConfigurableWebBindingInitializer ，（DataBinder负责将请求数据绑定到JavaBean上）
</code></pre>
<p>If you want to keep those Spring Boot MVC customizations and make more MVC customizations (interceptors, formatters, view controllers, and other features), you can add your own @Configuration class of type WebMvcConfigurer but without @EnableWebMvc.</p>
<p><strong>不用@EnableWebMvc注解。使用 @Configuration + WebMvcConfigurer 自定义规则</strong></p>
<p>If you want to provide custom instances of RequestMappingHandlerMapping, RequestMappingHandlerAdapter, or ExceptionHandlerExceptionResolver, and still keep the Spring Boot MVC customizations, you can declare a bean of type WebMvcRegistrations and use it to provide custom instances of those components.</p>
<p><strong>声明 WebMvcRegistrations 改变默认底层组件</strong></p>
<p>If you want to take complete control of Spring MVC, you can add your own @Configuration annotated with @EnableWebMvc, or alternatively add your own @Configuration-annotated DelegatingWebMvcConfiguration as described in the Javadoc of @EnableWebMvc.</p>
<p><strong>使用 @EnableWebMvc+@Configuration+DelegatingWebMvcConfiguration全面接管SpringMVC</strong></p>
<h2 id="4-web场景-静态资源规则与定制化"><a href="#4-web场景-静态资源规则与定制化" class="headerlink" title="4. web场景-静态资源规则与定制化"></a>4. web场景-静态资源规则与定制化</h2><h3 id="静态资源目录"><a href="#静态资源目录" class="headerlink" title="静态资源目录"></a>静态资源目录</h3><p>只要静态资源放在类路径下： called &#x2F;static (or &#x2F;public or &#x2F;resources or &#x2F;META-INF&#x2F;resources</p>
<p>访问 ： 当前项目根路径&#x2F; + 静态资源名</p>
<p>原理： 静态映射&#x2F;&amp;#42;&amp;#42;。</p>
<p>请求进来，先去找Controller看能不能处理。不能处理的所有请求又都交给静态资源处理器。静态资源也找不到则响应404页面。</p>
<p>也可以改变默认的静态资源路径，&#x2F;static，&#x2F;public,&#x2F;resources, &#x2F;META-INF&#x2F;resources失效</p>
<pre><code>spring:
    resources:
      static-locations: [classpath:/haha/]
</code></pre>
<h3 id="静态资源访问前缀"><a href="#静态资源访问前缀" class="headerlink" title="静态资源访问前缀"></a>静态资源访问前缀</h3><pre><code>spring:
  mvc:
    static-path-pattern: /res/**
</code></pre>
<p>当前项目 + static-path-pattern + 静态资源名 &#x3D; 静态资源文件夹下找</p>
<h3 id="webjar"><a href="#webjar" class="headerlink" title="webjar"></a>webjar</h3><p>可用jar方式添加css，js等资源文件，</p>
<p><a target="_blank" rel="noopener" href="https://www.webjars.org/">https://www.webjars.org/</a></p>
<p>例如，添加jquery</p>
<pre><code>&lt;dependency&gt;
    &lt;groupId&gt;org.webjars&lt;/groupId&gt;
    &lt;artifactId&gt;jquery&lt;/artifactId&gt;
    &lt;version&gt;3.5.1&lt;/version&gt;
&lt;/dependency&gt;
</code></pre>
<p>访问地址：<a target="_blank" rel="noopener" href="http://localhost:8080/webjars/jquery/3.5.1/jquery.js">http://localhost:8080/webjars/jquery/3.5.1/jquery.js</a> 后面地址要按照依赖里面的包路径。</p>
<h2 id="5-web场景-welcome与favicon功能"><a href="#5-web场景-welcome与favicon功能" class="headerlink" title="5. web场景-welcome与favicon功能"></a>5. web场景-welcome与favicon功能</h2><p>官方文档:<a target="_blank" rel="noopener" href="https://docs.spring.io/spring-boot/docs/2.3.8.RELEASE/reference/htmlsingle/#boot-features-spring-mvc-welcome-page">https://docs.spring.io/spring-boot/docs/2.3.8.RELEASE/reference/htmlsingle/#boot-features-spring-mvc-welcome-page</a></p>
<h3 id="欢迎页支持"><a href="#欢迎页支持" class="headerlink" title="欢迎页支持"></a>欢迎页支持</h3><pre><code>静态资源路径下 index.html。
    可以配置静态资源路径
    但是不可以配置静态资源的访问前缀。否则导致 index.html不能被默认访问

spring:
#  mvc:
#    static-path-pattern: /res/**   这个会导致welcome page功能失效
  resources:
    static-locations: [classpath:/haha/]
</code></pre>
<p>controller能处理&#x2F;index。</p>
<h3 id="自定义Favicon"><a href="#自定义Favicon" class="headerlink" title="自定义Favicon"></a>自定义Favicon</h3><p>指网页标签上的小图标。</p>
<p>favicon.ico 放在静态资源目录下即可。</p>
<pre><code>spring:
#  mvc:
#    static-path-pattern: /res/**   这个会导致 Favicon 功能失效
</code></pre>
<h2 id="6-web场景-【源码分析】-静态资源原理"><a href="#6-web场景-【源码分析】-静态资源原理" class="headerlink" title="6. web场景-【源码分析】-静态资源原理"></a>6. web场景-【源码分析】-静态资源原理</h2><pre><code>SpringBoot启动默认加载 xxxAutoConfiguration 类（自动配置类）
SpringMVC功能的自动配置类WebMvcAutoConfiguration，生效
@Configuration(proxyBeanMethods = false)
@ConditionalOnWebApplication(type = Type.SERVLET)
@ConditionalOnClass(&#123; Servlet.class, DispatcherServlet.class, WebMvcConfigurer.class &#125;)
@ConditionalOnMissingBean(WebMvcConfigurationSupport.class)
@AutoConfigureOrder(Ordered.HIGHEST_PRECEDENCE + 10)
@AutoConfigureAfter(&#123; DispatcherServletAutoConfiguration.class, TaskExecutionAutoConfiguration.class,
        ValidationAutoConfiguration.class &#125;)
public class WebMvcAutoConfiguration &#123;
    ...
&#125;
</code></pre>
<p>给容器中配置的内容：<br>配置文件的相关属性的绑定：WebMvcProperties&#x3D;&#x3D;spring.mvc、ResourceProperties&#x3D;&#x3D;spring.resources</p>
<pre><code>@Configuration(proxyBeanMethods = false)
@Import(EnableWebMvcConfiguration.class)
@EnableConfigurationProperties(&#123; WebMvcProperties.class, ResourceProperties.class &#125;)
@Order(0)
public static class WebMvcAutoConfigurationAdapter implements WebMvcConfigurer &#123;
    ...
&#125;
</code></pre>
<h3 id="配置类只有一个有参构造器"><a href="#配置类只有一个有参构造器" class="headerlink" title="配置类只有一个有参构造器"></a>配置类只有一个有参构造器</h3><p>有参构造器所有参数的值都会从容器中确定</p>
<pre><code>public WebMvcAutoConfigurationAdapter(WebProperties webProperties, WebMvcProperties mvcProperties,
        ListableBeanFactory beanFactory, ObjectProvider&lt;HttpMessageConverters&gt; messageConvertersProvider,
        ObjectProvider&lt;ResourceHandlerRegistrationCustomizer&gt; resourceHandlerRegistrationCustomizerProvider,
        ObjectProvider&lt;DispatcherServletPath&gt; dispatcherServletPath,
        ObjectProvider&lt;ServletRegistrationBean&lt;?&gt;&gt; servletRegistrations) &#123;
    this.mvcProperties = mvcProperties;
    this.beanFactory = beanFactory;
    this.messageConvertersProvider = messageConvertersProvider;
    this.resourceHandlerRegistrationCustomizer = resourceHandlerRegistrationCustomizerProvider.getIfAvailable();
    this.dispatcherServletPath = dispatcherServletPath;
    this.servletRegistrations = servletRegistrations;
    this.mvcProperties.checkConfiguration();
&#125;
</code></pre>
<p>ResourceProperties resourceProperties 获取和spring.resources绑定的所有的值的对象<br>WebMvcProperties mvcProperties 获取和spring.mvc绑定的所有的值的对象<br>ListableBeanFactory beanFactory Spring的beanFactory<br>HttpMessageConverters 找到所有的HttpMessageConverters<br>ResourceHandlerRegistrationCustomizer 找到 资源处理器的自定义器。<br>DispatcherServletPath<br>ServletRegistrationBean 给应用注册Servlet、Filter…</p>
<h3 id="资源处理的默认规则"><a href="#资源处理的默认规则" class="headerlink" title="资源处理的默认规则"></a>资源处理的默认规则</h3><pre><code>...
public class WebMvcAutoConfiguration &#123;
    ...
    public static class EnableWebMvcConfiguration extends DelegatingWebMvcConfiguration implements ResourceLoaderAware &#123;
        ...
        @Override
        protected void addResourceHandlers(ResourceHandlerRegistry registry) &#123;
            super.addResourceHandlers(registry);
            if (!this.resourceProperties.isAddMappings()) &#123;
                logger.debug(&quot;Default resource handling disabled&quot;);
                return;
            &#125;
            ServletContext servletContext = getServletContext();
            addResourceHandler(registry, &quot;/webjars/**&quot;, &quot;classpath:/META-INF/resources/webjars/&quot;);
            addResourceHandler(registry, this.mvcProperties.getStaticPathPattern(), (registration) -&gt; &#123;
                registration.addResourceLocations(this.resourceProperties.getStaticLocations());
                if (servletContext != null) &#123;
                    registration.addResourceLocations(new ServletContextResource(servletContext, SERVLET_LOCATION));
                &#125;
            &#125;);
        &#125;
        ...	        
    &#125;
    ...
&#125;
</code></pre>
<p>根据上述代码，我们可以同过配置禁止所有静态资源规则。</p>
<pre><code>spring:
  resources:
    add-mappings: false   #禁用所有静态资源规则
</code></pre>
<p>静态资源规则：</p>
<pre><code>@ConfigurationProperties(prefix = &quot;spring.resources&quot;, ignoreUnknownFields = false)
public class ResourceProperties &#123;
    private static final String[] CLASSPATH_RESOURCE_LOCATIONS = &#123; &quot;classpath:/META-INF/resources/&quot;,
            &quot;classpath:/resources/&quot;, &quot;classpath:/static/&quot;, &quot;classpath:/public/&quot; &#125;;
    /**
     * Locations of static resources. Defaults to classpath:[/META-INF/resources/,
     * /resources/, /static/, /public/].
     */
    private String[] staticLocations = CLASSPATH_RESOURCE_LOCATIONS;
    ...
&#125;
</code></pre>
<p>欢迎页的处理规则</p>
<pre><code>...
public class WebMvcAutoConfiguration &#123;
    ...
    public static class EnableWebMvcConfiguration extends DelegatingWebMvcConfiguration implements ResourceLoaderAware &#123;
        ...
        @Bean
        public WelcomePageHandlerMapping welcomePageHandlerMapping(ApplicationContext applicationContext,
                FormattingConversionService mvcConversionService, ResourceUrlProvider mvcResourceUrlProvider) &#123;
            WelcomePageHandlerMapping welcomePageHandlerMapping = new WelcomePageHandlerMapping(
                    new TemplateAvailabilityProviders(applicationContext), applicationContext, getWelcomePage(),
                    this.mvcProperties.getStaticPathPattern());
            welcomePageHandlerMapping.setInterceptors(getInterceptors(mvcConversionService, mvcResourceUrlProvider));
            welcomePageHandlerMapping.setCorsConfigurations(getCorsConfigurations());
            return welcomePageHandlerMapping;
        &#125;
</code></pre>
<p>WelcomePageHandlerMapping 的构造方法如下：</p>
<pre><code>WelcomePageHandlerMapping(TemplateAvailabilityProviders templateAvailabilityProviders,
                          ApplicationContext applicationContext, Resource welcomePage, String staticPathPattern) &#123;
    if (welcomePage != null &amp;&amp; &quot;/**&quot;.equals(staticPathPattern)) &#123;
        //要用欢迎页功能，必须是/**
        logger.info(&quot;Adding welcome page: &quot; + welcomePage);
        setRootViewName(&quot;forward:index.html&quot;);
    &#125;
    else if (welcomeTemplateExists(templateAvailabilityProviders, applicationContext)) &#123;
        //调用Controller /index
        logger.info(&quot;Adding welcome page template: index&quot;);
        setRootViewName(&quot;index&quot;);
    &#125;
&#125;
</code></pre>
<p>这构造方法内的代码也解释了web场景-welcome与favicon功能中配置static-path-pattern了，welcome页面和小图标失效的问题。</p>
<h2 id="7-请求处理-【源码分析】-Rest映射及源码解析"><a href="#7-请求处理-【源码分析】-Rest映射及源码解析" class="headerlink" title="7. 请求处理-【源码分析】-Rest映射及源码解析"></a>7. 请求处理-【源码分析】-Rest映射及源码解析</h2><h3 id="请求映射"><a href="#请求映射" class="headerlink" title="请求映射"></a>请求映射</h3><p><strong>@xxxMapping;</strong></p>
<pre><code>@GetMapping
@PostMapping
@PutMapping
@DeleteMapping
</code></pre>
<p><strong>Rest风格支持（使用HTTP请求方式动词来表示对资源的操作）</strong></p>
<pre><code>以前：
    /getUser 获取用户
    /deleteUser 删除用户
    /editUser 修改用户
    /saveUser保存用户
现在： /user
    GET-获取用户
    DELETE-删除用户
    PUT-修改用户
    POST-保存用户
核心Filter；HiddenHttpMethodFilter
</code></pre>
<p><strong>用法</strong></p>
<pre><code>开启页面表单的Rest功能
页面 form的属性method=post，隐藏域 _method=put、delete等（如果直接get或post，无需隐藏域）
编写请求映射

spring:
  mvc:
    hiddenmethod:
      filter:
        enabled: true   #开启页面表单的Rest功能

&lt;form action=&quot;/user&quot; method=&quot;get&quot;&gt;
    &lt;input value=&quot;REST-GET提交&quot; type=&quot;submit&quot; /&gt;
&lt;/form&gt;
&lt;form action=&quot;/user&quot; method=&quot;post&quot;&gt;
    &lt;input value=&quot;REST-POST提交&quot; type=&quot;submit&quot; /&gt;
&lt;/form&gt;
&lt;form action=&quot;/user&quot; method=&quot;post&quot;&gt;
    &lt;input name=&quot;_method&quot; type=&quot;hidden&quot; value=&quot;DELETE&quot;/&gt;
    &lt;input value=&quot;REST-DELETE 提交&quot; type=&quot;submit&quot;/&gt;
&lt;/form&gt;
&lt;form action=&quot;/user&quot; method=&quot;post&quot;&gt;
    &lt;input name=&quot;_method&quot; type=&quot;hidden&quot; value=&quot;PUT&quot; /&gt;
    &lt;input value=&quot;REST-PUT提交&quot;type=&quot;submit&quot; /&gt;
&lt;/form&gt;

import org.springframework.web.bind.annotation.*;
@RestController
public class UserController &#123;
    @GetMapping(&quot;/user&quot;)
    //@RequestMapping(value = &quot;/user&quot;,method = RequestMethod.GET)
    public String getUser()&#123;
        return &quot;GET-张三&quot;;
    &#125;
    @PostMapping(&quot;/user&quot;)
    //@RequestMapping(value = &quot;/user&quot;,method = RequestMethod.POST)
    public String saveUser()&#123;
        return &quot;POST-张三&quot;;
    &#125;
    @PutMapping(&quot;/user&quot;)
    //@RequestMapping(value = &quot;/user&quot;,method = RequestMethod.PUT)
    public String putUser()&#123;
        return &quot;PUT-张三&quot;;
    &#125;
    @DeleteMapping(&quot;/user&quot;)
    //@RequestMapping(value = &quot;/user&quot;,method = RequestMethod.DELETE)
    public String deleteUser()&#123;
        return &quot;DELETE-张三&quot;;
    &#125;
&#125;
</code></pre>
<p><strong>Rest原理（表单提交要使用REST的时候）</strong></p>
<pre><code>表单提交会带上\_method=PUT
请求过来被HiddenHttpMethodFilter拦截
    请求是否正常，并且是POST
        获取到\_method的值。
        兼容以下请求；PUT.DELETE.PATCH
        原生request（post），包装模式requesWrapper重写了getMethod方法，返回的是传入的值。
        过滤器链放行的时候用wrapper。以后的方法调用getMethod是调用requesWrapper的。

public class HiddenHttpMethodFilter extends OncePerRequestFilter &#123;
    private static final List&lt;String&gt; ALLOWED_METHODS =
            Collections.unmodifiableList(Arrays.asList(HttpMethod.PUT.name(),
                    HttpMethod.DELETE.name(), HttpMethod.PATCH.name()));
    /** Default method parameter: &#123;@code _method&#125;. */
    public static final String DEFAULT_METHOD_PARAM = &quot;_method&quot;;
    private String methodParam = DEFAULT_METHOD_PARAM;
    /**
     * Set the parameter name to look for HTTP methods.
     * @see #DEFAULT_METHOD_PARAM
     */
    public void setMethodParam(String methodParam) &#123;
        Assert.hasText(methodParam, &quot;&#39;methodParam&#39; must not be empty&quot;);
        this.methodParam = methodParam;
    &#125;
    @Override
    protected void doFilterInternal(HttpServletRequest request, HttpServletResponse response, FilterChain filterChain)
            throws ServletException, IOException &#123;
        HttpServletRequest requestToUse = request;
        if (&quot;POST&quot;.equals(request.getMethod()) &amp;&amp; request.getAttribute(WebUtils.ERROR_EXCEPTION_ATTRIBUTE) == null) &#123;
            String paramValue = request.getParameter(this.methodParam);
            if (StringUtils.hasLength(paramValue)) &#123;
                String method = paramValue.toUpperCase(Locale.ENGLISH);
                if (ALLOWED_METHODS.contains(method)) &#123;
                    requestToUse = new HttpMethodRequestWrapper(request, method);
                &#125;
            &#125;
        &#125;
        filterChain.doFilter(requestToUse, response);
    &#125;
    /**
     * Simple &#123;@link HttpServletRequest&#125; wrapper that returns the supplied method for
     * &#123;@link HttpServletRequest#getMethod()&#125;.
     */
    private static class HttpMethodRequestWrapper extends HttpServletRequestWrapper &#123;
        private final String method;
        public HttpMethodRequestWrapper(HttpServletRequest request, String method) &#123;
            super(request);
            this.method = method;
        &#125;
        @Override
        public String getMethod() &#123;
            return this.method;
        &#125;
    &#125;
&#125;
</code></pre>
<p><strong>Rest使用客户端工具。</strong></p>
<pre><code>如 PostMan 可直接发送put、delete等方式请求。
</code></pre>
<h3 id="8-请求处理-【源码分析】-怎么改变默认的-method"><a href="#8-请求处理-【源码分析】-怎么改变默认的-method" class="headerlink" title="8. 请求处理-【源码分析】-怎么改变默认的_method"></a>8. 请求处理-【源码分析】-怎么改变默认的_method</h3><pre><code>@Configuration(proxyBeanMethods = false)
@ConditionalOnWebApplication(type = Type.SERVLET)
@ConditionalOnClass(&#123; Servlet.class, DispatcherServlet.class, WebMvcConfigurer.class &#125;)
@ConditionalOnMissingBean(WebMvcConfigurationSupport.class)
@AutoConfigureOrder(Ordered.HIGHEST_PRECEDENCE + 10)
@AutoConfigureAfter(&#123; DispatcherServletAutoConfiguration.class, TaskExecutionAutoConfiguration.class,
        ValidationAutoConfiguration.class &#125;)
public class WebMvcAutoConfiguration &#123;
    ...
    @Bean
    @ConditionalOnMissingBean(HiddenHttpMethodFilter.class)
    @ConditionalOnProperty(prefix = &quot;spring.mvc.hiddenmethod.filter&quot;, name = &quot;enabled&quot;, matchIfMissing = false)
    public OrderedHiddenHttpMethodFilter hiddenHttpMethodFilter() &#123;
        return new OrderedHiddenHttpMethodFilter();
    &#125;
    ...
&#125;
</code></pre>
<p>@ConditionalOnMissingBean(HiddenHttpMethodFilter.class)意味着在没有HiddenHttpMethodFilter时，才执行hiddenHttpMethodFilter()。因此，我们可以自定义filter，改变默认的_method。例如：</p>
<pre><code>@Configuration(proxyBeanMethods = false)
public class WebConfig&#123;
    //自定义filter
    @Bean
    public HiddenHttpMethodFilter hiddenHttpMethodFilter()&#123;
        HiddenHttpMethodFilter methodFilter = new HiddenHttpMethodFilter();
        methodFilter.setMethodParam(&quot;_m&quot;);
        return methodFilter;
    &#125;    
&#125;
</code></pre>
<p><strong>将_method改成_m</strong></p>
<pre><code>&lt;form action=&quot;/user&quot; method=&quot;post&quot;&gt;
    &lt;input name=&quot;_m&quot; type=&quot;hidden&quot; value=&quot;DELETE&quot;/&gt;
    &lt;input value=&quot;REST-DELETE 提交&quot; type=&quot;submit&quot;/&gt;
&lt;/form&gt;
</code></pre>
<h2 id="9-请求处理-【源码分析】-请求映射原理"><a href="#9-请求处理-【源码分析】-请求映射原理" class="headerlink" title="9. 请求处理-【源码分析】-请求映射原理"></a>9. 请求处理-【源码分析】-请求映射原理</h2><p><img src="/2021/05/19/SpringBoot2-BASE-2/1.png"></p>
<p>SpringMVC功能分析都从 org.springframework.web.servlet.DispatcherServlet -&gt; doDispatch()</p>
<pre><code>protected void doDispatch(HttpServletRequest request, HttpServletResponse response) throws Exception &#123;
    HttpServletRequest processedRequest = request;
    HandlerExecutionChain mappedHandler = null;
    boolean multipartRequestParsed = false;
    WebAsyncManager asyncManager = WebAsyncUtils.getAsyncManager(request);
    try &#123;
        ModelAndView mv = null;
        Exception dispatchException = null;
        try &#123;
            processedRequest = checkMultipart(request);
            multipartRequestParsed = (processedRequest != request);
            // 找到当前请求使用哪个Handler（Controller的方法）处理
            mappedHandler = getHandler(processedRequest);
            //HandlerMapping：处理器映射。/xxx-&gt;&gt;xxxx
    ...
&#125;
</code></pre>
<p><strong>getHandler()方法如下：</strong></p>
<pre><code>@Nullable
protected HandlerExecutionChain getHandler(HttpServletRequest request) throws Exception &#123;
    if (this.handlerMappings != null) &#123;
        for (HandlerMapping mapping : this.handlerMappings) &#123;
            HandlerExecutionChain handler = mapping.getHandler(request);
            if (handler != null) &#123;
                return handler;
            &#125;
        &#125;
    &#125;
    return null;
&#125;
</code></pre>
<p>this.handlerMappings在Debug模式下展现的内容：</p>
<p><img src="/2021/05/19/SpringBoot2-BASE-2/2.png"></p>
<p>其中，保存了所有@RequestMapping 和handler的映射规则。</p>
<p><img src="/2021/05/19/SpringBoot2-BASE-2/3.png"></p>
<p><strong>所有的请求映射都在HandlerMapping中：</strong></p>
<pre><code>1. SpringBoot自动配置欢迎页的 WelcomePageHandlerMapping 。访问 /能访问到index.html；
2. SpringBoot自动配置了默认 的 RequestMappingHandlerMapping
3. 请求进来，挨个尝试所有的HandlerMapping看是否有请求信息。
    如果有就找到这个请求对应的handler
    如果没有就是下一个 HandlerMapping
4. 我们需要一些自定义的映射处理，我们也可以自己给容器中放HandlerMapping。自定义 HandlerMapping
</code></pre>
<p><strong>IDEA快捷键：</strong></p>
<p>Ctrl + Alt + U : 以UML的类图展现类有哪些继承类，派生类以及实现哪些接口。<br>Crtl + Alt + Shift + U : 同上，区别在于上条快捷键结果在新页展现，而本条快捷键结果在弹窗展现。<br>Ctrl + H : 以树形方式展现类层次结构图。</p>
<h2 id="10-请求处理-常用参数注解使用"><a href="#10-请求处理-常用参数注解使用" class="headerlink" title="10. 请求处理-常用参数注解使用"></a>10. 请求处理-常用参数注解使用</h2><p><strong>注解：</strong></p>
<pre><code>@PathVariable 路径变量
@RequestHeader 获取请求头
@RequestParam 获取请求参数（指问号后的参数，url?a=1&amp;b=2）
@CookieValue 获取Cookie值
@RequestAttribute 获取request域属性
@RequestBody 获取请求体[POST]
@MatrixVariable 矩阵变量
@ModelAttribute
</code></pre>
<p><strong>使用用例：</strong></p>
<pre><code>@RestController
public class ParameterTestController &#123;
    //  car/2/owner/zhangsan
    @GetMapping(&quot;/car/&#123;id&#125;/owner/&#123;username&#125;&quot;)
    public Map&lt;String,Object&gt; getCar(@PathVariable(&quot;id&quot;) Integer id,
                                     @PathVariable(&quot;username&quot;) String name,
                                     @PathVariable Map&lt;String,String&gt; pv,
                                     @RequestHeader(&quot;User-Agent&quot;) String userAgent,
                                     @RequestHeader Map&lt;String,String&gt; header,
                                     @RequestParam(&quot;age&quot;) Integer age,
                                     @RequestParam(&quot;inters&quot;) List&lt;String&gt; inters,
                                     @RequestParam Map&lt;String,String&gt; params,
                                     @CookieValue(&quot;_ga&quot;) String _ga,
                                     @CookieValue(&quot;_ga&quot;) Cookie cookie)&#123;
        Map&lt;String,Object&gt; map = new HashMap&lt;&gt;();
        // map.put(&quot;id&quot;,id);
        // map.put(&quot;name&quot;,name);
        // map.put(&quot;pv&quot;,pv);
        // map.put(&quot;userAgent&quot;,userAgent);
        // map.put(&quot;headers&quot;,header);
        map.put(&quot;age&quot;,age);
        map.put(&quot;inters&quot;,inters);
        map.put(&quot;params&quot;,params);
        map.put(&quot;_ga&quot;,_ga);
        System.out.println(cookie.getName()+&quot;===&gt;&quot;+cookie.getValue());
        return map;
    &#125;
    @PostMapping(&quot;/save&quot;)
    public Map postMethod(@RequestBody String content)&#123;
        Map&lt;String,Object&gt; map = new HashMap&lt;&gt;();
        map.put(&quot;content&quot;,content);
        return map;
    &#125;
&#125;
</code></pre>
<h2 id="11-请求处理-RequestAttribute"><a href="#11-请求处理-RequestAttribute" class="headerlink" title="11. 请求处理-@RequestAttribute"></a>11. 请求处理-@RequestAttribute</h2><p><strong>用例：</strong></p>
<pre><code>@Controller
public class RequestController &#123;
    @GetMapping(&quot;/goto&quot;)
    public String goToPage(HttpServletRequest request)&#123;
        request.setAttribute(&quot;msg&quot;,&quot;成功了...&quot;);
        request.setAttribute(&quot;code&quot;,200);
        return &quot;forward:/success&quot;;  //转发到  /success请求
    &#125;
    @GetMapping(&quot;/params&quot;)
    public String testParam(Map&lt;String,Object&gt; map,
                            Model model,
                            HttpServletRequest request,
                            HttpServletResponse response)&#123;
        map.put(&quot;hello&quot;,&quot;world666&quot;);
        model.addAttribute(&quot;world&quot;,&quot;hello666&quot;);
        request.setAttribute(&quot;message&quot;,&quot;HelloWorld&quot;);
        Cookie cookie = new Cookie(&quot;c1&quot;,&quot;v1&quot;);
        response.addCookie(cookie);
        return &quot;forward:/success&quot;;
    &#125;
    ///&lt;-----------------主角@RequestAttribute在这个方法
    @ResponseBody
    @GetMapping(&quot;/success&quot;)
    public Map success(@RequestAttribute(value = &quot;msg&quot;,required = false) String msg,
                       @RequestAttribute(value = &quot;code&quot;,required = false)Integer code,
                       HttpServletRequest request)&#123;
        Object msg1 = request.getAttribute(&quot;msg&quot;);
        Map&lt;String,Object&gt; map = new HashMap&lt;&gt;();
        Object hello = request.getAttribute(&quot;hello&quot;);
        Object world = request.getAttribute(&quot;world&quot;);
        Object message = request.getAttribute(&quot;message&quot;);
        map.put(&quot;reqMethod_msg&quot;,msg1);
        map.put(&quot;annotation_msg&quot;,msg);
        map.put(&quot;hello&quot;,hello);
        map.put(&quot;world&quot;,world);
        map.put(&quot;message&quot;,message);
        return map;
    &#125;
&#125;
</code></pre>
<h2 id="12-请求处理-MatrixVariable与UrlPathHelper"><a href="#12-请求处理-MatrixVariable与UrlPathHelper" class="headerlink" title="12. 请求处理-@MatrixVariable与UrlPathHelper"></a>12. 请求处理-@MatrixVariable与UrlPathHelper</h2><ol>
<li><p>语法： 请求路径：&#x2F;cars&#x2F;sell;low&#x3D;34;brand&#x3D;byd,audi,yd</p>
</li>
<li><p>SpringBoot默认是禁用了矩阵变量的功能</p>
<pre><code> 手动开启：原理。对于路径的处理。UrlPathHelper的removeSemicolonContent设置为false，让其支持矩阵变量的。
</code></pre>
</li>
<li><p>矩阵变量必须有url路径变量才能被解析</p>
</li>
</ol>
<p><strong>手动开启矩阵变量：</strong></p>
<p><strong>实现WebMvcConfigurer接口：</strong></p>
<pre><code>@Configuration(proxyBeanMethods = false)
public class WebConfig implements WebMvcConfigurer &#123;
    @Override
    public void configurePathMatch(PathMatchConfigurer configurer) &#123;
        UrlPathHelper urlPathHelper = new UrlPathHelper();
        // 不移除；后面的内容。矩阵变量功能就可以生效
        urlPathHelper.setRemoveSemicolonContent(false);
        configurer.setUrlPathHelper(urlPathHelper);
    &#125;
&#125;
</code></pre>
<p><strong>创建返回WebMvcConfigurerBean：</strong></p>
<pre><code>@Configuration(proxyBeanMethods = false)
public class WebConfig&#123;
    @Bean
    public WebMvcConfigurer webMvcConfigurer()&#123;
        return new WebMvcConfigurer() &#123;
            @Override
            public void configurePathMatch(PathMatchConfigurer configurer) &#123;
                UrlPathHelper urlPathHelper = new UrlPathHelper();
                // 不移除；后面的内容。矩阵变量功能就可以生效
                urlPathHelper.setRemoveSemicolonContent(false);
                configurer.setUrlPathHelper(urlPathHelper);
            &#125;
        &#125;
    &#125;
&#125;
</code></pre>
<p><strong>@MatrixVariable的用例</strong></p>
<pre><code>@RestController
public class ParameterTestController &#123;
    ///cars/sell;low=34;brand=byd,audi,yd
    @GetMapping(&quot;/cars/&#123;path&#125;&quot;)
    public Map carsSell(@MatrixVariable(&quot;low&quot;) Integer low,
                        @MatrixVariable(&quot;brand&quot;) List&lt;String&gt; brand,
                        @PathVariable(&quot;path&quot;) String path)&#123;
        Map&lt;String,Object&gt; map = new HashMap&lt;&gt;();
        map.put(&quot;low&quot;,low);
        map.put(&quot;brand&quot;,brand);
        map.put(&quot;path&quot;,path);
        return map;
    &#125;
    // /boss/1;age=20/2;age=10
    @GetMapping(&quot;/boss/&#123;bossId&#125;/&#123;empId&#125;&quot;)
    public Map boss(@MatrixVariable(value = &quot;age&quot;,pathVar = &quot;bossId&quot;) Integer bossAge,
                    @MatrixVariable(value = &quot;age&quot;,pathVar = &quot;empId&quot;) Integer empAge)&#123;
        Map&lt;String,Object&gt; map = new HashMap&lt;&gt;();
        map.put(&quot;bossAge&quot;,bossAge);
        map.put(&quot;empAge&quot;,empAge);
        return map;
    &#125;
&#125;
</code></pre>
<h2 id="13-请求处理-【源码分析】-各种类型参数解析原理"><a href="#13-请求处理-【源码分析】-各种类型参数解析原理" class="headerlink" title="13. 请求处理-【源码分析】-各种类型参数解析原理"></a>13. 请求处理-【源码分析】-各种类型参数解析原理</h2><p>这要从DispatcherServlet开始说起：</p>
<pre><code>public class DispatcherServlet extends FrameworkServlet &#123;	    
    protected void doDispatch(HttpServletRequest request, HttpServletResponse response) throws Exception &#123;
        HttpServletRequest processedRequest = request;
        HandlerExecutionChain mappedHandler = null;
        boolean multipartRequestParsed = false;
        WebAsyncManager asyncManager = WebAsyncUtils.getAsyncManager(request);
        try &#123;
            ModelAndView mv = null;
            Exception dispatchException = null;
            try &#123;
                processedRequest = checkMultipart(request);
                multipartRequestParsed = (processedRequest != request);
                // Determine handler for the current request.
                mappedHandler = getHandler(processedRequest);
                if (mappedHandler == null) &#123;
                    noHandlerFound(processedRequest, response);
                    return;
                &#125;
                // Determine handler adapter for the current request.
                HandlerAdapter ha = getHandlerAdapter(mappedHandler.getHandler());
                ...
</code></pre>
<p>HandlerMapping中找到能处理请求的Handler（Controller.method()）。<br>为当前Handler 找一个适配器 HandlerAdapter，用的最多的是RequestMappingHandlerAdapter。<br>适配器执行目标方法并确定方法参数的每一个值。</p>
<h3 id="HandlerAdapter"><a href="#HandlerAdapter" class="headerlink" title="HandlerAdapter"></a>HandlerAdapter</h3><p>默认会加载所有HandlerAdapter</p>
<pre><code>public class DispatcherServlet extends FrameworkServlet &#123;
    /** Detect all HandlerAdapters or just expect &quot;handlerAdapter&quot; bean?. */
    private boolean detectAllHandlerAdapters = true;
    ...
    
    private void initHandlerAdapters(ApplicationContext context) &#123;
        this.handlerAdapters = null;
        if (this.detectAllHandlerAdapters) &#123;
            // Find all HandlerAdapters in the ApplicationContext, including ancestor contexts.
            Map&lt;String, HandlerAdapter&gt; matchingBeans =
                BeanFactoryUtils.beansOfTypeIncludingAncestors(context, HandlerAdapter.class, true, false);
            if (!matchingBeans.isEmpty()) &#123;
                this.handlerAdapters = new ArrayList&lt;&gt;(matchingBeans.values());
                // We keep HandlerAdapters in sorted order.
                AnnotationAwareOrderComparator.sort(this.handlerAdapters);
            &#125;
        &#125;
     ...
</code></pre>
<p>有这些HandlerAdapter：</p>
<p><img src="/2021/05/19/SpringBoot2-BASE-2/4.png"></p>
<pre><code>0. 支持方法上标注 @RequestMapping
1. 支持函数式编程的
2. …
3. …
</code></pre>
<h3 id="执行目标方法"><a href="#执行目标方法" class="headerlink" title="执行目标方法"></a>执行目标方法</h3><pre><code>public class DispatcherServlet extends FrameworkServlet &#123;
    
    protected void doDispatch(HttpServletRequest request, HttpServletResponse response) throws Exception &#123;
        ModelAndView mv = null;
        
        ...
        // Determine handler for the current request.
        mappedHandler = getHandler(processedRequest);
        if (mappedHandler == null) &#123;
            noHandlerFound(processedRequest, response);
            return;
        &#125;
        // Determine handler adapter for the current request.
        HandlerAdapter ha = getHandlerAdapter(mappedHandler.getHandler());
        ...
        //本节重点
        // Actually invoke the handler.
        mv = ha.handle(processedRequest, response, mappedHandler.getHandler());
</code></pre>
<p>HandlerAdapter接口实现类RequestMappingHandlerAdapter（主要用来处理@RequestMapping）</p>
<pre><code>public class RequestMappingHandlerAdapter extends AbstractHandlerMethodAdapter
        implements BeanFactoryAware, InitializingBean &#123;
    ...
    
    //AbstractHandlerMethodAdapter类的方法，RequestMappingHandlerAdapter继承AbstractHandlerMethodAdapter
    public final ModelAndView handle(HttpServletRequest request, HttpServletResponse response, Object handler)
        throws Exception &#123;
        return handleInternal(request, response, (HandlerMethod) handler);
    &#125;
    @Override
    protected ModelAndView handleInternal(HttpServletRequest request,
            HttpServletResponse response, HandlerMethod handlerMethod) throws Exception &#123;
    	ModelAndView mav;
        //handleInternal的核心
        mav = invokeHandlerMethod(request, response, handlerMethod);//解释看下节
        //...
        return mav;
    &#125;
&#125;
</code></pre>
<h3 id="参数解析器"><a href="#参数解析器" class="headerlink" title="参数解析器"></a>参数解析器</h3><p>确定将要执行的目标方法的每一个参数的值是什么;</p>
<p>SpringMVC目标方法能写多少种参数类型。取决于参数解析器argumentResolvers。</p>
<pre><code>@Nullable
protected ModelAndView invokeHandlerMethod(HttpServletRequest request,
                                           HttpServletResponse response, HandlerMethod handlerMethod) throws Exception &#123;
    ServletWebRequest webRequest = new ServletWebRequest(request, response);
    try &#123;
        WebDataBinderFactory binderFactory = getDataBinderFactory(handlerMethod);
        ModelFactory modelFactory = getModelFactory(handlerMethod, binderFactory);
        ServletInvocableHandlerMethod invocableMethod = createInvocableHandlerMethod(handlerMethod);
        if (this.argumentResolvers != null) &#123;//&lt;-----关注点
            invocableMethod.setHandlerMethodArgumentResolvers(this.argumentResolvers);
        &#125;
        
        ...
</code></pre>
<p>this.argumentResolvers在afterPropertiesSet()方法内初始化</p>
<pre><code>public class RequestMappingHandlerAdapter extends AbstractHandlerMethodAdapter
        implements BeanFactoryAware, InitializingBean &#123;		
    @Nullable
    private HandlerMethodArgumentResolverComposite argumentResolvers;
    
    @Override
    public void afterPropertiesSet() &#123;
        ...
    	if (this.argumentResolvers == null) &#123;//初始化argumentResolvers
        	List&lt;HandlerMethodArgumentResolver&gt; resolvers = getDefaultArgumentResolvers();
            this.argumentResolvers = new HandlerMethodArgumentResolverComposite().addResolvers(resolvers);
        &#125;
        ...
    &#125;
    //初始化了一堆的实现HandlerMethodArgumentResolver接口的
    private List&lt;HandlerMethodArgumentResolver&gt; getDefaultArgumentResolvers() &#123;
        List&lt;HandlerMethodArgumentResolver&gt; resolvers = new ArrayList&lt;&gt;(30);
        // Annotation-based argument resolution
        resolvers.add(new RequestParamMethodArgumentResolver(getBeanFactory(), false));
        resolvers.add(new RequestParamMapMethodArgumentResolver());
        resolvers.add(new PathVariableMethodArgumentResolver());
        resolvers.add(new PathVariableMapMethodArgumentResolver());
        resolvers.add(new MatrixVariableMethodArgumentResolver());
        resolvers.add(new MatrixVariableMapMethodArgumentResolver());
        resolvers.add(new ServletModelAttributeMethodProcessor(false));
        resolvers.add(new RequestResponseBodyMethodProcessor(getMessageConverters(), this.requestResponseBodyAdvice));
        resolvers.add(new RequestPartMethodArgumentResolver(getMessageConverters(), this.requestResponseBodyAdvice));
        resolvers.add(new RequestHeaderMethodArgumentResolver(getBeanFactory()));
        resolvers.add(new RequestHeaderMapMethodArgumentResolver());
        resolvers.add(new ServletCookieValueMethodArgumentResolver(getBeanFactory()));
        resolvers.add(new ExpressionValueMethodArgumentResolver(getBeanFactory()));
        resolvers.add(new SessionAttributeMethodArgumentResolver());
        resolvers.add(new RequestAttributeMethodArgumentResolver());
        // Type-based argument resolution
        resolvers.add(new ServletRequestMethodArgumentResolver());
        resolvers.add(new ServletResponseMethodArgumentResolver());
        resolvers.add(new HttpEntityMethodProcessor(getMessageConverters(), this.requestResponseBodyAdvice));
        resolvers.add(new RedirectAttributesMethodArgumentResolver());
        resolvers.add(new ModelMethodProcessor());
        resolvers.add(new MapMethodProcessor());
        resolvers.add(new ErrorsMethodArgumentResolver());
        resolvers.add(new SessionStatusMethodArgumentResolver());
        resolvers.add(new UriComponentsBuilderMethodArgumentResolver());
        if (KotlinDetector.isKotlinPresent()) &#123;
            resolvers.add(new ContinuationHandlerMethodArgumentResolver());
        &#125;
        // Custom arguments
        if (getCustomArgumentResolvers() != null) &#123;
            resolvers.addAll(getCustomArgumentResolvers());
        &#125;
        // Catch-all
        resolvers.add(new PrincipalMethodArgumentResolver());
        resolvers.add(new RequestParamMethodArgumentResolver(getBeanFactory(), true));
        resolvers.add(new ServletModelAttributeMethodProcessor(true));
        return resolvers;
    &#125;
    
&#125;
</code></pre>
<p>HandlerMethodArgumentResolverComposite类如下：（众多参数解析器argumentResolvers的包装类）。</p>
<pre><code>public class HandlerMethodArgumentResolverComposite implements HandlerMethodArgumentResolver &#123;
    private final List&lt;HandlerMethodArgumentResolver&gt; argumentResolvers = new ArrayList&lt;&gt;();
    
    ...
    
    public HandlerMethodArgumentResolverComposite addResolvers(
            @Nullable HandlerMethodArgumentResolver... resolvers) &#123;
        if (resolvers != null) &#123;
            Collections.addAll(this.argumentResolvers, resolvers);
        &#125;
        return this;
    &#125;
    
    ...
&#125;
</code></pre>
<p>我们看看HandlerMethodArgumentResolver的源码：</p>
<pre><code>public interface HandlerMethodArgumentResolver &#123;
    //当前解析器是否支持解析这种参数
    boolean supportsParameter(MethodParameter parameter);
    @Nullable//如果支持，就调用 resolveArgument
    Object resolveArgument(MethodParameter parameter, @Nullable ModelAndViewContainer mavContainer,
            NativeWebRequest webRequest, @Nullable WebDataBinderFactory binderFactory) throws Exception;
&#125;
</code></pre>
<h3 id="返回值处理器"><a href="#返回值处理器" class="headerlink" title="返回值处理器"></a>返回值处理器</h3><p>ValueHandler</p>
<pre><code>@Nullable
protected ModelAndView invokeHandlerMethod(HttpServletRequest request,
                                           HttpServletResponse response, HandlerMethod handlerMethod) throws Exception &#123;
    ServletWebRequest webRequest = new ServletWebRequest(request, response);
    try &#123;
        WebDataBinderFactory binderFactory = getDataBinderFactory(handlerMethod);
        ModelFactory modelFactory = getModelFactory(handlerMethod, binderFactory);
        ServletInvocableHandlerMethod invocableMethod = createInvocableHandlerMethod(handlerMethod);
        if (this.argumentResolvers != null) &#123;
            invocableMethod.setHandlerMethodArgumentResolvers(this.argumentResolvers);
        &#125;
        if (this.returnValueHandlers != null) &#123;//&lt;---关注点
            invocableMethod.setHandlerMethodReturnValueHandlers(this.returnValueHandlers);
        &#125;
     ...
</code></pre>
<p>this.returnValueHandlers在afterPropertiesSet()方法内初始化</p>
<pre><code>public class RequestMappingHandlerAdapter extends AbstractHandlerMethodAdapter
        implements BeanFactoryAware, InitializingBean &#123;		
    @Nullable
    private HandlerMethodReturnValueHandlerComposite returnValueHandlers;
    
    @Override
    public void afterPropertiesSet() &#123;
        ...
        
        if (this.returnValueHandlers == null) &#123;
            List&lt;HandlerMethodReturnValueHandler&gt; handlers = getDefaultReturnValueHandlers();
            this.returnValueHandlers = new HandlerMethodReturnValueHandlerComposite().addHandlers(handlers);
        &#125;
    &#125;
    
    //初始化了一堆的实现HandlerMethodReturnValueHandler接口的
    private List&lt;HandlerMethodReturnValueHandler&gt; getDefaultReturnValueHandlers() &#123;
        List&lt;HandlerMethodReturnValueHandler&gt; handlers = new ArrayList&lt;&gt;(20);
        // Single-purpose return value types
        handlers.add(new ModelAndViewMethodReturnValueHandler());
        handlers.add(new ModelMethodProcessor());
        handlers.add(new ViewMethodReturnValueHandler());
        handlers.add(new ResponseBodyEmitterReturnValueHandler(getMessageConverters(),
                this.reactiveAdapterRegistry, this.taskExecutor, this.contentNegotiationManager));
        handlers.add(new StreamingResponseBodyReturnValueHandler());
        handlers.add(new HttpEntityMethodProcessor(getMessageConverters(),
                this.contentNegotiationManager, this.requestResponseBodyAdvice));
        handlers.add(new HttpHeadersReturnValueHandler());
        handlers.add(new CallableMethodReturnValueHandler());
        handlers.add(new DeferredResultMethodReturnValueHandler());
        handlers.add(new AsyncTaskMethodReturnValueHandler(this.beanFactory));
        // Annotation-based return value types
        handlers.add(new ServletModelAttributeMethodProcessor(false));
        handlers.add(new RequestResponseBodyMethodProcessor(getMessageConverters(),
                this.contentNegotiationManager, this.requestResponseBodyAdvice));
        // Multi-purpose return value types
        handlers.add(new ViewNameMethodReturnValueHandler());
        handlers.add(new MapMethodProcessor());
        // Custom return value types
        if (getCustomReturnValueHandlers() != null) &#123;
            handlers.addAll(getCustomReturnValueHandlers());
        &#125;
        // Catch-all
        if (!CollectionUtils.isEmpty(getModelAndViewResolvers())) &#123;
            handlers.add(new ModelAndViewResolverMethodReturnValueHandler(getModelAndViewResolvers()));
        &#125;
        else &#123;
            handlers.add(new ServletModelAttributeMethodProcessor(true));
        &#125;
        return handlers;
    &#125;
&#125;
</code></pre>
<p>HandlerMethodReturnValueHandlerComposite类如下：</p>
<pre><code>public class HandlerMethodReturnValueHandlerComposite implements HandlerMethodReturnValueHandler &#123;
    private final List&lt;HandlerMethodReturnValueHandler&gt; returnValueHandlers = new ArrayList&lt;&gt;();
    ...
    
    public HandlerMethodReturnValueHandlerComposite addHandlers(
            @Nullable List&lt;? extends HandlerMethodReturnValueHandler&gt; handlers) &#123;
        if (handlers != null) &#123;
            this.returnValueHandlers.addAll(handlers);
        &#125;
        return this;
    &#125;
&#125;
</code></pre>
<p>HandlerMethodReturnValueHandler接口：</p>
<pre><code>public interface HandlerMethodReturnValueHandler &#123;
    boolean supportsReturnType(MethodParameter returnType);
    void handleReturnValue(@Nullable Object returnValue, MethodParameter returnType,
            ModelAndViewContainer mavContainer, NativeWebRequest webRequest) throws Exception;
&#125;
</code></pre>
<h3 id="回顾执行目标方法"><a href="#回顾执行目标方法" class="headerlink" title="回顾执行目标方法"></a>回顾执行目标方法</h3><pre><code>public class DispatcherServlet extends FrameworkServlet &#123;
    ...
    protected void doDispatch(HttpServletRequest request, HttpServletResponse response) throws Exception &#123;
        ModelAndView mv = null;
        ...
        mv = ha.handle(processedRequest, response, mappedHandler.getHandler());
</code></pre>
<p>RequestMappingHandlerAdapter的handle()方法：</p>
<pre><code>public class RequestMappingHandlerAdapter extends AbstractHandlerMethodAdapter
        implements BeanFactoryAware, InitializingBean &#123;
    ...
    
    //AbstractHandlerMethodAdapter类的方法，RequestMappingHandlerAdapter继承AbstractHandlerMethodAdapter
    public final ModelAndView handle(HttpServletRequest request, HttpServletResponse response, Object handler)
        throws Exception &#123;
        return handleInternal(request, response, (HandlerMethod) handler);
    &#125;
    @Override
    protected ModelAndView handleInternal(HttpServletRequest request,
            HttpServletResponse response, HandlerMethod handlerMethod) throws Exception &#123;
    	ModelAndView mav;
        //handleInternal的核心
        mav = invokeHandlerMethod(request, response, handlerMethod);//解释看下节
        //...
        return mav;
    &#125;
&#125;
</code></pre>
<p>RequestMappingHandlerAdapter的invokeHandlerMethod()方法：</p>
<pre><code>public class RequestMappingHandlerAdapter extends AbstractHandlerMethodAdapter
        implements BeanFactoryAware, InitializingBean &#123;
    
    protected ModelAndView invokeHandlerMethod(HttpServletRequest request,
            HttpServletResponse response, HandlerMethod handlerMethod) throws Exception &#123;
        ServletWebRequest webRequest = new ServletWebRequest(request, response);
        try &#123;
            ...
            
            ServletInvocableHandlerMethod invocableMethod = createInvocableHandlerMethod(handlerMethod);
            if (this.argumentResolvers != null) &#123;
                invocableMethod.setHandlerMethodArgumentResolvers(this.argumentResolvers);
            &#125;
            if (this.returnValueHandlers != null) &#123;
                invocableMethod.setHandlerMethodReturnValueHandlers(this.returnValueHandlers);
            &#125;
            ...
            //关注点：执行目标方法
            invocableMethod.invokeAndHandle(webRequest, mavContainer);
            if (asyncManager.isConcurrentHandlingStarted()) &#123;
                return null;
            &#125;
            return getModelAndView(mavContainer, modelFactory, webRequest);
        &#125;
        finally &#123;
            webRequest.requestCompleted();
        &#125;
    &#125;
&#125;
</code></pre>
<p>invokeAndHandle()方法如下：</p>
<pre><code>public class ServletInvocableHandlerMethod extends InvocableHandlerMethod &#123;
    public void invokeAndHandle(ServletWebRequest webRequest, ModelAndViewContainer mavContainer,
            Object... providedArgs) throws Exception &#123;
        Object returnValue = invokeForRequest(webRequest, mavContainer, providedArgs);
        ...
        
        try &#123;
            //returnValue存储起来
            this.returnValueHandlers.handleReturnValue(
                    returnValue, getReturnValueType(returnValue), mavContainer, webRequest);
        &#125;
        catch (Exception ex) &#123;
            ...
        &#125;
    &#125;
    
    @Nullable//InvocableHandlerMethod类的，ServletInvocableHandlerMethod类继承InvocableHandlerMethod类
    public Object invokeForRequest(NativeWebRequest request, @Nullable ModelAndViewContainer mavContainer,
            Object... providedArgs) throws Exception &#123;
        获取方法的参数值
        Object[] args = getMethodArgumentValues(request, mavContainer, providedArgs);
        ...
       
        return doInvoke(args);
    &#125;
    @Nullable
    protected Object doInvoke(Object... args) throws Exception &#123;
        Method method = getBridgedMethod();//@RequestMapping的方法
        ReflectionUtils.makeAccessible(method);
        try &#123;
            if (KotlinDetector.isSuspendingFunction(method)) &#123;
                return CoroutinesUtils.invokeSuspendingFunction(method, getBean(), args);
            &#125;
            //通过反射调用
            return method.invoke(getBean(), args);//getBean()指@RequestMapping的方法所在类的对象。
        &#125;
        catch (IllegalArgumentException ex) &#123;
            ...
        &#125;
        catch (InvocationTargetException ex) &#123;
            ...
        &#125;
    &#125;
    
&#125;   
</code></pre>
<h3 id="如何确定目标方法每一个参数的值"><a href="#如何确定目标方法每一个参数的值" class="headerlink" title="如何确定目标方法每一个参数的值"></a>如何确定目标方法每一个参数的值</h3><p>重点分析ServletInvocableHandlerMethod的getMethodArgumentValues方法</p>
<pre><code>public class ServletInvocableHandlerMethod extends InvocableHandlerMethod &#123;
    ...
    @Nullable//InvocableHandlerMethod类的，ServletInvocableHandlerMethod类继承InvocableHandlerMethod类
    public Object invokeForRequest(NativeWebRequest request, @Nullable ModelAndViewContainer mavContainer,
            Object... providedArgs) throws Exception &#123;
        获取方法的参数值
        Object[] args = getMethodArgumentValues(request, mavContainer, providedArgs);
        ...
       
        return doInvoke(args);
    &#125;
 
    //本节重点，获取方法的参数值
    protected Object[] getMethodArgumentValues(NativeWebRequest request, @Nullable ModelAndViewContainer mavContainer,
            Object... providedArgs) throws Exception &#123;
        MethodParameter[] parameters = getMethodParameters();
        if (ObjectUtils.isEmpty(parameters)) &#123;
            return EMPTY_ARGS;
        &#125;
        Object[] args = new Object[parameters.length];
        for (int i = 0; i &lt; parameters.length; i++) &#123;
            MethodParameter parameter = parameters[i];
            parameter.initParameterNameDiscovery(this.parameterNameDiscoverer);
            args[i] = findProvidedArgument(parameter, providedArgs);
            if (args[i] != null) &#123;
                continue;
            &#125;
            //查看resolvers是否有支持
            if (!this.resolvers.supportsParameter(parameter)) &#123;
                throw new IllegalStateException(formatArgumentError(parameter, &quot;No suitable resolver&quot;));
            &#125;
            try &#123;
                //支持的话就开始解析吧
                args[i] = this.resolvers.resolveArgument(parameter, mavContainer, request, this.dataBinderFactory);
            &#125;
            catch (Exception ex) &#123;
                ....
            &#125;
        &#125;
        return args;
    &#125;
&#125;
</code></pre>
<p>this.resolvers的类型为HandlerMethodArgumentResolverComposite（在参数解析器章节提及）</p>
<pre><code>public class HandlerMethodArgumentResolverComposite implements HandlerMethodArgumentResolver &#123;
    
    @Override
    public boolean supportsParameter(MethodParameter parameter) &#123;
        return getArgumentResolver(parameter) != null;
    &#125;
    @Override
    @Nullable
    public Object resolveArgument(MethodParameter parameter, @Nullable ModelAndViewContainer mavContainer,
            NativeWebRequest webRequest, @Nullable WebDataBinderFactory binderFactory) throws Exception &#123;
        HandlerMethodArgumentResolver resolver = getArgumentResolver(parameter);
        if (resolver == null) &#123;
            throw new IllegalArgumentException(&quot;Unsupported parameter type [&quot; +
                    parameter.getParameterType().getName() + &quot;]. supportsParameter should be called first.&quot;);
        &#125;
        return resolver.resolveArgument(parameter, mavContainer, webRequest, binderFactory);
    &#125;
    
    
    @Nullable
    private HandlerMethodArgumentResolver getArgumentResolver(MethodParameter parameter) &#123;
        HandlerMethodArgumentResolver result = this.argumentResolverCache.get(parameter);
        if (result == null) &#123;
            //挨个判断所有参数解析器那个支持解析这个参数
            for (HandlerMethodArgumentResolver resolver : this.argumentResolvers) &#123;
                if (resolver.supportsParameter(parameter)) &#123;
                    result = resolver;
                    this.argumentResolverCache.put(parameter, result);//找到了，resolver就缓存起来，方便稍后resolveArgument()方法使用
                    break;
                &#125;
            &#125;
        &#125;
        return result;
    &#125;
&#125;
</code></pre>
<h3 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h3><p>本节描述，一个请求发送到DispatcherServlet后的具体处理流程，也就是SpringMVC的主要原理。</p>
<p>本节内容较多且硬核，对日后编程很有帮助，需耐心对待。</p>
<p>可以运行一个示例，打断点，在Debug模式下，查看程序流程。</p>
<h2 id="14-请求处理-【源码分析】-Servlet-API参数解析原理"><a href="#14-请求处理-【源码分析】-Servlet-API参数解析原理" class="headerlink" title="14. 请求处理-【源码分析】-Servlet API参数解析原理"></a>14. 请求处理-【源码分析】-Servlet API参数解析原理</h2><pre><code>WebRequest
ServletRequest
MultipartRequest
HttpSession
javax.servlet.http.PushBuilder
Principal
InputStream
Reader
HttpMethod
Locale
TimeZone
ZoneId
</code></pre>
<p><strong>ServletRequestMethodArgumentResolver用来处理以上的参数</strong></p>
<pre><code>public class ServletRequestMethodArgumentResolver implements HandlerMethodArgumentResolver &#123;
    @Nullable
    private static Class&lt;?&gt; pushBuilder;
    static &#123;
        try &#123;
            pushBuilder = ClassUtils.forName(&quot;javax.servlet.http.PushBuilder&quot;,
                    ServletRequestMethodArgumentResolver.class.getClassLoader());
        &#125;
        catch (ClassNotFoundException ex) &#123;
            // Servlet 4.0 PushBuilder not found - not supported for injection
            pushBuilder = null;
        &#125;
    &#125;
    @Override
    public boolean supportsParameter(MethodParameter parameter) &#123;
        Class&lt;?&gt; paramType = parameter.getParameterType();
        return (WebRequest.class.isAssignableFrom(paramType) ||
                ServletRequest.class.isAssignableFrom(paramType) ||
                MultipartRequest.class.isAssignableFrom(paramType) ||
                HttpSession.class.isAssignableFrom(paramType) ||
                (pushBuilder != null &amp;&amp; pushBuilder.isAssignableFrom(paramType)) ||
                (Principal.class.isAssignableFrom(paramType) &amp;&amp; !parameter.hasParameterAnnotations()) ||
                InputStream.class.isAssignableFrom(paramType) ||
                Reader.class.isAssignableFrom(paramType) ||
                HttpMethod.class == paramType ||
                Locale.class == paramType ||
                TimeZone.class == paramType ||
                ZoneId.class == paramType);
    &#125;
    @Override
    public Object resolveArgument(MethodParameter parameter, @Nullable ModelAndViewContainer mavContainer,
            NativeWebRequest webRequest, @Nullable WebDataBinderFactory binderFactory) throws Exception &#123;
        Class&lt;?&gt; paramType = parameter.getParameterType();
        // WebRequest / NativeWebRequest / ServletWebRequest
        if (WebRequest.class.isAssignableFrom(paramType)) &#123;
            if (!paramType.isInstance(webRequest)) &#123;
                throw new IllegalStateException(
                        &quot;Current request is not of type [&quot; + paramType.getName() + &quot;]: &quot; + webRequest);
            &#125;
            return webRequest;
        &#125;
        // ServletRequest / HttpServletRequest / MultipartRequest / MultipartHttpServletRequest
        if (ServletRequest.class.isAssignableFrom(paramType) || MultipartRequest.class.isAssignableFrom(paramType)) &#123;
            return resolveNativeRequest(webRequest, paramType);
        &#125;
        // HttpServletRequest required for all further argument types
        return resolveArgument(paramType, resolveNativeRequest(webRequest, HttpServletRequest.class));
    &#125;
    private &lt;T&gt; T resolveNativeRequest(NativeWebRequest webRequest, Class&lt;T&gt; requiredType) &#123;
        T nativeRequest = webRequest.getNativeRequest(requiredType);
        if (nativeRequest == null) &#123;
            throw new IllegalStateException(
                    &quot;Current request is not of type [&quot; + requiredType.getName() + &quot;]: &quot; + webRequest);
        &#125;
        return nativeRequest;
    &#125;
    @Nullable
    private Object resolveArgument(Class&lt;?&gt; paramType, HttpServletRequest request) throws IOException &#123;
        if (HttpSession.class.isAssignableFrom(paramType)) &#123;
            HttpSession session = request.getSession();
            if (session != null &amp;&amp; !paramType.isInstance(session)) &#123;
                throw new IllegalStateException(
                        &quot;Current session is not of type [&quot; + paramType.getName() + &quot;]: &quot; + session);
            &#125;
            return session;
        &#125;
        else if (pushBuilder != null &amp;&amp; pushBuilder.isAssignableFrom(paramType)) &#123;
            return PushBuilderDelegate.resolvePushBuilder(request, paramType);
        &#125;
        else if (InputStream.class.isAssignableFrom(paramType)) &#123;
            InputStream inputStream = request.getInputStream();
            if (inputStream != null &amp;&amp; !paramType.isInstance(inputStream)) &#123;
                throw new IllegalStateException(
                        &quot;Request input stream is not of type [&quot; + paramType.getName() + &quot;]: &quot; + inputStream);
            &#125;
            return inputStream;
        &#125;
        else if (Reader.class.isAssignableFrom(paramType)) &#123;
            Reader reader = request.getReader();
            if (reader != null &amp;&amp; !paramType.isInstance(reader)) &#123;
                throw new IllegalStateException(
                        &quot;Request body reader is not of type [&quot; + paramType.getName() + &quot;]: &quot; + reader);
            &#125;
            return reader;
        &#125;
        else if (Principal.class.isAssignableFrom(paramType)) &#123;
            Principal userPrincipal = request.getUserPrincipal();
            if (userPrincipal != null &amp;&amp; !paramType.isInstance(userPrincipal)) &#123;
                throw new IllegalStateException(
                        &quot;Current user principal is not of type [&quot; + paramType.getName() + &quot;]: &quot; + userPrincipal);
            &#125;
            return userPrincipal;
        &#125;
        else if (HttpMethod.class == paramType) &#123;
            return HttpMethod.resolve(request.getMethod());
        &#125;
        else if (Locale.class == paramType) &#123;
            return RequestContextUtils.getLocale(request);
        &#125;
        else if (TimeZone.class == paramType) &#123;
            TimeZone timeZone = RequestContextUtils.getTimeZone(request);
            return (timeZone != null ? timeZone : TimeZone.getDefault());
        &#125;
        else if (ZoneId.class == paramType) &#123;
            TimeZone timeZone = RequestContextUtils.getTimeZone(request);
            return (timeZone != null ? timeZone.toZoneId() : ZoneId.systemDefault());
        &#125;
        // Should never happen...
        throw new UnsupportedOperationException(&quot;Unknown parameter type: &quot; + paramType.getName());
    &#125;
    /**
     * Inner class to avoid a hard dependency on Servlet API 4.0 at runtime.
     */
    private static class PushBuilderDelegate &#123;
        @Nullable
        public static Object resolvePushBuilder(HttpServletRequest request, Class&lt;?&gt; paramType) &#123;
            PushBuilder pushBuilder = request.newPushBuilder();
            if (pushBuilder != null &amp;&amp; !paramType.isInstance(pushBuilder)) &#123;
                throw new IllegalStateException(
                        &quot;Current push builder is not of type [&quot; + paramType.getName() + &quot;]: &quot; + pushBuilder);
            &#125;
            return pushBuilder;
        &#125;
    &#125;
&#125;
</code></pre>
<p><strong>用例：</strong></p>
<pre><code>@Controller
public class RequestController &#123;
    @GetMapping(&quot;/goto&quot;)
    public String goToPage(HttpServletRequest request)&#123;
        request.setAttribute(&quot;msg&quot;,&quot;成功了...&quot;);
        request.setAttribute(&quot;code&quot;,200);
        return &quot;forward:/success&quot;;  //转发到  /success请求
    &#125;
&#125;
</code></pre>
<h2 id="15-请求处理-【源码分析】-Model、Map原理"><a href="#15-请求处理-【源码分析】-Model、Map原理" class="headerlink" title="15. 请求处理-【源码分析】-Model、Map原理"></a>15. 请求处理-【源码分析】-Model、Map原理</h2><p>复杂参数：</p>
<pre><code>Map
Model（map、model里面的数据会被放在request的请求域 request.setAttribute）
Errors/BindingResult
RedirectAttributes（ 重定向携带数据）
ServletResponse（response）
SessionStatus
UriComponentsBuilder
ServletUriComponentsBuilder
</code></pre>
<p><strong>用例：</strong></p>
<pre><code>@GetMapping(&quot;/params&quot;)
public String testParam(Map&lt;String,Object&gt; map,
                        Model model,
                        HttpServletRequest request,
                        HttpServletResponse response)&#123;
    //下面三位都是可以给request域中放数据
    map.put(&quot;hello&quot;,&quot;world666&quot;);
    model.addAttribute(&quot;world&quot;,&quot;hello666&quot;);
    request.setAttribute(&quot;message&quot;,&quot;HelloWorld&quot;);
    Cookie cookie = new Cookie(&quot;c1&quot;,&quot;v1&quot;);
    response.addCookie(cookie);
    return &quot;forward:/success&quot;;
&#125;
@ResponseBody
@GetMapping(&quot;/success&quot;)
public Map success(@RequestAttribute(value = &quot;msg&quot;,required = false) String msg,
                   @RequestAttribute(value = &quot;code&quot;,required = false)Integer code,
                   HttpServletRequest request)&#123;
    Object msg1 = request.getAttribute(&quot;msg&quot;);
    Map&lt;String,Object&gt; map = new HashMap&lt;&gt;();
    Object hello = request.getAttribute(&quot;hello&quot;);//得出testParam方法赋予的值 world666
    Object world = request.getAttribute(&quot;world&quot;);//得出testParam方法赋予的值 hello666
    Object message = request.getAttribute(&quot;message&quot;);//得出testParam方法赋予的值 HelloWorld
    map.put(&quot;reqMethod_msg&quot;,msg1);
    map.put(&quot;annotation_msg&quot;,msg);
    map.put(&quot;hello&quot;,hello);
    map.put(&quot;world&quot;,world);
    map.put(&quot;message&quot;,message);
    return map;
&#125;

Map&lt;String,Object&gt; map
Model model
HttpServletRequest request
</code></pre>
<p>上面三位都是可以给request域中放数据，用request.getAttribute()获取</p>
<p>接下来我们看看，Map&lt;String,Object&gt; map与Model model用什么参数处理器。</p>
<p>Map&lt;String,Object&gt; map参数用MapMethodProcessor处理：</p>
<pre><code>public class MapMethodProcessor implements HandlerMethodArgumentResolver, HandlerMethodReturnValueHandler &#123;
    @Override
    public boolean supportsParameter(MethodParameter parameter) &#123;
        return (Map.class.isAssignableFrom(parameter.getParameterType()) &amp;&amp;
                parameter.getParameterAnnotations().length == 0);
    &#125;
    @Override
    @Nullable
    public Object resolveArgument(MethodParameter parameter, @Nullable ModelAndViewContainer mavContainer,
            NativeWebRequest webRequest, @Nullable WebDataBinderFactory binderFactory) throws Exception &#123;
        Assert.state(mavContainer != null, &quot;ModelAndViewContainer is required for model exposure&quot;);
        return mavContainer.getModel();
    &#125;
    ...    
&#125;
</code></pre>
<p>mavContainer.getModel()如下：</p>
<pre><code>public class ModelAndViewContainer &#123;
    ...
    private final ModelMap defaultModel = new BindingAwareModelMap();
    @Nullable
    private ModelMap redirectModel;
    ...
    public ModelMap getModel() &#123;
        if (useDefaultModel()) &#123;
            return this.defaultModel;
        &#125;
        else &#123;
            if (this.redirectModel == null) &#123;
                this.redirectModel = new ModelMap();
            &#125;
            return this.redirectModel;
        &#125;
    &#125;
    
    private boolean useDefaultModel() &#123;
        return (!this.redirectModelScenario || (this.redirectModel == null &amp;&amp; !this.ignoreDefaultModelOnRedirect));
    &#125;
    ...   
&#125;
</code></pre>
<p>Model model用ModelMethodProcessor处理：</p>
<pre><code>public class ModelMethodProcessor implements HandlerMethodArgumentResolver, HandlerMethodReturnValueHandler &#123;
    @Override
    public boolean supportsParameter(MethodParameter parameter) &#123;
        return Model.class.isAssignableFrom(parameter.getParameterType());
    &#125;
    @Override
    @Nullable
    public Object resolveArgument(MethodParameter parameter, @Nullable ModelAndViewContainer mavContainer,
            NativeWebRequest webRequest, @Nullable WebDataBinderFactory binderFactory) throws Exception &#123;
        Assert.state(mavContainer != null, &quot;ModelAndViewContainer is required for model exposure&quot;);
        return mavContainer.getModel();
    &#125;
    ...
&#125;
</code></pre>
<p>return mavContainer.getModel();这跟MapMethodProcessor的一致</p>
<p><img src="/2021/05/19/SpringBoot2-BASE-2/5.png"></p>
<p>Model也是另一种意义的Map。</p>
<p>接下来看看 Map&lt;String,Object&gt; map与Model model值是如何做到用request.getAttribute()获取的。</p>
<p>众所周知，所有的数据都放在 ModelAndView包含要去的页面地址View，还包含Model数据。</p>
<p>先看ModelAndView接下来是如何处理的？</p>
<pre><code>public class DispatcherServlet extends FrameworkServlet &#123;	    
    ...
    
    protected void doDispatch(HttpServletRequest request, HttpServletResponse response) throws Exception &#123;
        ...
        try &#123;
            ModelAndView mv = null;
            
            ...
            // Actually invoke the handler.
            mv = ha.handle(processedRequest, response, mappedHandler.getHandler());
            
            ...
            
            &#125;
            catch (Exception ex) &#123;
                dispatchException = ex;
            &#125;
            catch (Throwable err) &#123;
                // As of 4.3, we&#39;re processing Errors thrown from handler methods as well,
                // making them available for @ExceptionHandler methods and other scenarios.
                dispatchException = new NestedServletException(&quot;Handler dispatch failed&quot;, err);
            &#125;
        	//处理分发结果
            processDispatchResult(processedRequest, response, mappedHandler, mv, dispatchException);
        &#125;
        ...
    &#125;
    private void processDispatchResult(HttpServletRequest request, HttpServletResponse response,
            @Nullable HandlerExecutionChain mappedHandler, @Nullable ModelAndView mv,
            @Nullable Exception exception) throws Exception &#123;
        ...
        // Did the handler return a view to render?
        if (mv != null &amp;&amp; !mv.wasCleared()) &#123;
            render(mv, request, response);
            ...
        &#125;
        ...
    &#125;
    protected void render(ModelAndView mv, HttpServletRequest request, HttpServletResponse response) throws Exception &#123;
        ...
        View view;
        String viewName = mv.getViewName();
        if (viewName != null) &#123;
            // We need to resolve the view name.
            view = resolveViewName(viewName, mv.getModelInternal(), locale, request);
            if (view == null) &#123;
                throw new ServletException(&quot;Could not resolve view with name &#39;&quot; + mv.getViewName() +
                        &quot;&#39; in servlet with name &#39;&quot; + getServletName() + &quot;&#39;&quot;);
            &#125;
        &#125;
        else &#123;
            // No need to lookup: the ModelAndView object contains the actual View object.
            view = mv.getView();
            if (view == null) &#123;
                throw new ServletException(&quot;ModelAndView [&quot; + mv + &quot;] neither contains a view name nor a &quot; +
                        &quot;View object in servlet with name &#39;&quot; + getServletName() + &quot;&#39;&quot;);
            &#125;
        &#125;
        view.render(mv.getModelInternal(), request, response);
        
        ...
    &#125;
&#125;
</code></pre>
<p>在Debug模式下，view属为InternalResourceView类。</p>
<pre><code>public class InternalResourceView extends AbstractUrlBasedView &#123;	    
 	@Override//该方法在AbstractView，AbstractUrlBasedView继承了AbstractView
    public void render(@Nullable Map&lt;String, ?&gt; model, HttpServletRequest request,
            HttpServletResponse response) throws Exception &#123;			
        ...
        
        Map&lt;String, Object&gt; mergedModel = createMergedOutputModel(model, request, response);
        prepareResponse(request, response);
        
        //看下一个方法实现
        renderMergedOutputModel(mergedModel, getRequestToExpose(request), response);
    &#125;
    
    @Override
    protected void renderMergedOutputModel(
            Map&lt;String, Object&gt; model, HttpServletRequest request, HttpServletResponse response) throws Exception &#123;
        // Expose the model object as request attributes.
        // 暴露模型作为请求域属性
        exposeModelAsRequestAttributes(model, request);//&lt;---重点
        // Expose helpers as request attributes, if any.
        exposeHelpers(request);
        // Determine the path for the request dispatcher.
        String dispatcherPath = prepareForRendering(request, response);
        // Obtain a RequestDispatcher for the target resource (typically a JSP).
        RequestDispatcher rd = getRequestDispatcher(request, dispatcherPath);
        
        ...
    &#125;
    
    //该方法在AbstractView，AbstractUrlBasedView继承了AbstractView
    protected void exposeModelAsRequestAttributes(Map&lt;String, Object&gt; model,
            HttpServletRequest request) throws Exception &#123;
        model.forEach((name, value) -&gt; &#123;
            if (value != null) &#123;
                request.setAttribute(name, value);
            &#125;
            else &#123;
                request.removeAttribute(name);
            &#125;
        &#125;);
    &#125;   
&#125;
</code></pre>
<p>exposeModelAsRequestAttributes方法看出，Map&lt;String,Object&gt; map，Model model这两种类型数据可以给request域中放数据，用request.getAttribute()获取。</p>
<h2 id="16-请求处理-【源码分析】-自定义参数绑定原理"><a href="#16-请求处理-【源码分析】-自定义参数绑定原理" class="headerlink" title="16. 请求处理-【源码分析】-自定义参数绑定原理"></a>16. 请求处理-【源码分析】-自定义参数绑定原理</h2><pre><code>@RestController
public class ParameterTestController &#123;
    /**
     * 数据绑定：页面提交的请求数据（GET、POST）都可以和对象属性进行绑定
     * @param person
     * @return
     */
    @PostMapping(&quot;/saveuser&quot;)
    public Person saveuser(Person person)&#123;
        return person;
    &#125;
&#125;

/**
 *     姓名： &lt;input name=&quot;userName&quot;/&gt; &lt;br/&gt;
 *     年龄： &lt;input name=&quot;age&quot;/&gt; &lt;br/&gt;
 *     生日： &lt;input name=&quot;birth&quot;/&gt; &lt;br/&gt;
 *     宠物姓名：&lt;input name=&quot;pet.name&quot;/&gt;&lt;br/&gt;
 *     宠物年龄：&lt;input name=&quot;pet.age&quot;/&gt;
 */
@Data
public class Person &#123;
    
    private String userName;
    private Integer age;
    private Date birth;
    private Pet pet;	    
&#125;

@Data
public class Pet &#123;
    private String name;
    private String age;
&#125;
</code></pre>
<p>封装过程用到ServletModelAttributeMethodProcessor</p>
<pre><code>public class ServletModelAttributeMethodProcessor extends ModelAttributeMethodProcessor &#123;		
    @Override//本方法在ModelAttributeMethodProcessor类，
    public boolean supportsParameter(MethodParameter parameter) &#123;
        return (parameter.hasParameterAnnotation(ModelAttribute.class) ||
                (this.annotationNotRequired &amp;&amp; !BeanUtils.isSimpleProperty(parameter.getParameterType())));
    &#125;
    @Override
    @Nullable//本方法在ModelAttributeMethodProcessor类，
    public final Object resolveArgument(MethodParameter parameter, @Nullable ModelAndViewContainer mavContainer,
            NativeWebRequest webRequest, @Nullable WebDataBinderFactory binderFactory) throws Exception &#123;
        ...
        String name = ModelFactory.getNameForParameter(parameter);
        ModelAttribute ann = parameter.getParameterAnnotation(ModelAttribute.class);
        if (ann != null) &#123;
            mavContainer.setBinding(name, ann.binding());
        &#125;
        Object attribute = null;
        BindingResult bindingResult = null;
        if (mavContainer.containsAttribute(name)) &#123;
            attribute = mavContainer.getModel().get(name);
        &#125;
        else &#123;
            // Create attribute instance
            try &#123;
                attribute = createAttribute(name, parameter, binderFactory, webRequest);
            &#125;
            catch (BindException ex) &#123;
                ...
            &#125;
        &#125;
        if (bindingResult == null) &#123;
            // Bean property binding and validation;
            // skipped in case of binding failure on construction.
            WebDataBinder binder = binderFactory.createBinder(webRequest, attribute, name);
            if (binder.getTarget() != null) &#123;
                if (!mavContainer.isBindingDisabled(name)) &#123;
                    //web数据绑定器，将请求参数的值绑定到指定的JavaBean里面**
                    bindRequestParameters(binder, webRequest);
                &#125;
                validateIfApplicable(binder, parameter);
                if (binder.getBindingResult().hasErrors() &amp;&amp; isBindExceptionRequired(binder, parameter)) &#123;
                    throw new BindException(binder.getBindingResult());
                &#125;
            &#125;
            // Value type adaptation, also covering java.util.Optional
            if (!parameter.getParameterType().isInstance(attribute)) &#123;
                attribute = binder.convertIfNecessary(binder.getTarget(), parameter.getParameterType(), parameter);
            &#125;
            bindingResult = binder.getBindingResult();
        &#125;
        // Add resolved attribute and BindingResult at the end of the model
        Map&lt;String, Object&gt; bindingResultModel = bindingResult.getModel();
        mavContainer.removeAttributes(bindingResultModel);
        mavContainer.addAllAttributes(bindingResultModel);
        return attribute;
    &#125;
&#125;
</code></pre>
<p>WebDataBinder 利用它里面的 Converters 将请求数据转成指定的数据类型。再次封装到JavaBean中</p>
<p>在过程当中，用到GenericConversionService：在设置每一个值的时候，找它里面的所有converter那个可以将这个数据类型（request带来参数的字符串）转换到指定的类型</p>
<h2 id="17-请求处理-【源码分析】-自定义Converter原理"><a href="#17-请求处理-【源码分析】-自定义Converter原理" class="headerlink" title="17. 请求处理-【源码分析】-自定义Converter原理"></a>17. 请求处理-【源码分析】-自定义Converter原理</h2><p>未来我们可以给WebDataBinder里面放自己的Converter；</p>
<p>下面演示将字符串“啊猫,3”转换成Pet对象。</p>
<pre><code>//1、WebMvcConfigurer定制化SpringMVC的功能
@Bean
public WebMvcConfigurer webMvcConfigurer()&#123;
    return new WebMvcConfigurer() &#123;
        @Override
        public void addFormatters(FormatterRegistry registry) &#123;
            registry.addConverter(new Converter&lt;String, Pet&gt;() &#123;
                @Override
                public Pet convert(String source) &#123;
                    // 啊猫,3
                    if(!StringUtils.isEmpty(source))&#123;
                        Pet pet = new Pet();
                        String[] split = source.split(&quot;,&quot;);
                        pet.setName(split[0]);
                        pet.setAge(Integer.parseInt(split[1]));
                        return pet;
                    &#125;
                    return null;
                &#125;
            &#125;);
        &#125;
    &#125;;
&#125;
</code></pre>
<h2 id="18-响应处理-【源码分析】-ReturnValueHandler原理"><a href="#18-响应处理-【源码分析】-ReturnValueHandler原理" class="headerlink" title="18. 响应处理-【源码分析】-ReturnValueHandler原理"></a>18. 响应处理-【源码分析】-ReturnValueHandler原理</h2><p><img src="/2021/05/19/SpringBoot2-BASE-2/6.png"></p>
<p>假设给前端自动返回json数据，需要引入相关的依赖</p>
<pre><code>&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
&lt;/dependency&gt;
&lt;!-- web场景自动引入了json场景 --&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-json&lt;/artifactId&gt;
    &lt;version&gt;2.3.4.RELEASE&lt;/version&gt;
    &lt;scope&gt;compile&lt;/scope&gt;
&lt;/dependency&gt;
</code></pre>
<p>控制层代码如下：</p>
<p>@Controller<br>public class ResponseTestController {</p>
<pre><code>@ResponseBody  //利用返回值处理器里面的消息转换器进行处理
@GetMapping(value = &quot;/test/person&quot;)
public Person getPerson()&#123;
    Person person = new Person();
    person.setAge(28);
    person.setBirth(new Date());
    person.setUserName(&quot;zhangsan&quot;);
    return person;
&#125;
</code></pre>
<p>}</p>
<p>请求处理-【源码分析】-各种类型参数解析原理 - 返回值处理器有讨论ReturnValueHandler。</p>
<pre><code>public class RequestMappingHandlerAdapter extends AbstractHandlerMethodAdapter
        implements BeanFactoryAware, InitializingBean &#123;
    ...
    
    @Nullable
    protected ModelAndView invokeHandlerMethod(HttpServletRequest request,
            HttpServletResponse response, HandlerMethod handlerMethod) throws Exception &#123;
        ServletWebRequest webRequest = new ServletWebRequest(request, response);
        try &#123;
            
            ...
            
            ServletInvocableHandlerMethod invocableMethod = createInvocableHandlerMethod(handlerMethod);
                
            if (this.argumentResolvers != null) &#123;
                invocableMethod.setHandlerMethodArgumentResolvers(this.argumentResolvers);
            &#125;
            if (this.returnValueHandlers != null) &#123;//&lt;----关注点
                invocableMethod.setHandlerMethodReturnValueHandlers(this.returnValueHandlers);
            &#125;
            ...
            invocableMethod.invokeAndHandle(webRequest, mavContainer);//看下块代码
            if (asyncManager.isConcurrentHandlingStarted()) &#123;
                return null;
            &#125;
            return getModelAndView(mavContainer, modelFactory, webRequest);
        &#125;
        finally &#123;
            webRequest.requestCompleted();
        &#125;
    &#125;

public class ServletInvocableHandlerMethod extends InvocableHandlerMethod &#123;   
    public void invokeAndHandle(ServletWebRequest webRequest, ModelAndViewContainer mavContainer,
            Object... providedArgs) throws Exception &#123;
        Object returnValue = invokeForRequest(webRequest, mavContainer, providedArgs);
        ...
        
        try &#123;
            //看下块代码
            this.returnValueHandlers.handleReturnValue(
                    returnValue, getReturnValueType(returnValue), mavContainer, webRequest);
        &#125;
        catch (Exception ex) &#123;
            ...
        &#125;
    &#125;

public class HandlerMethodReturnValueHandlerComposite implements HandlerMethodReturnValueHandler &#123;    
    ...
    
    @Override
    public void handleReturnValue(@Nullable Object returnValue, MethodParameter returnType,
            ModelAndViewContainer mavContainer, NativeWebRequest webRequest) throws Exception &#123;
        //selectHandler()实现在下面
        HandlerMethodReturnValueHandler handler = selectHandler(returnValue, returnType);
        if (handler == null) &#123;
            throw new IllegalArgumentException(&quot;Unknown return value type: &quot; + returnType.getParameterType().getName());
        &#125;
        //开始处理
        handler.handleReturnValue(returnValue, returnType, mavContainer, webRequest);
    &#125;
    
   	@Nullable
    private HandlerMethodReturnValueHandler selectHandler(@Nullable Object value, MethodParameter returnType) &#123;
        boolean isAsyncValue = isAsyncReturnValue(value, returnType);
        for (HandlerMethodReturnValueHandler handler : this.returnValueHandlers) &#123;
            if (isAsyncValue &amp;&amp; !(handler instanceof AsyncHandlerMethodReturnValueHandler)) &#123;
                continue;
            &#125;
            if (handler.supportsReturnType(returnType)) &#123;
                return handler;
            &#125;
        &#125;
        return null;
    &#125;
</code></pre>
<p>@ResponseBody 注解，即RequestResponseBodyMethodProcessor，它实现HandlerMethodReturnValueHandler接口</p>
<pre><code>public class RequestResponseBodyMethodProcessor extends AbstractMessageConverterMethodProcessor &#123;
    ...
    
    @Override
    public void handleReturnValue(@Nullable Object returnValue, MethodParameter returnType,
            ModelAndViewContainer mavContainer, NativeWebRequest webRequest)
            throws IOException, HttpMediaTypeNotAcceptableException, HttpMessageNotWritableException &#123;
        mavContainer.setRequestHandled(true);
        ServletServerHttpRequest inputMessage = createInputMessage(webRequest);
        ServletServerHttpResponse outputMessage = createOutputMessage(webRequest);
        // 使用消息转换器进行写出操作，本方法下一章节介绍：
        // Try even with null return value. ResponseBodyAdvice could get involved.
        writeWithMessageConverters(returnValue, returnType, inputMessage, outputMessage);
    &#125;
&#125;
</code></pre>
<h2 id="19-响应处理-【源码分析】-HTTPMessageConverter原理"><a href="#19-响应处理-【源码分析】-HTTPMessageConverter原理" class="headerlink" title="19. 响应处理-【源码分析】-HTTPMessageConverter原理"></a>19. 响应处理-【源码分析】-HTTPMessageConverter原理</h2><p>返回值处理器ReturnValueHandler原理：</p>
<pre><code>1. 返回值处理器判断是否支持这种类型返回值 supportsReturnType
2. 返回值处理器调用 handleReturnValue 进行处理
3. RequestResponseBodyMethodProcessor 可以处理返回值标了@ResponseBody 注解的。
    1. 利用 MessageConverters 进行处理 将数据写为json
        1. 内容协商（浏览器默认会以请求头的方式告诉服务器他能接受什么样的内容类型）
        2. 服务器最终根据自己自身的能力，决定服务器能生产出什么样内容类型的数据，
        3. SpringMVC会挨个遍历所有容器底层的 HttpMessageConverter ，看谁能处理？
            1. 得到MappingJackson2HttpMessageConverter可以将对象写为json
            2. 利用MappingJackson2HttpMessageConverter将对象转为json再写出去。

//RequestResponseBodyMethodProcessor继承这类
public abstract class AbstractMessageConverterMethodProcessor extends AbstractMessageConverterMethodArgumentResolver
        implements HandlerMethodReturnValueHandler &#123;
    ...
    
    //承接上一节内容
    protected &lt;T&gt; void writeWithMessageConverters(@Nullable T value, MethodParameter returnType,
                ServletServerHttpRequest inputMessage, ServletServerHttpResponse outputMessage)
                throws IOException, HttpMediaTypeNotAcceptableException, HttpMessageNotWritableException &#123;
            Object body;
            Class&lt;?&gt; valueType;
            Type targetType;
            if (value instanceof CharSequence) &#123;
                body = value.toString();
                valueType = String.class;
                targetType = String.class;
            &#125;
            else &#123;
                body = value;
                valueType = getReturnValueType(body, returnType);
                targetType = GenericTypeResolver.resolveType(getGenericType(returnType), returnType.getContainingClass());
            &#125;
            ...
            //内容协商（浏览器默认会以请求头(参数Accept)的方式告诉服务器他能接受什么样的内容类型）
            MediaType selectedMediaType = null;
            MediaType contentType = outputMessage.getHeaders().getContentType();
            boolean isContentTypePreset = contentType != null &amp;&amp; contentType.isConcrete();
            if (isContentTypePreset) &#123;
                if (logger.isDebugEnabled()) &#123;
                    logger.debug(&quot;Found &#39;Content-Type:&quot; + contentType + &quot;&#39; in response&quot;);
                &#125;
                selectedMediaType = contentType;
            &#125;
            else &#123;
                HttpServletRequest request = inputMessage.getServletRequest();
                List&lt;MediaType&gt; acceptableTypes = getAcceptableMediaTypes(request);
                //服务器最终根据自己自身的能力，决定服务器能生产出什么样内容类型的数据
                List&lt;MediaType&gt; producibleTypes = getProducibleMediaTypes(request, valueType, targetType);
                if (body != null &amp;&amp; producibleTypes.isEmpty()) &#123;
                    throw new HttpMessageNotWritableException(
                            &quot;No converter found for return value of type: &quot; + valueType);
                &#125;
                List&lt;MediaType&gt; mediaTypesToUse = new ArrayList&lt;&gt;();
                for (MediaType requestedType : acceptableTypes) &#123;
                    for (MediaType producibleType : producibleTypes) &#123;
                        if (requestedType.isCompatibleWith(producibleType)) &#123;
                            mediaTypesToUse.add(getMostSpecificMediaType(requestedType, producibleType));
                        &#125;
                    &#125;
                &#125;
                if (mediaTypesToUse.isEmpty()) &#123;
                    if (body != null) &#123;
                        throw new HttpMediaTypeNotAcceptableException(producibleTypes);
                    &#125;
                    if (logger.isDebugEnabled()) &#123;
                        logger.debug(&quot;No match for &quot; + acceptableTypes + &quot;, supported: &quot; + producibleTypes);
                    &#125;
                    return;
                &#125;
                MediaType.sortBySpecificityAndQuality(mediaTypesToUse);
                //选择一个MediaType
                for (MediaType mediaType : mediaTypesToUse) &#123;
                    if (mediaType.isConcrete()) &#123;
                        selectedMediaType = mediaType;
                        break;
                    &#125;
                    else if (mediaType.isPresentIn(ALL_APPLICATION_MEDIA_TYPES)) &#123;
                        selectedMediaType = MediaType.APPLICATION_OCTET_STREAM;
                        break;
                    &#125;
                &#125;
                if (logger.isDebugEnabled()) &#123;
                    logger.debug(&quot;Using &#39;&quot; + selectedMediaType + &quot;&#39;, given &quot; +
                            acceptableTypes + &quot; and supported &quot; + producibleTypes);
                &#125;
            &#125;
        	
            if (selectedMediaType != null) &#123;
                selectedMediaType = selectedMediaType.removeQualityValue();
                //本节主角：HttpMessageConverter
                for (HttpMessageConverter&lt;?&gt; converter : this.messageConverters) &#123;
                    GenericHttpMessageConverter genericConverter = (converter instanceof GenericHttpMessageConverter ?
                            (GenericHttpMessageConverter&lt;?&gt;) converter : null);
                    
                    //判断是否可写
                    if (genericConverter != null ?
                            ((GenericHttpMessageConverter) converter).canWrite(targetType, valueType, selectedMediaType) :
                            converter.canWrite(valueType, selectedMediaType)) &#123;
                        body = getAdvice().beforeBodyWrite(body, returnType, selectedMediaType,
                                (Class&lt;? extends HttpMessageConverter&lt;?&gt;&gt;) converter.getClass(),
                                inputMessage, outputMessage);
                        if (body != null) &#123;
                            Object theBody = body;
                            LogFormatUtils.traceDebug(logger, traceOn -&gt;
                                    &quot;Writing [&quot; + LogFormatUtils.formatValue(theBody, !traceOn) + &quot;]&quot;);
                            addContentDispositionHeader(inputMessage, outputMessage);
                            //开始写入
                            if (genericConverter != null) &#123;
                                genericConverter.write(body, targetType, selectedMediaType, outputMessage);
                            &#125;
                            else &#123;
                                ((HttpMessageConverter) converter).write(body, selectedMediaType, outputMessage);
                            &#125;
                        &#125;
                        else &#123;
                            if (logger.isDebugEnabled()) &#123;
                                logger.debug(&quot;Nothing to write: null body&quot;);
                            &#125;
                        &#125;
                        return;
                    &#125;
                &#125;
            &#125;
            ...
        &#125;
</code></pre>
<p><strong>HTTPMessageConverter接口：</strong></p>
<pre><code>/**
 * Strategy interface for converting from and to HTTP requests and responses.
 */
public interface HttpMessageConverter&lt;T&gt; &#123;
    /**
     * Indicates whether the given class can be read by this converter.
     */
    boolean canRead(Class&lt;?&gt; clazz, @Nullable MediaType mediaType);
    /**
     * Indicates whether the given class can be written by this converter.
     */
    boolean canWrite(Class&lt;?&gt; clazz, @Nullable MediaType mediaType);
    /**
     * Return the list of &#123;@link MediaType&#125; objects supported by this converter.
     */
    List&lt;MediaType&gt; getSupportedMediaTypes();
    /**
     * Read an object of the given type from the given input message, and returns it.
     */
    T read(Class&lt;? extends T&gt; clazz, HttpInputMessage inputMessage)
            throws IOException, HttpMessageNotReadableException;
    /**
     * Write an given object to the given output message.
     */
    void write(T t, @Nullable MediaType contentType, HttpOutputMessage outputMessage)
            throws IOException, HttpMessageNotWritableException;
&#125;
</code></pre>
<p>HttpMessageConverter: 看是否支持将 此 Class类型的对象，转为MediaType类型的数据。</p>
<p>例子：Person对象转为JSON，或者 JSON转为Person，这将用到 MappingJackson2HttpMessageConverter</p>
<p><img src="/2021/05/19/SpringBoot2-BASE-2/7.png"></p>
<pre><code>public class MappingJackson2HttpMessageConverter extends AbstractJackson2HttpMessageConverter &#123;
    ...
&#125;
</code></pre>
<p>关于MappingJackson2HttpMessageConverter的实例化请看下节。</p>
<h3 id="关于HttpMessageConverters的初始化"><a href="#关于HttpMessageConverters的初始化" class="headerlink" title="关于HttpMessageConverters的初始化"></a>关于HttpMessageConverters的初始化</h3><p>DispatcherServlet的初始化时会调用initHandlerAdapters(ApplicationContext context)</p>
<pre><code>public class DispatcherServlet extends FrameworkServlet &#123;	    
    ...
    
    private void initHandlerAdapters(ApplicationContext context) &#123;
        this.handlerAdapters = null;
        if (this.detectAllHandlerAdapters) &#123;
            // Find all HandlerAdapters in the ApplicationContext, including ancestor contexts.
            Map&lt;String, HandlerAdapter&gt; matchingBeans =
                    BeanFactoryUtils.beansOfTypeIncludingAncestors(context, HandlerAdapter.class, true, false);
            if (!matchingBeans.isEmpty()) &#123;
                this.handlerAdapters = new ArrayList&lt;&gt;(matchingBeans.values());
                // We keep HandlerAdapters in sorted order.
                AnnotationAwareOrderComparator.sort(this.handlerAdapters);
            &#125;
        &#125;
      ...
</code></pre>
<p>上述代码会加载ApplicationContext的所有HandlerAdapter，用来处理@RequestMapping的RequestMappingHandlerAdapter实现HandlerAdapter接口，RequestMappingHandlerAdapter也被实例化。</p>
<pre><code>public class RequestMappingHandlerAdapter extends AbstractHandlerMethodAdapter
        implements BeanFactoryAware, InitializingBean &#123;	    
    ...
    private List&lt;HttpMessageConverter&lt;?&gt;&gt; messageConverters;
    
    ...
    
    public RequestMappingHandlerAdapter() &#123;
        this.messageConverters = new ArrayList&lt;&gt;(4);
        this.messageConverters.add(new ByteArrayHttpMessageConverter());
        this.messageConverters.add(new StringHttpMessageConverter());
        if (!shouldIgnoreXml) &#123;
            try &#123;
                this.messageConverters.add(new SourceHttpMessageConverter&lt;&gt;());
            &#125;
            catch (Error err) &#123;
                // Ignore when no TransformerFactory implementation is available
            &#125;
        &#125;
        this.messageConverters.add(new AllEncompassingFormHttpMessageConverter());
    &#125;
</code></pre>
<p>在构造器中看到一堆HttpMessageConverter。接着，重点查看AllEncompassingFormHttpMessageConverter类：</p>
<pre><code>public class AllEncompassingFormHttpMessageConverter extends FormHttpMessageConverter &#123;
    /**
     * Boolean flag controlled by a &#123;@code spring.xml.ignore&#125; system property that instructs Spring to
     * ignore XML, i.e. to not initialize the XML-related infrastructure.
     * &lt;p&gt;The default is &quot;false&quot;.
     */
    private static final boolean shouldIgnoreXml = SpringProperties.getFlag(&quot;spring.xml.ignore&quot;);
    private static final boolean jaxb2Present;
    private static final boolean jackson2Present;
    private static final boolean jackson2XmlPresent;
    private static final boolean jackson2SmilePresent;
    private static final boolean gsonPresent;
    private static final boolean jsonbPresent;
    private static final boolean kotlinSerializationJsonPresent;
    static &#123;
        ClassLoader classLoader = AllEncompassingFormHttpMessageConverter.class.getClassLoader();
        jaxb2Present = ClassUtils.isPresent(&quot;javax.xml.bind.Binder&quot;, classLoader);
        jackson2Present = ClassUtils.isPresent(&quot;com.fasterxml.jackson.databind.ObjectMapper&quot;, classLoader) &amp;&amp;
                        ClassUtils.isPresent(&quot;com.fasterxml.jackson.core.JsonGenerator&quot;, classLoader);
        jackson2XmlPresent = ClassUtils.isPresent(&quot;com.fasterxml.jackson.dataformat.xml.XmlMapper&quot;, classLoader);
        jackson2SmilePresent = ClassUtils.isPresent(&quot;com.fasterxml.jackson.dataformat.smile.SmileFactory&quot;, classLoader);
        gsonPresent = ClassUtils.isPresent(&quot;com.google.gson.Gson&quot;, classLoader);
        jsonbPresent = ClassUtils.isPresent(&quot;javax.json.bind.Jsonb&quot;, classLoader);
        kotlinSerializationJsonPresent = ClassUtils.isPresent(&quot;kotlinx.serialization.json.Json&quot;, classLoader);
    &#125;
    public AllEncompassingFormHttpMessageConverter() &#123;
        if (!shouldIgnoreXml) &#123;
            try &#123;
                addPartConverter(new SourceHttpMessageConverter&lt;&gt;());
            &#125;
            catch (Error err) &#123;
                // Ignore when no TransformerFactory implementation is available
            &#125;
            if (jaxb2Present &amp;&amp; !jackson2XmlPresent) &#123;
                addPartConverter(new Jaxb2RootElementHttpMessageConverter());
            &#125;
        &#125;
        if (jackson2Present) &#123;
            addPartConverter(new MappingJackson2HttpMessageConverter());//&lt;----重点看这里
        &#125;
        else if (gsonPresent) &#123;
            addPartConverter(new GsonHttpMessageConverter());
        &#125;
        else if (jsonbPresent) &#123;
            addPartConverter(new JsonbHttpMessageConverter());
        &#125;
        else if (kotlinSerializationJsonPresent) &#123;
            addPartConverter(new KotlinSerializationJsonHttpMessageConverter());
        &#125;
        if (jackson2XmlPresent &amp;&amp; !shouldIgnoreXml) &#123;
            addPartConverter(new MappingJackson2XmlHttpMessageConverter());
        &#125;
        if (jackson2SmilePresent) &#123;
            addPartConverter(new MappingJackson2SmileHttpMessageConverter());
        &#125;
    &#125;
&#125;

public class FormHttpMessageConverter implements HttpMessageConverter&lt;MultiValueMap&lt;String, ?&gt;&gt; &#123;	    
    ...
        
    private List&lt;HttpMessageConverter&lt;?&gt;&gt; partConverters = new ArrayList&lt;&gt;();	    
    ...
        
    public void addPartConverter(HttpMessageConverter&lt;?&gt; partConverter) &#123;
        Assert.notNull(partConverter, &quot;&#39;partConverter&#39; must not be null&quot;);
        this.partConverters.add(partConverter);
    &#125;	    
    ...
&#125;
</code></pre>
<p>在AllEncompassingFormHttpMessageConverter类构造器看到MappingJackson2HttpMessageConverter类的实例化，AllEncompassingFormHttpMessageConverter包含MappingJackson2HttpMessageConverter。</p>
<p>ReturnValueHandler是怎么与MappingJackson2HttpMessageConverter关联起来？请看下节。</p>
<h3 id="ReturnValueHandler与MappingJackson2HttpMessageConverter关联"><a href="#ReturnValueHandler与MappingJackson2HttpMessageConverter关联" class="headerlink" title="ReturnValueHandler与MappingJackson2HttpMessageConverter关联"></a>ReturnValueHandler与MappingJackson2HttpMessageConverter关联</h3><p>再次回顾RequestMappingHandlerAdapter</p>
<pre><code>public class RequestMappingHandlerAdapter extends AbstractHandlerMethodAdapter
        implements BeanFactoryAware, InitializingBean &#123;	    
    ...
    @Nullable
    private HandlerMethodReturnValueHandlerComposite returnValueHandlers;//我们关注的returnValueHandlers
    
   	
    @Override
    @Nullable//本方法在AbstractHandlerMethodAdapter
    public final ModelAndView handle(HttpServletRequest request, HttpServletResponse response, Object handler)
            throws Exception &#123;
        return handleInternal(request, response, (HandlerMethod) handler);
    &#125;
        
    @Override
    protected ModelAndView handleInternal(HttpServletRequest request,
            HttpServletResponse response, HandlerMethod handlerMethod) throws Exception &#123;
        ModelAndView mav;
        ...
        mav = invokeHandlerMethod(request, response, handlerMethod);
        ...
        return mav;
    &#125;
    
    @Nullable
    protected ModelAndView invokeHandlerMethod(HttpServletRequest request,
            HttpServletResponse response, HandlerMethod handlerMethod) throws Exception &#123;
        ServletWebRequest webRequest = new ServletWebRequest(request, response);
        try &#123;
            WebDataBinderFactory binderFactory = getDataBinderFactory(handlerMethod);
            ModelFactory modelFactory = getModelFactory(handlerMethod, binderFactory);
            ServletInvocableHandlerMethod invocableMethod = createInvocableHandlerMethod(handlerMethod);
            if (this.argumentResolvers != null) &#123;
                invocableMethod.setHandlerMethodArgumentResolvers(this.argumentResolvers);
            &#125;
            if (this.returnValueHandlers != null) &#123;//&lt;---我们关注的returnValueHandlers
                invocableMethod.setHandlerMethodReturnValueHandlers(this.returnValueHandlers);
            &#125;
            
            ...
            
            invocableMethod.invokeAndHandle(webRequest, mavContainer);
            if (asyncManager.isConcurrentHandlingStarted()) &#123;
                return null;
            &#125;
            return getModelAndView(mavContainer, modelFactory, webRequest);
        &#125;
        finally &#123;
            webRequest.requestCompleted();
        &#125;
    &#125;
    
   @Override
    public void afterPropertiesSet() &#123;
        // Do this first, it may add ResponseBody advice beans
        
        ...
        
        if (this.returnValueHandlers == null) &#123;//赋值returnValueHandlers
            List&lt;HandlerMethodReturnValueHandler&gt; handlers = getDefaultReturnValueHandlers();
            this.returnValueHandlers = new HandlerMethodReturnValueHandlerComposite().addHandlers(handlers);
        &#125;
    &#125;
    
    private List&lt;HandlerMethodReturnValueHandler&gt; getDefaultReturnValueHandlers() &#123;
        List&lt;HandlerMethodReturnValueHandler&gt; handlers = new ArrayList&lt;&gt;(20);
        ...
        // Annotation-based return value types
        //这里就是 ReturnValueHandler与 MappingJackson2HttpMessageConverter关联 的关键点
        handlers.add(new RequestResponseBodyMethodProcessor(getMessageConverters(),//&lt;---MessageConverters也就传参传进来的
                this.contentNegotiationManager, this.requestResponseBodyAdvice));//
        ...
        return handlers;
    &#125;
    
    //------
    
    public List&lt;HttpMessageConverter&lt;?&gt;&gt; getMessageConverters() &#123;
        return this.messageConverters;
    &#125;
    
    //RequestMappingHandlerAdapter构造器已初始化部分messageConverters
   	public RequestMappingHandlerAdapter() &#123;
        this.messageConverters = new ArrayList&lt;&gt;(4);
        this.messageConverters.add(new ByteArrayHttpMessageConverter());
        this.messageConverters.add(new StringHttpMessageConverter());
        if (!shouldIgnoreXml) &#123;
            try &#123;
                this.messageConverters.add(new SourceHttpMessageConverter&lt;&gt;());
            &#125;
            catch (Error err) &#123;
                // Ignore when no TransformerFactory implementation is available
            &#125;
        &#125;
        this.messageConverters.add(new AllEncompassingFormHttpMessageConverter());
    &#125;
    ...
              
&#125;
</code></pre>
<p>应用中WebMvcAutoConfiguration（底层是WebMvcConfigurationSupport实现）传入更多messageConverters，其中就包含MappingJackson2HttpMessageConverter。</p>
<h2 id="20-响应处理-【源码分析】-内容协商原理"><a href="#20-响应处理-【源码分析】-内容协商原理" class="headerlink" title="20. 响应处理-【源码分析】-内容协商原理"></a>20. 响应处理-【源码分析】-内容协商原理</h2><p>根据客户端接收能力不同，返回不同媒体类型的数据。</p>
<p><strong>引入XML依赖：</strong></p>
<pre><code>&lt;dependency&gt;
     &lt;groupId&gt;com.fasterxml.jackson.dataformat&lt;/groupId&gt;
     &lt;artifactId&gt;jackson-dataformat-xml&lt;/artifactId&gt;
&lt;/dependency&gt;
</code></pre>
<p>可用Postman软件分别测试返回json和xml：只需要改变请求头中Accept字段（application&#x2F;json、application&#x2F;xml）。</p>
<p>Http协议中规定的，Accept字段告诉服务器本客户端可以接收的数据类型。</p>
<p><strong>内容协商原理：</strong></p>
<pre><code>1. 判断当前响应头中是否已经有确定的媒体类型MediaType。
2. 获取客户端（PostMan、浏览器）支持接收的内容类型。（获取客户端Accept请求头字段application/xml）（这一步在下一节有详细介绍）
    contentNegotiationManager 内容协商管理器 默认使用基于请求头的策略
    HeaderContentNegotiationStrategy 确定客户端可以接收的内容类型
3. 遍历循环所有当前系统的 MessageConverter，看谁支持操作这个对象（Person）
4. 找到支持操作Person的converter，把converter支持的媒体类型统计出来。
5. 客户端需要application/xml，服务端有10种MediaType。
6. 进行内容协商的最佳匹配媒体类型
7. 用 支持 将对象转为 最佳匹配媒体类型 的converter。调用它进行转化 。

//RequestResponseBodyMethodProcessor继承这类
public abstract class AbstractMessageConverterMethodProcessor extends AbstractMessageConverterMethodArgumentResolver
        implements HandlerMethodReturnValueHandler &#123;
    ...
    
    //跟上一节的代码一致
    protected &lt;T&gt; void writeWithMessageConverters(@Nullable T value, MethodParameter returnType,
                ServletServerHttpRequest inputMessage, ServletServerHttpResponse outputMessage)
                throws IOException, HttpMediaTypeNotAcceptableException, HttpMessageNotWritableException &#123;
            Object body;
            Class&lt;?&gt; valueType;
            Type targetType;
            if (value instanceof CharSequence) &#123;
                body = value.toString();
                valueType = String.class;
                targetType = String.class;
            &#125;
            else &#123;
                body = value;
                valueType = getReturnValueType(body, returnType);
                targetType = GenericTypeResolver.resolveType(getGenericType(returnType), returnType.getContainingClass());
            &#125;
            ...
            //本节重点
            //内容协商（浏览器默认会以请求头(参数Accept)的方式告诉服务器他能接受什么样的内容类型）
            MediaType selectedMediaType = null;
            MediaType contentType = outputMessage.getHeaders().getContentType();
            boolean isContentTypePreset = contentType != null &amp;&amp; contentType.isConcrete();
            if (isContentTypePreset) &#123;
                if (logger.isDebugEnabled()) &#123;
                    logger.debug(&quot;Found &#39;Content-Type:&quot; + contentType + &quot;&#39; in response&quot;);
                &#125;
                selectedMediaType = contentType;
            &#125;
            else &#123;
                HttpServletRequest request = inputMessage.getServletRequest();
                List&lt;MediaType&gt; acceptableTypes = getAcceptableMediaTypes(request);
                //服务器最终根据自己自身的能力，决定服务器能生产出什么样内容类型的数据
                List&lt;MediaType&gt; producibleTypes = getProducibleMediaTypes(request, valueType, targetType);
                if (body != null &amp;&amp; producibleTypes.isEmpty()) &#123;
                    throw new HttpMessageNotWritableException(
                            &quot;No converter found for return value of type: &quot; + valueType);
                &#125;
                List&lt;MediaType&gt; mediaTypesToUse = new ArrayList&lt;&gt;();
                for (MediaType requestedType : acceptableTypes) &#123;
                    for (MediaType producibleType : producibleTypes) &#123;
                        if (requestedType.isCompatibleWith(producibleType)) &#123;
                            mediaTypesToUse.add(getMostSpecificMediaType(requestedType, producibleType));
                        &#125;
                    &#125;
                &#125;
                if (mediaTypesToUse.isEmpty()) &#123;
                    if (body != null) &#123;
                        throw new HttpMediaTypeNotAcceptableException(producibleTypes);
                    &#125;
                    if (logger.isDebugEnabled()) &#123;
                        logger.debug(&quot;No match for &quot; + acceptableTypes + &quot;, supported: &quot; + producibleTypes);
                    &#125;
                    return;
                &#125;
                MediaType.sortBySpecificityAndQuality(mediaTypesToUse);
                //选择一个MediaType
                for (MediaType mediaType : mediaTypesToUse) &#123;
                    if (mediaType.isConcrete()) &#123;
                        selectedMediaType = mediaType;
                        break;
                    &#125;
                    else if (mediaType.isPresentIn(ALL_APPLICATION_MEDIA_TYPES)) &#123;
                        selectedMediaType = MediaType.APPLICATION_OCTET_STREAM;
                        break;
                    &#125;
                &#125;
                if (logger.isDebugEnabled()) &#123;
                    logger.debug(&quot;Using &#39;&quot; + selectedMediaType + &quot;&#39;, given &quot; +
                            acceptableTypes + &quot; and supported &quot; + producibleTypes);
                &#125;
            &#125;
        	
            if (selectedMediaType != null) &#123;
                selectedMediaType = selectedMediaType.removeQualityValue();
                //本节主角：HttpMessageConverter
                for (HttpMessageConverter&lt;?&gt; converter : this.messageConverters) &#123;
                    GenericHttpMessageConverter genericConverter = (converter instanceof GenericHttpMessageConverter ?
                            (GenericHttpMessageConverter&lt;?&gt;) converter : null);
                    
                    //判断是否可写
                    if (genericConverter != null ?
                            ((GenericHttpMessageConverter) converter).canWrite(targetType, valueType, selectedMediaType) :
                            converter.canWrite(valueType, selectedMediaType)) &#123;
                        body = getAdvice().beforeBodyWrite(body, returnType, selectedMediaType,
                                (Class&lt;? extends HttpMessageConverter&lt;?&gt;&gt;) converter.getClass(),
                                inputMessage, outputMessage);
                        if (body != null) &#123;
                            Object theBody = body;
                            LogFormatUtils.traceDebug(logger, traceOn -&gt;
                                    &quot;Writing [&quot; + LogFormatUtils.formatValue(theBody, !traceOn) + &quot;]&quot;);
                            addContentDispositionHeader(inputMessage, outputMessage);
                            //开始写入
                            if (genericConverter != null) &#123;
                                genericConverter.write(body, targetType, selectedMediaType, outputMessage);
                            &#125;
                            else &#123;
                                ((HttpMessageConverter) converter).write(body, selectedMediaType, outputMessage);
                            &#125;
                        &#125;
                        else &#123;
                            if (logger.isDebugEnabled()) &#123;
                                logger.debug(&quot;Nothing to write: null body&quot;);
                            &#125;
                        &#125;
                        return;
                    &#125;
                &#125;
            &#125;
            ...
        &#125;
</code></pre>
<h2 id="21、响应处理-【源码分析】-基于请求参数的内容协商原理"><a href="#21、响应处理-【源码分析】-基于请求参数的内容协商原理" class="headerlink" title="21、响应处理-【源码分析】-基于请求参数的内容协商原理"></a>21、响应处理-【源码分析】-基于请求参数的内容协商原理</h2><p>上一节内容协商原理的第二步：</p>
<p>获取客户端（PostMan、浏览器）支持接收的内容类型。（获取客户端Accept请求头字段application&#x2F;xml）</p>
<pre><code>contentNegotiationManager 内容协商管理器 默认使用基于请求头的策略
HeaderContentNegotiationStrategy 确定客户端可以接收的内容类型

//RequestResponseBodyMethodProcessor继承这类
public abstract class AbstractMessageConverterMethodProcessor extends AbstractMessageConverterMethodArgumentResolver
        implements HandlerMethodReturnValueHandler &#123;
    ...
    
    //跟上一节的代码一致
    protected &lt;T&gt; void writeWithMessageConverters(@Nullable T value, MethodParameter returnType,
                ServletServerHttpRequest inputMessage, ServletServerHttpResponse outputMessage)
                throws IOException, HttpMediaTypeNotAcceptableException, HttpMessageNotWritableException &#123;
            Object body;
            Class&lt;?&gt; valueType;
            Type targetType;
        
        	...
        
                    //本节重点
            //内容协商（浏览器默认会以请求头(参数Accept)的方式告诉服务器他能接受什么样的内容类型）
            MediaType selectedMediaType = null;
            MediaType contentType = outputMessage.getHeaders().getContentType();
            boolean isContentTypePreset = contentType != null &amp;&amp; contentType.isConcrete();
            if (isContentTypePreset) &#123;
                if (logger.isDebugEnabled()) &#123;
                    logger.debug(&quot;Found &#39;Content-Type:&quot; + contentType + &quot;&#39; in response&quot;);
                &#125;
                selectedMediaType = contentType;
            &#125;
            else &#123;
                HttpServletRequest request = inputMessage.getServletRequest();
                List&lt;MediaType&gt; acceptableTypes = getAcceptableMediaTypes(request);
                //服务器最终根据自己自身的能力，决定服务器能生产出什么样内容类型的数据
                List&lt;MediaType&gt; producibleTypes = getProducibleMediaTypes(request, valueType, targetType);
            ...
            
    &#125;
    
    //在AbstractMessageConverterMethodArgumentResolver类内
   	private List&lt;MediaType&gt; getAcceptableMediaTypes(HttpServletRequest request)
            throws HttpMediaTypeNotAcceptableException &#123;
        //内容协商管理器 默认使用基于请求头的策略
        return this.contentNegotiationManager.resolveMediaTypes(new ServletWebRequest(request));
    &#125;
        
&#125;

public class ContentNegotiationManager implements ContentNegotiationStrategy, MediaTypeFileExtensionResolver &#123;
    ...
    
    public ContentNegotiationManager() &#123;
        this(new HeaderContentNegotiationStrategy());//内容协商管理器 默认使用基于请求头的策略
    &#125;
    
    @Override
    public List&lt;MediaType&gt; resolveMediaTypes(NativeWebRequest request) throws HttpMediaTypeNotAcceptableException &#123;
        for (ContentNegotiationStrategy strategy : this.strategies) &#123;
            List&lt;MediaType&gt; mediaTypes = strategy.resolveMediaTypes(request);
            if (mediaTypes.equals(MEDIA_TYPE_ALL_LIST)) &#123;
                continue;
            &#125;
            return mediaTypes;
        &#125;
        return MEDIA_TYPE_ALL_LIST;
    &#125;
    ...  
&#125;


//基于请求头的策略
public class HeaderContentNegotiationStrategy implements ContentNegotiationStrategy &#123;
    /**
     * &#123;@inheritDoc&#125;
     * @throws HttpMediaTypeNotAcceptableException if the &#39;Accept&#39; header cannot be parsed
     */
    @Override
    public List&lt;MediaType&gt; resolveMediaTypes(NativeWebRequest request)
            throws HttpMediaTypeNotAcceptableException &#123;
        String[] headerValueArray = request.getHeaderValues(HttpHeaders.ACCEPT);
        if (headerValueArray == null) &#123;
            return MEDIA_TYPE_ALL_LIST;
        &#125;
        List&lt;String&gt; headerValues = Arrays.asList(headerValueArray);
        try &#123;
            List&lt;MediaType&gt; mediaTypes = MediaType.parseMediaTypes(headerValues);
            MediaType.sortBySpecificityAndQuality(mediaTypes);
            return !CollectionUtils.isEmpty(mediaTypes) ? mediaTypes : MEDIA_TYPE_ALL_LIST;
        &#125;
        catch (InvalidMediaTypeException ex) &#123;
            throw new HttpMediaTypeNotAcceptableException(
                    &quot;Could not parse &#39;Accept&#39; header &quot; + headerValues + &quot;: &quot; + ex.getMessage());
        &#125;
    &#125;
&#125;
</code></pre>
<h3 id="开启浏览器参数方式内容协商功能"><a href="#开启浏览器参数方式内容协商功能" class="headerlink" title="开启浏览器参数方式内容协商功能"></a>开启浏览器参数方式内容协商功能</h3><p>为了方便内容协商，开启基于请求参数的内容协商功能。</p>
<pre><code>spring:
  mvc:
    contentnegotiation:
      favor-parameter: true  #开启请求参数内容协商模式
</code></pre>
<p>内容协商管理器，就会多了一个ParameterContentNegotiationStrategy（由Spring容器注入）</p>
<pre><code>public class ParameterContentNegotiationStrategy extends AbstractMappingContentNegotiationStrategy &#123;
    private String parameterName = &quot;format&quot;;//
    /**
     * Create an instance with the given map of file extensions and media types.
     */
    public ParameterContentNegotiationStrategy(Map&lt;String, MediaType&gt; mediaTypes) &#123;
        super(mediaTypes);
    &#125;
    /**
     * Set the name of the parameter to use to determine requested media types.
     * &lt;p&gt;By default this is set to &#123;@code &quot;format&quot;&#125;.
     */
    public void setParameterName(String parameterName) &#123;
        Assert.notNull(parameterName, &quot;&#39;parameterName&#39; is required&quot;);
        this.parameterName = parameterName;
    &#125;
    public String getParameterName() &#123;
        return this.parameterName;
    &#125;
    @Override
    @Nullable
    protected String getMediaTypeKey(NativeWebRequest request) &#123;
        return request.getParameter(getParameterName());
    &#125;
    
    //---以下方法在AbstractMappingContentNegotiationStrategy类
    
    @Override
    public List&lt;MediaType&gt; resolveMediaTypes(NativeWebRequest webRequest)
            throws HttpMediaTypeNotAcceptableException &#123;
        return resolveMediaTypeKey(webRequest, getMediaTypeKey(webRequest));
    &#125;
    /**
     * An alternative to &#123;@link #resolveMediaTypes(NativeWebRequest)&#125; that accepts
     * an already extracted key.
     * @since 3.2.16
     */
    public List&lt;MediaType&gt; resolveMediaTypeKey(NativeWebRequest webRequest, @Nullable String key)
            throws HttpMediaTypeNotAcceptableException &#123;
        if (StringUtils.hasText(key)) &#123;
            MediaType mediaType = lookupMediaType(key);
            if (mediaType != null) &#123;
                handleMatch(key, mediaType);
                return Collections.singletonList(mediaType);
            &#125;
            mediaType = handleNoMatch(webRequest, key);
            if (mediaType != null) &#123;
                addMapping(key, mediaType);
                return Collections.singletonList(mediaType);
            &#125;
        &#125;
        return MEDIA_TYPE_ALL_LIST;
    &#125;
&#125;
</code></pre>
<p>然后，浏览器地址输入带format参数的URL：</p>
<pre><code>http://localhost:8080/test/person?format=json
或
http://localhost:8080/test/person?format=xml
</code></pre>
<p>这样，后端会根据参数format的值，返回对应json或xml格式的数据。</p>
<h2 id="22-响应处理-【源码分析】-自定义MessageConverter"><a href="#22-响应处理-【源码分析】-自定义MessageConverter" class="headerlink" title="22. 响应处理-【源码分析】-自定义MessageConverter"></a>22. 响应处理-【源码分析】-自定义MessageConverter</h2><p><strong>实现多协议数据兼容。json、xml、x-sevattal（这个是自创的）</strong></p>
<pre><code>1. @ResponseBody 响应数据出去 调用 RequestResponseBodyMethodProcessor 处理
2. Processor 处理方法返回值。通过 MessageConverter处理
3. 所有 MessageConverter 合起来可以支持各种媒体类型数据的操作（读、写）
4. 内容协商找到最终的 messageConverter
</code></pre>
<p>SpringMVC的什么功能，一个入口给容器中添加一个 WebMvcConfigurer</p>
<pre><code>@Configuration(proxyBeanMethods = false)
public class WebConfig &#123;
    @Bean
    public WebMvcConfigurer webMvcConfigurer()&#123;
        return new WebMvcConfigurer() &#123;
            @Override
            public void extendMessageConverters(List&lt;HttpMessageConverter&lt;?&gt;&gt; converters) &#123;
                converters.add(new SevattalMessageConverter());
            &#125;
        &#125;
    &#125;
&#125;


/**
 * 自定义的Converter
 */
public class SevattalMessageConverter implements HttpMessageConverter&lt;Person&gt; &#123;
    @Override
    public boolean canRead(Class&lt;?&gt; clazz, MediaType mediaType) &#123;
        return false;
    &#125;
    @Override
    public boolean canWrite(Class&lt;?&gt; clazz, MediaType mediaType) &#123;
        return clazz.isAssignableFrom(Person.class);
    &#125;
    /**
     * 服务器要统计所有MessageConverter都能写出哪些内容类型
     *
     * application/x-sevattal
     * @return
     */
    @Override
    public List&lt;MediaType&gt; getSupportedMediaTypes() &#123;
        return MediaType.parseMediaTypes(&quot;application/x-sevattal&quot;);
    &#125;
    @Override
    public Person read(Class&lt;? extends Person&gt; clazz, HttpInputMessage inputMessage) throws IOException, HttpMessageNotReadableException &#123;
        return null;
    &#125;
    @Override
    public void write(Person person, MediaType contentType, HttpOutputMessage outputMessage) throws IOException, HttpMessageNotWritableException &#123;
        //自定义协议数据的写出
        String data = person.getUserName()+&quot;;&quot;+person.getAge()+&quot;;&quot;+person.getBirth();
        //写出去
        OutputStream body = outputMessage.getBody();
        body.write(data.getBytes());
    &#125;
&#125;

import java.util.Date;
@Controller
public class ResponseTestController &#123;
    /**
     * 1、浏览器发请求直接返回 xml    [application/xml]        jacksonXmlConverter
     * 2、如果是ajax请求 返回 json   [application/json]      jacksonJsonConverter
     * 3、如果硅谷app发请求，返回自定义协议数据  [appliaction/x-sevattal]   xxxxConverter
     *          属性值1;属性值2;
     *
     * 步骤：
     * 1、添加自定义的MessageConverter进系统底层
     * 2、系统底层就会统计出所有MessageConverter能操作哪些类型
     * 3、客户端内容协商 [sevattal---&gt;sevattal]
     *
     * 作业：如何以参数的方式进行内容协商
     * @return
     */
    @ResponseBody  //利用返回值处理器里面的消息转换器进行处理
    @GetMapping(value = &quot;/test/person&quot;)
    public Person getPerson()&#123;
        Person person = new Person();
        person.setAge(28);
        person.setBirth(new Date());
        person.setUserName(&quot;zhangsan&quot;);
        return person;
    &#125;
&#125;
</code></pre>
<p>用Postman发送&#x2F;test&#x2F;person（请求头Accept:application&#x2F;x-sevattal)，将返回自定义协议数据的写出。</p>
<h2 id="23-响应处理-【源码分析】-浏览器与PostMan内容协商完全适配"><a href="#23-响应处理-【源码分析】-浏览器与PostMan内容协商完全适配" class="headerlink" title="23. 响应处理-【源码分析】-浏览器与PostMan内容协商完全适配"></a>23. 响应处理-【源码分析】-浏览器与PostMan内容协商完全适配</h2><p>假设你想基于自定义请求参数的自定义内容协商功能。</p>
<p>换句话，在地址栏输入<a target="_blank" rel="noopener" href="http://localhost:8080/test/person?format=gg%E8%BF%94%E5%9B%9E%E6%95%B0%E6%8D%AE%EF%BC%8C%E8%B7%9Fhttp://localhost:8080/test/person%E4%B8%94%E8%AF%B7%E6%B1%82%E5%A4%B4%E5%8F%82%E6%95%B0Accept:application/x-sevattal%E7%9A%84%E8%BF%94%E5%9B%9E%E8%87%AA%E5%AE%9A%E4%B9%89%E5%8D%8F%E8%AE%AE%E6%95%B0%E6%8D%AE%E7%9A%84%E4%B8%80%E8%87%B4%E3%80%82">http://localhost:8080/test/person?format=gg返回数据，跟http://localhost:8080/test/person且请求头参数Accept:application/x-sevattal的返回自定义协议数据的一致。</a></p>
<pre><code>@Configuration(proxyBeanMethods = false)
public class WebConfig /*implements WebMvcConfigurer*/ &#123;
    //1、WebMvcConfigurer定制化SpringMVC的功能
    @Bean
    public WebMvcConfigurer webMvcConfigurer()&#123;
        return new WebMvcConfigurer() &#123;
            /**
             * 自定义内容协商策略
             * @param configurer
             */
            @Override
            public void configureContentNegotiation(ContentNegotiationConfigurer configurer) &#123;
                //Map&lt;String, MediaType&gt; mediaTypes
                Map&lt;String, MediaType&gt; mediaTypes = new HashMap&lt;&gt;();
                mediaTypes.put(&quot;json&quot;,MediaType.APPLICATION_JSON);
                mediaTypes.put(&quot;xml&quot;,MediaType.APPLICATION_XML);
                //自定义媒体类型
                mediaTypes.put(&quot;gg&quot;,MediaType.parseMediaType(&quot;application/x-sevattal&quot;));
                //指定支持解析哪些参数对应的哪些媒体类型
                ParameterContentNegotiationStrategy parameterStrategy = new ParameterContentNegotiationStrategy(mediaTypes);
                // parameterStrategy.setParameterName(&quot;ff&quot;);
                //还需添加请求头处理策略，否则accept:application/json、application/xml则会失效
                HeaderContentNegotiationStrategy headeStrategy = new HeaderContentNegotiationStrategy();
                configurer.strategies(Arrays.asList(parameterStrategy, headeStrategy));
            &#125;
        &#125;
    &#125; 
    ...    
&#125;
</code></pre>
<p>日后开发要注意，有可能我们添加的自定义的功能会覆盖默认很多功能，导致一些默认的功能失效。</p>

      
    </div>
    
  </div>
  
    
    <div class="copyright">
        <p><span>Title:</span><a href="/2021/05/19/SpringBoot2-BASE-2/">SpringBoot2-BASE-2</a></p>
        <p><span>Author:</span><a href="/" title="Back to Homepage"></a></p>
        <p><span>Created:</span>2021-05-19, 14:17:31</p>
        <p><span>Updated:</span>2022-11-18, 09:11:44</p>
        <p>
            <span>Full URL:</span><a class="post-url" href="/2021/05/19/SpringBoot2-BASE-2/" title="SpringBoot2-BASE-2">http://yoursite.com/2021/05/19/SpringBoot2-BASE-2/</a>
            <span class="copy-path" data-clipboard-text="From http://yoursite.com/2021/05/19/SpringBoot2-BASE-2/　　By " title="Copy Article&#39;s Link &amp; Author"><i class="fa fa-clipboard"></i></span>
            <script> var clipboard = new Clipboard('.copy-path'); </script>
        </p>
        <p>
            <span>License:</span><i class="fa fa-creative-commons"></i> <a rel="license noopener" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" title="CC BY-NC-SA 4.0 International" target = "_blank">"CC BY-NC-SA 4.0"</a> Keep Link &amp; Author if Distribute.
        </p>
    </div>



    <nav id="article-nav">
        
            <div id="article-nav-newer" class="article-nav-title">
                <a href="/2021/05/20/SpringBoot2-BASE-3/">
                    SpringBoot2-BASE-3
                </a>
            </div>
        
        
            <div id="article-nav-older" class="article-nav-title">
                <a href="/2021/05/19/SpringBoot2-BASE-1/">
                    SpringBoot2-BASE-1
                </a>
            </div>
        
    </nav>

  
</article>

    <div id="toc" class="toc-article">
        <strong class="toc-title">Contents</strong>
        
            <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#SpringBoot2-%E5%9F%BA%E7%A1%80%E7%AF%87-2"><span class="toc-number">1.</span> <span class="toc-text">SpringBoot2 基础篇 2</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6-yaml%E7%9A%84%E7%94%A8%E6%B3%95"><span class="toc-number">1.1.</span> <span class="toc-text">1. 配置文件-yaml的用法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95"><span class="toc-number">1.1.1.</span> <span class="toc-text">基本语法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.1.2.</span> <span class="toc-text">数据类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B"><span class="toc-number">1.1.3.</span> <span class="toc-text">实例</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6-%E8%87%AA%E5%AE%9A%E4%B9%89%E7%B1%BB%E7%BB%91%E5%AE%9A%E7%9A%84%E9%85%8D%E7%BD%AE%E6%8F%90%E7%A4%BA"><span class="toc-number">1.2.</span> <span class="toc-text">2. 配置文件-自定义类绑定的配置提示</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-web%E5%9C%BA%E6%99%AF-web%E5%BC%80%E5%8F%91%E7%AE%80%E4%BB%8B"><span class="toc-number">1.3.</span> <span class="toc-text">3. web场景-web开发简介</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-web%E5%9C%BA%E6%99%AF-%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90%E8%A7%84%E5%88%99%E4%B8%8E%E5%AE%9A%E5%88%B6%E5%8C%96"><span class="toc-number">1.4.</span> <span class="toc-text">4. web场景-静态资源规则与定制化</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90%E7%9B%AE%E5%BD%95"><span class="toc-number">1.4.1.</span> <span class="toc-text">静态资源目录</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90%E8%AE%BF%E9%97%AE%E5%89%8D%E7%BC%80"><span class="toc-number">1.4.2.</span> <span class="toc-text">静态资源访问前缀</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#webjar"><span class="toc-number">1.4.3.</span> <span class="toc-text">webjar</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-web%E5%9C%BA%E6%99%AF-welcome%E4%B8%8Efavicon%E5%8A%9F%E8%83%BD"><span class="toc-number">1.5.</span> <span class="toc-text">5. web场景-welcome与favicon功能</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AC%A2%E8%BF%8E%E9%A1%B5%E6%94%AF%E6%8C%81"><span class="toc-number">1.5.1.</span> <span class="toc-text">欢迎页支持</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89Favicon"><span class="toc-number">1.5.2.</span> <span class="toc-text">自定义Favicon</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-web%E5%9C%BA%E6%99%AF-%E3%80%90%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%E3%80%91-%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90%E5%8E%9F%E7%90%86"><span class="toc-number">1.6.</span> <span class="toc-text">6. web场景-【源码分析】-静态资源原理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E7%B1%BB%E5%8F%AA%E6%9C%89%E4%B8%80%E4%B8%AA%E6%9C%89%E5%8F%82%E6%9E%84%E9%80%A0%E5%99%A8"><span class="toc-number">1.6.1.</span> <span class="toc-text">配置类只有一个有参构造器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B5%84%E6%BA%90%E5%A4%84%E7%90%86%E7%9A%84%E9%BB%98%E8%AE%A4%E8%A7%84%E5%88%99"><span class="toc-number">1.6.2.</span> <span class="toc-text">资源处理的默认规则</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-%E8%AF%B7%E6%B1%82%E5%A4%84%E7%90%86-%E3%80%90%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%E3%80%91-Rest%E6%98%A0%E5%B0%84%E5%8F%8A%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90"><span class="toc-number">1.7.</span> <span class="toc-text">7. 请求处理-【源码分析】-Rest映射及源码解析</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%B7%E6%B1%82%E6%98%A0%E5%B0%84"><span class="toc-number">1.7.1.</span> <span class="toc-text">请求映射</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-%E8%AF%B7%E6%B1%82%E5%A4%84%E7%90%86-%E3%80%90%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%E3%80%91-%E6%80%8E%E4%B9%88%E6%94%B9%E5%8F%98%E9%BB%98%E8%AE%A4%E7%9A%84-method"><span class="toc-number">1.7.2.</span> <span class="toc-text">8. 请求处理-【源码分析】-怎么改变默认的_method</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-%E8%AF%B7%E6%B1%82%E5%A4%84%E7%90%86-%E3%80%90%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%E3%80%91-%E8%AF%B7%E6%B1%82%E6%98%A0%E5%B0%84%E5%8E%9F%E7%90%86"><span class="toc-number">1.8.</span> <span class="toc-text">9. 请求处理-【源码分析】-请求映射原理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-%E8%AF%B7%E6%B1%82%E5%A4%84%E7%90%86-%E5%B8%B8%E7%94%A8%E5%8F%82%E6%95%B0%E6%B3%A8%E8%A7%A3%E4%BD%BF%E7%94%A8"><span class="toc-number">1.9.</span> <span class="toc-text">10. 请求处理-常用参数注解使用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11-%E8%AF%B7%E6%B1%82%E5%A4%84%E7%90%86-RequestAttribute"><span class="toc-number">1.10.</span> <span class="toc-text">11. 请求处理-@RequestAttribute</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#12-%E8%AF%B7%E6%B1%82%E5%A4%84%E7%90%86-MatrixVariable%E4%B8%8EUrlPathHelper"><span class="toc-number">1.11.</span> <span class="toc-text">12. 请求处理-@MatrixVariable与UrlPathHelper</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#13-%E8%AF%B7%E6%B1%82%E5%A4%84%E7%90%86-%E3%80%90%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%E3%80%91-%E5%90%84%E7%A7%8D%E7%B1%BB%E5%9E%8B%E5%8F%82%E6%95%B0%E8%A7%A3%E6%9E%90%E5%8E%9F%E7%90%86"><span class="toc-number">1.12.</span> <span class="toc-text">13. 请求处理-【源码分析】-各种类型参数解析原理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#HandlerAdapter"><span class="toc-number">1.12.1.</span> <span class="toc-text">HandlerAdapter</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%89%A7%E8%A1%8C%E7%9B%AE%E6%A0%87%E6%96%B9%E6%B3%95"><span class="toc-number">1.12.2.</span> <span class="toc-text">执行目标方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%82%E6%95%B0%E8%A7%A3%E6%9E%90%E5%99%A8"><span class="toc-number">1.12.3.</span> <span class="toc-text">参数解析器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%94%E5%9B%9E%E5%80%BC%E5%A4%84%E7%90%86%E5%99%A8"><span class="toc-number">1.12.4.</span> <span class="toc-text">返回值处理器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%9E%E9%A1%BE%E6%89%A7%E8%A1%8C%E7%9B%AE%E6%A0%87%E6%96%B9%E6%B3%95"><span class="toc-number">1.12.5.</span> <span class="toc-text">回顾执行目标方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E7%A1%AE%E5%AE%9A%E7%9B%AE%E6%A0%87%E6%96%B9%E6%B3%95%E6%AF%8F%E4%B8%80%E4%B8%AA%E5%8F%82%E6%95%B0%E7%9A%84%E5%80%BC"><span class="toc-number">1.12.6.</span> <span class="toc-text">如何确定目标方法每一个参数的值</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%8F%E7%BB%93"><span class="toc-number">1.12.7.</span> <span class="toc-text">小结</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#14-%E8%AF%B7%E6%B1%82%E5%A4%84%E7%90%86-%E3%80%90%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%E3%80%91-Servlet-API%E5%8F%82%E6%95%B0%E8%A7%A3%E6%9E%90%E5%8E%9F%E7%90%86"><span class="toc-number">1.13.</span> <span class="toc-text">14. 请求处理-【源码分析】-Servlet API参数解析原理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#15-%E8%AF%B7%E6%B1%82%E5%A4%84%E7%90%86-%E3%80%90%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%E3%80%91-Model%E3%80%81Map%E5%8E%9F%E7%90%86"><span class="toc-number">1.14.</span> <span class="toc-text">15. 请求处理-【源码分析】-Model、Map原理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#16-%E8%AF%B7%E6%B1%82%E5%A4%84%E7%90%86-%E3%80%90%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%E3%80%91-%E8%87%AA%E5%AE%9A%E4%B9%89%E5%8F%82%E6%95%B0%E7%BB%91%E5%AE%9A%E5%8E%9F%E7%90%86"><span class="toc-number">1.15.</span> <span class="toc-text">16. 请求处理-【源码分析】-自定义参数绑定原理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#17-%E8%AF%B7%E6%B1%82%E5%A4%84%E7%90%86-%E3%80%90%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%E3%80%91-%E8%87%AA%E5%AE%9A%E4%B9%89Converter%E5%8E%9F%E7%90%86"><span class="toc-number">1.16.</span> <span class="toc-text">17. 请求处理-【源码分析】-自定义Converter原理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#18-%E5%93%8D%E5%BA%94%E5%A4%84%E7%90%86-%E3%80%90%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%E3%80%91-ReturnValueHandler%E5%8E%9F%E7%90%86"><span class="toc-number">1.17.</span> <span class="toc-text">18. 响应处理-【源码分析】-ReturnValueHandler原理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#19-%E5%93%8D%E5%BA%94%E5%A4%84%E7%90%86-%E3%80%90%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%E3%80%91-HTTPMessageConverter%E5%8E%9F%E7%90%86"><span class="toc-number">1.18.</span> <span class="toc-text">19. 响应处理-【源码分析】-HTTPMessageConverter原理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B3%E4%BA%8EHttpMessageConverters%E7%9A%84%E5%88%9D%E5%A7%8B%E5%8C%96"><span class="toc-number">1.18.1.</span> <span class="toc-text">关于HttpMessageConverters的初始化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ReturnValueHandler%E4%B8%8EMappingJackson2HttpMessageConverter%E5%85%B3%E8%81%94"><span class="toc-number">1.18.2.</span> <span class="toc-text">ReturnValueHandler与MappingJackson2HttpMessageConverter关联</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#20-%E5%93%8D%E5%BA%94%E5%A4%84%E7%90%86-%E3%80%90%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%E3%80%91-%E5%86%85%E5%AE%B9%E5%8D%8F%E5%95%86%E5%8E%9F%E7%90%86"><span class="toc-number">1.19.</span> <span class="toc-text">20. 响应处理-【源码分析】-内容协商原理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#21%E3%80%81%E5%93%8D%E5%BA%94%E5%A4%84%E7%90%86-%E3%80%90%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%E3%80%91-%E5%9F%BA%E4%BA%8E%E8%AF%B7%E6%B1%82%E5%8F%82%E6%95%B0%E7%9A%84%E5%86%85%E5%AE%B9%E5%8D%8F%E5%95%86%E5%8E%9F%E7%90%86"><span class="toc-number">1.20.</span> <span class="toc-text">21、响应处理-【源码分析】-基于请求参数的内容协商原理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%80%E5%90%AF%E6%B5%8F%E8%A7%88%E5%99%A8%E5%8F%82%E6%95%B0%E6%96%B9%E5%BC%8F%E5%86%85%E5%AE%B9%E5%8D%8F%E5%95%86%E5%8A%9F%E8%83%BD"><span class="toc-number">1.20.1.</span> <span class="toc-text">开启浏览器参数方式内容协商功能</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#22-%E5%93%8D%E5%BA%94%E5%A4%84%E7%90%86-%E3%80%90%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%E3%80%91-%E8%87%AA%E5%AE%9A%E4%B9%89MessageConverter"><span class="toc-number">1.21.</span> <span class="toc-text">22. 响应处理-【源码分析】-自定义MessageConverter</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#23-%E5%93%8D%E5%BA%94%E5%A4%84%E7%90%86-%E3%80%90%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%E3%80%91-%E6%B5%8F%E8%A7%88%E5%99%A8%E4%B8%8EPostMan%E5%86%85%E5%AE%B9%E5%8D%8F%E5%95%86%E5%AE%8C%E5%85%A8%E9%80%82%E9%85%8D"><span class="toc-number">1.22.</span> <span class="toc-text">23. 响应处理-【源码分析】-浏览器与PostMan内容协商完全适配</span></a></li></ol></li></ol>
        
    </div>
    <style>
        .left-col .switch-btn,
        .left-col .switch-area {
            display: none;
        }
        .toc-level-3 i,
        .toc-level-3 ol {
            display: none !important;
        }
    </style>

    <input type="button" id="tocButton" value="Hide"  title="Show or Hide Table of Contents">

    <script>
        yiliaConfig.toc = ["Hide", "Show", !!"false"];
    </script>



    
<div class="share">
    
        <div class="bdsharebuttonbox">
            <a href="#" class="fa fa-twitter bds_twi" data-cmd="twi" title="分享到推特"></a>
            <a href="#" class="fa fa-weibo bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a>
            <a href="#" class="fa fa-qq bds_sqq" data-cmd="sqq" title="分享给 QQ 好友"></a>
            <a href="#" class="fa fa-files-o bds_copy" data-cmd="copy" title="复制网址"></a>
            <a href="#" class="fa fa fa-envelope-o bds_mail" data-cmd="mail" title="通过邮件分享"></a>
            <a href="#" class="fa fa-weixin bds_weixin" data-cmd="weixin" title="生成文章二维码"></a>
            <a href="#" class="fa fa-share-alt bds_more" data-cmd="more"></i></a>
        </div>
        <script>
            window._bd_share_config={
                "common":{"bdSnsKey":{},"bdText":"SpringBoot2-BASE-2　| Sevattal　","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"0","bdSize":"24"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];
        </script>
    

    
</div>







    




    <div class="scroll" id="post-nav-button">
        
            <a href="/2021/05/20/SpringBoot2-BASE-3/" title="Pre: SpringBoot2-BASE-3">
                <i class="fa fa-angle-left"></i>
            </a>
        

        <a title="Mini Archives"><i class="fa fa-bars"></i><i class="fa fa-times"></i></a>

        
            <a href="/2021/05/19/SpringBoot2-BASE-1/" title="Next: SpringBoot2-BASE-1">
                <i class="fa fa-angle-right"></i>
            </a>
        
    </div>

    <ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2023/03/13/Ansible-Base-Copy-Module-1/">Ansible-Base-Copy-Module-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2023/03/13/Ansible-Base-Module-1/">Ansible-Base-Module-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2023/03/13/Ansible-Base-Variable-1/">Ansible-Base-Variable-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2023/03/13/Ansible-Base-1/">Ansible-Base-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2023/03/10/Materialized-View-1/">Materialized-View-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2023/03/10/BigLogFile-Cut-1/">BigLogFile-Cut-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2023/01/05/Snmp-Base-1/">Snmp-Base-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/12/14/Linux-Disable-IPV6/">Linux-Disable-IPV6</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/12/14/DmDB-Docker-Install/">DmDB-Docker-Install</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/12/14/Neo4j-12-Python-Driver/">Neo4j-12-Python-Driver</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/12/14/Neo4j-11-Cypher-Function/">Neo4j-11-Cypher-Function</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/12/14/Neo4j-10-Update-Data/">Neo4j-10-Update-Data</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/12/14/Neo4j-9-Match-Data/">Neo4j-9-Match-Data</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/12/14/Neo4j-8-Projection-Filtering/">Neo4j-8-Projection-Filtering</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/12/14/Neo4j-7-Pattern/">Neo4j-7-Pattern</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/12/14/Neo4j-6-Cypher-Base/">Neo4j-6-Cypher-Base</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/12/14/Neo4j-5-BatchUpdate/">Neo4j-5-BatchUpdate</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/12/14/Neo4j-4-Net-Driver/">Neo4j-4-Net-Driver</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/12/14/Neo4j-3-Cypher-Query/">Neo4j-3-Cypher-Query</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/12/14/Neo4j-2-Graph-Theory/">Neo4j-2-Graph-Theory</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/12/14/Neo4j-1-Window-Install/">Neo4j-1-Window-Install</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/12/14/Window-Regedit/">Window-Regedit</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/12/14/CentOS-9-NetworkManger-1/">CentOS-9-NetworkManger-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/11/23/Hacking-Tool-Base-1/">Hacking-Tool-Base-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/11/18/Metasploit-Base-1/">Metasploit-Base-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/11/17/Script-Kiddies-Base-1/">Script-Kiddies-Base-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/11/17/Wireshark-Base-3/">Wireshark-Base-3</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/11/17/Wireshark-Base-2/">Wireshark-Base-2</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/11/17/Wireshark-Base-1/">Wireshark-Base-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/11/17/PE-Base-1/">PE-Base-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/11/17/Dos-Debug-Base-1/">Dos-Debug-Base-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/11/17/Linux-Clean-Log-1/">Linux-Clean-Log-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/11/17/WebSocket-Front-Code-1/">WebSocket-Front-Code-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/11/16/Nasm-Masm-Differ-1/">Nasm-Masm-Differ-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/11/16/Oracle-Linux-SqlPlus-Garbled-Code-1/">Oracle-Linux-SqlPlus-Garbled-Code-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/11/16/Nasm-Masm-Base-1/">Nasm-Masm-Base-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/07/28/Window-Cmd-Garbled-Code-Resolution-1/">Window-Cmd-Garbled-Code-Resolution-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/07/26/Oracle-Sys-Guid-Func-1/">Oracle-Sys_Guid-Func-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/07/26/Oracle-Achive-ORA-00257/">Oracle-Achive-ORA-00257</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/07/26/Oracle-User-Progress-1/">Oracle-User-Progress-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/07/26/Oracle-Container-Base-1/">Oracle-Container-Base-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/07/26/Oracle-Control-File-1/">Oracle-Control-File-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/07/07/Linux-K8S-Openssl-1/">Linux-K8S-Openssl-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/07/07/Linux-K8S-CFSSL-1/">Linux-K8S-CFSSL-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/07/07/Linux-Flannel-1/">Linux-Flannel-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/07/07/Linux-Calico-1/">Linux-Calico-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/07/07/Linux-Nginx-Ingress-1/">Linux-Nginx-Ingress-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/07/07/Linux-ipatables-DNAT-SNAT-1/">Linux-ipatables-DNAT-SNAT-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/07/07/Linux-ipatables-1/">Linux-ipatables-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/07/07/Oracle-Rman-Parameter-1/">Oracle-Rman-Parameter-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/07/07/Sublime-Markdown-1/">Sublime-Markdown-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/07/06/Jaspersoft-Parameter-1/">Jaspersoft-Parameter-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/07/06/Jaspersoft-Element-Details-1/">Jaspersoft-Element-Details-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/06/29/WeiBo-Batch-Delete-1/">WeiBo-Batch-Delete-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/06/29/Jaspersoft-Char-Trunc-1/">Jaspersoft-Char-Trunc-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/06/29/Oracle-RedoLog-Restore-1/">Oracle-RedoLog-Restore-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/06/23/Vue-Bind-Delay-Resolution-1/">Vue-Bind-Delay-Resolution-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/06/23/Java-Generate-Password-Dict-1/">Java-Generate-Password-Dict-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/06/23/Vue-Convert-10-To-34-Example-1/">Vue-Convert-10-To-34-Example-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/06/15/Java-Primordial-Text-File-Handle-1/">Java-Primordial-Text-File-Handle-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/06/15/Winget-Base-1/">Winget-Base-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/05/24/Kali-Brute-Force-Wifi-1/">Kali-Brute-Force-Wifi-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/05/17/Oracle-Func-Table-1/">Oracle-Func-Table-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/05/17/Oracle-ORA-03133-ERROR-1/">Oracle-ORA-03133-ERROR-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/05/14/Jasper-Reports-Server-Install-1/">Jasper-Reports-Server-Install-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/04/30/Video-Clip-Stick-Point-Base-1/">Video-Clip-Stick-Point-Base-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/04/30/Video-Clip-Lens-Length-Base-1/">Video-Clip-Lens-Length-Base-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/04/30/Video-Clip-Structure-Base-1/">Video-Clip-Structure-Base-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/04/26/FFmpeg-Base-1/">FFmpeg-Base-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/04/05/Network-NAT-DHCP-PPP-1/">Network-NAT-DHCP-PPP-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/04/05/Network-Switch-STP-1/">Network-Switch-STP-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/04/04/Network-Switch-VTP-1/">Network-Switch-VTP-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/04/04/Network-Switch-VLAN-1/">Network-Switch-VLAN-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/04/03/Network-Route-ACL-1/">Network-Route-ACL-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/04/03/Network-Route-EIGRP-1/">Network-Route-EIGRP-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/04/03/Network-Route-OSPF-2/">Network-Route-OSPF-2</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/04/03/Network-Route-OSPF-1/">Network-Route-OSPF-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/04/02/Network-Route-Rip-1/">Network-Route-Rip-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/04/02/Network-Route-Base-1/">Network-Route-Base-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/03/30/Oracle-Listener-1/">Oracle-Listener-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/03/22/Google-Hacking-Base-1/">Google-Hacking-Base-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/03/22/Oracle-Job-Base-1/">Oracle-Job-Base-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/03/21/Linux-Crontab-1/">Linux-Crontab-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/03/21/Oracle-Window-SqlPlus-Garbled-Code-1/">Oracle-Window-SqlPlus-Garbled-Code-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/03/21/Docker-Run-Cmd-1/">Docker-Run-Cmd-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/03/19/Linux-Supervisor-Base-1/">Linux-Supervisor-Base-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/03/19/Linux-Swap-Add-1/">Linux-Swap-Add-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/03/19/Oracle-Implementation-Plan-1/">Oracle-Implementation-Plan-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/03/19/Nmap-Tool-Base-1/">Nmap-Tool-Base-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/03/19/Sublime3-Case-Switch-1/">Sublime3-Case-Switch-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/03/19/Oracle-NULL-Value-1/">Oracle-NULL-Value-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/03/19/Oracle-Enter-Line-Feed-1/">Oracle-Enter-Line-Feed-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/03/19/Oracle-Flashback-1/">Oracle-Flashback-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/02/28/Oracle-DML-Performance-1/">Oracle-DML-Performance-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/02/28/Oracle-Trigger-System-1/">Oracle-Trigger-System-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/02/28/Oracle-Trigger-DDL-1/">Oracle-Trigger-DDL-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/02/28/Oracle-Trigger-DML-1/">Oracle-Trigger-DML-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/02/28/Oracle-Trigger-1/">Oracle-Trigger-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/02/25/VIEW-TRANSFER-PARAMETERS-1/">VIEW-TRANSFER-PARAMETERS-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/02/21/Oracle-Start-With-Connect-By-1/">Oracle-Start-With-Connect-By-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/02/21/Oracle-Date-Case-1/">Oracle-Date-Case-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/01/19/Git-Gogs-Window-Install-1/">Git-Gogs-Window-Install-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/01/14/Hexo-Blog-Change-PC-1/">Hexo-Blog-Change-PC-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/01/14/Jboss-Cmd-Line-1/">Jboss-Cmd-Line-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/01/14/Jboss-Standalone-Config-1/">Jboss-Standalone-Config-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/01/13/Oracle-Table-Information-1/">Oracle-Table-Information-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/01/13/Git-Server-Supplement-3/">Git-Server-Supplement-3</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/01/13/AirTest-Introduction-Config-1/">AirTest-Introduction-Config-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/01/10/Window-Nirsoft-Tools-1/">Window-Nirsoft-Tools-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/01/10/SQLite-Introduction-1/">SQLite-Introduction-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/01/07/Git-Server-Supplement-2/">Git-Server-Supplement-2</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/01/07/Report-Data-Type-Conversion-Error-1/">Report-Data-Type-Conversion-Error-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/01/06/Oracle-ROWNUM-1/">Oracle-ROWNUM-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/01/05/Jaspersoft-Studio-Hidden-1/">Jaspersoft-Studio-Hidden-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/01/05/Java-Jboss-EJB-Project-Deploy-1/">Java-Jboss-EJB-Project-Deploy-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/01/05/Oracle-Create-Table-Case-1/">Oracle-Create-Table-Case-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/01/05/Oracle-Row-Column-Conversion-1/">Oracle-Row-Column-Conversion-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/01/05/Oracle-Decode-1/">Oracle-Decode-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/01/05/Git-Server-Supplement-1/">Git-Server-Supplement-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/01/05/Oracle-Table-Connection-1/">Oracle-Table-Connection-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/01/05/Window-Kill-Process-1/">Window-Kill-Process-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/01/05/JavaSourceCode-SearchMethod-1/">JavaSourceCode-SearchMethod-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/12/18/Lightroom-Base-3/">Lightroom-Base-3</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/12/18/Lightroom-Base-2/">Lightroom-Base-2</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/12/18/Lightroom-Base-1/">Lightroom-Base-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/12/04/Scrapy-Basics-1/">Scrapy-Basics-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/12/04/Ireport-Install-1/">Ireport-Install-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/12/04/Jaspersoft-Studio-Master-Child-Table-2/">Jaspersoft-Studio-Master-Child-Table-2</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/12/04/Jaspersoft-Studio-Master-Child-Table-1/">Jaspersoft-Studio-Master-Child-Table-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/12/04/Jaspersoft-Studio-Install-1/">Jaspersoft-Studio-Install-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/12/04/Oracle-Type-Table-1/">Oracle-Type-Table-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/12/04/Oracle-Exists-And-In-1/">Oracle-Exists-And-In-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/11/12/Linux-Kali-Install-1/">Linux-Kali-Install-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/11/12/Oracle-19c-Debain-Install/">Oracle-19c-Debain-Install</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/11/12/Linux-DPKG-BUG-1/">Linux-DPKG-BUG-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/11/12/SQL-Interview-Questions2/">SQL-Interview-Questions2</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/10/31/Photography-Introduction-1/">Photography-Introduction-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/10/31/Graduation-Thesis-Guidance-2/">Graduation-Thesis-Guidance-2</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/09/22/Graduation-Thesis-Guidance-1/">Graduation-Thesis-Guidance-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/06/13/Rogue-Software-Process/">Rogue-Software-Process</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/06/13/House-Lease-Contract-Template/">House-Lease-Contract-Template</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/06/05/Linux-Start-Fail-1/">Linux-Start-Fail-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/06/02/JAVA-Thread-Base-8/">JAVA-Thread-Base-8</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/06/02/JAVA-Thread-Base-7/">JAVA-Thread-Base-7</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/06/02/JAVA-Thread-Base-6/">JAVA-Thread-Base-6</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/06/01/JAVA-Thread-Base-5/">JAVA-Thread-Base-5</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/06/01/JAVA-Thread-Base-4/">JAVA-Thread-Base-4</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/31/JAVA-Thread-Base-3/">JAVA-Thread-Base-3</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/31/JAVA-Thread-Base-2/">JAVA-Thread-Base-2</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/31/JAVA-Thread-Base-1/">JAVA-Thread-Base-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/30/JAVA-Actual-Combat-6/">JAVA-Actual-Combat-6</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/28/JAVA-Actual-Combat-5/">JAVA-Actual-Combat-5</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/28/JAVA-Actual-Combat-4/">JAVA-Actual-Combat-4</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/28/JAVA-Actual-Combat-3/">JAVA-Actual-Combat-3</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/28/JAVA-Actual-Combat-2/">JAVA-Actual-Combat-2</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/28/JAVA-Actual-Combat-1/">JAVA-Actual-Combat-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/27/Spring-Security-BASE-3/">Spring-Security-BASE-3</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/27/Spring-Security-BASE-2/">Spring-Security-BASE-2</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/24/Spring-Security-BASE-1/">Spring-Security-BASE-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/24/Netty-BASE-3/">Netty-BASE-3</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/22/Netty-BASE-2/">Netty-BASE-2</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/20/Netty-BASE-1/">Netty-BASE-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/20/SpringBoot2-BASE-8/">SpringBoot2-BASE-8</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/20/SpringBoot2-BASE-7/">SpringBoot2-BASE-7</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/20/SpringBoot2-BASE-6/">SpringBoot2-BASE-6</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/20/SpringBoot2-BASE-5/">SpringBoot2-BASE-5</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/20/SpringBoot2-BASE-4/">SpringBoot2-BASE-4</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/20/SpringBoot2-BASE-3/">SpringBoot2-BASE-3</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/19/SpringBoot2-BASE-2/">SpringBoot2-BASE-2</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/19/SpringBoot2-BASE-1/">SpringBoot2-BASE-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/16/Spring-BASE-7/">Spring-BASE-7</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/16/Spring-BASE-6/">Spring-BASE-6</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/16/Spring-BASE-5/">Spring-BASE-5</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/16/Spring-BASE-4/">Spring-BASE-4</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/16/Spring-BASE-3/">Spring-BASE-3</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/16/Spring-BASE-2/">Spring-BASE-2</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/16/Spring-BASE-1/">Spring-BASE-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/12/JAVA-Stack-1/">JAVA-Stack-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/12/JAVA-Linked-List-1/">JAVA-Linked-List-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/12/JAVA-Arrays-Queues-1/">JAVA-Arrays-Queues-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/12/JAVA-SE-1/">JAVA-SE-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/12/JAVA-Spring-AOP-1/">JAVA-Spring-AOP-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/12/JAVA-Spring/">JAVA-Spring</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/12/JAVA-SpringMVC-1/">JAVA-SpringMVC-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/11/JAVA-RabbitMQ-1/">JAVA-RabbitMQ-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/11/SpringCloud-Snowflake-Algorithm/">SpringCloud-Snowflake-Algorithm</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/11/SpringCloud-Alibaba-Seata-1/">SpringCloud-Alibaba-Seata-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/10/SpringCloud-Alibaba-Sentinel-1/">SpringCloud-Alibaba-Sentinel-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/09/SpringCloud-Alibaba-Nacos-1/">SpringCloud-Alibaba-Nacos-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/09/SpringCloud-Alibaba-1/">SpringCloud-Alibaba-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/08/SpringCloud-Sleuth-1/">SpringCloud-Sleuth-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/08/SpringCloud-Stream-1/">SpringCloud-Stream-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/08/SpringCloud-Bus-1/">SpringCloud-Bus-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/08/SpringCloud-Config-1/">SpringCloud-Config-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/07/SpringCloud-GateWay-1/">SpringCloud-GateWay-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/07/SpringCloud-Hystrix-1/">SpringCloud-Hystrix-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/06/SpringCloud-OpenFeign-1/">SpringCloud-OpenFeign-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/06/SpringCloud-Ribbon-1/">SpringCloud-Ribbon-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/06/SpringCloud-RegistrySummary-1/">SpringCloud-RegistrySummary-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/06/SpringCloud-Consul-1/">SpringCloud-Consul-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/06/Zookeeper-Command-1/">Zookeeper-Command-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/06/SpringCloud-Zookeeper-1/">SpringCloud-Zookeeper-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/04/SpringCloud-Eureka-1/">SpringCloud-Eureka-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/03/Java-Interview-Questions/">Java-Interview-Questions</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/04/21/Maven-Import-NotOpenJar/">Maven-Import-NotOpenJar</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/04/21/OpenFeign-And-Sentinel/">OpenFeign-And-Sentinel</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/04/21/Nacos-Install/">Nacos-Install</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/04/21/Apache-JMeter-Simple-Use/">Apache-JMeter-Simple-Use</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/03/07/Spring-Boot-Start-Extension/">Spring-Boot-Start-Extension</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/03/07/Spring-Boot-Cycle1/">Spring-Boot-Cycle1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/03/07/Mysql-Usage-Habit/">Mysql-Usage-Habit</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/03/06/Mysql-Procedure-HTML-Report/">Mysql-Procedure-HTML-Report</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/03/06/K8S-Dashboard/">K8S-Dashboard</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/02/27/K8S-Coredns-1/">K8S-Coredns-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/02/27/K8S-Flannel/">K8S-Flannel</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/02/27/Nginx-ShareFile/">Nginx-ShareFile</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/02/21/Mysql-Install/">Mysql-Install</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/02/21/K8S-Kubectl-Command/">K8S-Kubectl-Command</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/02/21/Java-Apache-Maven/">Java-Apache-Maven</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/02/21/Java-SprintBoot-Error1/">Java-SprintBoot-Error1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/02/18/K8S-Binary-Install/">K8S-Binary-Install</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/02/15/Oracle-Clean-Archivelog/">Oracle-Clean-Archivelog</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/02/15/Docker-Harbor/">Docker-Harbor</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/02/15/Docker-Compose/">Docker-Compose</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/02/15/Yaml-Language/">Yaml_Language</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/02/12/Docker-Network-Operation/">Docker-Network-Operation</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/02/11/Docker-Add-New-Volume/">Docker-Add-New-Volume</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/02/11/Docker-Auto-Start/">Docker-Auto-Start</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/02/11/Docker-Registry/">Docker-Registry</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/02/11/Docker-Dockerfile/">Docker-Dockerfile</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/02/11/Docker-NetworkMode/">Docker-NetworkMode</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/02/11/Docker-Volume/">Docker-Volume</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/02/11/Docker-PortMapping/">Docker-PortMapping</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/02/11/Docker-Command1/">Docker-Command1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/02/10/Docker-Mirror-Acceleration/">Docker-Mirror-Acceleration</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/02/10/Linux-NetworkCard-Rename/">Linux-NetworkCard-Rename</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/02/06/Rancher-Install/">Rancher-Install</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/02/06/Hexo-Blog-Character-Escape/">Hexo-Blog-Character-Escape</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/02/06/Mysql-Procedure-HTML/">Mysql-Procedure-HTML</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/02/06/Mysql-Procedure-Leave/">Mysql-Procedure-Leave</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/01/17/UsbEAmHostsEditor/">UsbEAmHostsEditor</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/01/02/Postgres-Command/">Postgres-Command</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/01/02/Mysql-Storage-Engine/">Mysql-Storage-Engine</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/01/02/Elasticsearch-Cluster-Node-Parameters/">Elasticsearch-Cluster-Node-Parameters</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/01/02/Linux-Elasticsearch-Install/">Linux-Elasticsearch-Install</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/01/02/Linux-Python-File-Sync/">Linux-Python-File-Sync</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/01/02/Window-Process/">Window-Process</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/01/02/Mysql-Lock-1205/">Mysql-Lock-1205</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/12/26/Hexo-Blog-1/">Hexo-Blog-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/12/26/Python-SQLalchemy1/">Python-SQLalchemy1</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/12/26/Window-Regedit-Server/">Window-Regedit-Server</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/12/26/Linux-TinyProxy/">Linux-TinyProxy</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/12/26/Mysql-Procedure3/">Mysql-Procedure3</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/12/26/Mysql-Procedure2/">Mysql-Procedure2</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/11/22/Git-Server/">Git-Server</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/11/22/Git-Local/">Git-Local</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/11/22/Mysql-History/">Mysql-History</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/11/21/Mysql-Procedure1/">Mysql-Procedure1</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/11/21/Mysql-Log-Restore/">Mysql-Log-Restore</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/11/21/Tomcat-Configuration/">Tomcat-Configuration</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/11/21/Spring-Boot-Packing/">Spring-Boot-Packing</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/10/31/Spring-Boot-BestProject/">Spring-Boot-BestProject</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/10/06/Mysql-Windows-Install/">Mysql-Windows-Install</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/10/04/MongoDB-Install/">MongoDB-Install</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/10/02/Oracle-Name-Explain/">Oracle-Name-Explain</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/10/02/Oracle-LimitConnection/">Oracle-LimitConnection</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/10/02/Oracle-ConnResource1/">Oracle-ConnResource1</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/10/02/Redis-Cluster/">Redis-Cluster</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/10/02/Redis-Sentinel/">Redis-Sentinel</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/10/02/Redis-Part-Copy-Principle/">Redis-Part-Copy-Principle</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/10/02/Redis-Copy-Principle/">Redis-Copy-Principle</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/10/02/Redis-Copy/">Redis-Copy</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/10/02/Redis-Memory-Mode/">Redis-Memory-Mode</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/10/02/Redis-Persistence-Principle/">Redis-Persistence-Principle</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/10/02/Redis-Persistence/">Redis-Persistence</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/10/02/Redis-Install/">Redis-Install</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/09/26/Postgres-PGPool-II/">Postgres-PGPool-II</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/09/26/Postgres-Copy/">Postgres-Copy</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/09/26/Postgres-Backup/">Postgres-Backup</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/09/26/Postgres-Install/">Postgres-Install</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/07/18/SQL-Interview-Questions1/">SQL-Interview-Questions1</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/07/18/Linux-Update-GCC9-3-0/">Linux-Update-GCC9.3.0</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/07/18/Mysql-XtraBackup/">Mysql-XtraBackup</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/07/18/Mysql-MysqlDump/">Mysql-MysqlDump</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/07/12/Window-USB-Disk/">Window-USB-Disk</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/07/12/Window-NTP/">Window-NTP</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/07/12/MongDB-Backup/">MongDB-Backup</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/07/12/MongDB-Copy-Cluster/">MongDB-Copy-Cluster</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/07/11/Oracle-RAC-CmdSimple/">Oracle-RAC-CmdSimple</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/07/11/Oracle-RAC1/">Oracle-RAC1</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/07/11/Oracle-DG2/">Oracle-DG2</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/07/08/Linux-OpenSSH-Update/">Linux-OpenSSH-Update</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/04/04/Corosync-Pacemaker-CRM/">Corosync-Pacemaker-CRM</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/04/04/CRM-Parameter/">CRM-Parameter</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/04/04/CentOS-Mail-Client/">CentOS-Mail-Client</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/04/04/CentOS-Mail-Address/">CentOS-Mail-Address</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/04/04/Oracle-Backup-RMAN/">Oracle-Backup-RMAN</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/04/04/Oracle-Backup-EXP/">Oracle-Backup-EXP</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/04/04/Oracle-DG-Multiple-Nodes/">Oracle-DG-Multiple-Nodes</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/04/04/Zabbix-Install/">Zabbix-Install</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/04/04/Linux-NTP/">Linux-NTP</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/04/04/Oracle-Patrol-Other/">Oracle-Patrol-Other</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/04/04/Oracle-Patrol-Security/">Oracle-Patrol-Security</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/04/04/Oracle-Patrol-CPU-IO-MEM/">Oracle-Patrol-CPU-IO-MEM</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/04/04/Oracle-Patrol-Performance/">Oracle-Patrol-Performance</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/04/04/Oracle-Patrol-Backup/">Oracle-Patrol-Backup</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/04/04/Oracle-Patrol-Use/">Oracle-Patrol-Use</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/04/04/Oracle-Patrol-Base/">Oracle-Patrol-Base</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/04/04/Oracle-Fragment/">Oracle-Fragment</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/04/04/Oracle-RAC-Summary/">Oracle-RAC-Summary</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/04/04/VMware-ShareDisk/">VMware-ShareDisk</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/04/04/Oracle-DG1/">Oracle-DG1</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/04/04/Mariadb-Copy/">Mariadb-Copy</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/04/04/Linux-SSH/">Linux-SSH</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/04/04/Linux-DRBD/">Linux-DRBD</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/04/04/Linux-LVM/">Linux_LVM</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/04/03/MyFirstBlog/">MyFirstBlog</a></li></ul>




    <script>
        
    </script>
</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                <i class="fa fa-copyright"></i> 
                2016-2023 Sevattal
            </div>
            <!--<div class="footer-right">
                <a href="http://hexo.io/" target="_blank" title="A fast, simple &amp; powerful blog framework">Hexo</a>  Theme <a href="https://github.com/MOxFIVE/hexo-theme-yelee" target="_blank" title="Another simple and elegant theme for Hexo  v3.5">Yelee</a> by MOxFIVE <i class="fa fa-heart animated infinite pulse"></i>
            </div>-->
        </div>
        
            <div class="visit">
                
                    <span id="busuanzi_container_site_pv" style='display:none'>
                        <span id="site-visit" title="Site Visitors"><i class="fa fa-user" aria-hidden="true"></i><span id="busuanzi_value_site_uv"></span>
                        </span>
                    </span>
                
                
                    <span>| </span>
                
                
                    <span id="busuanzi_container_page_pv" style='display:none'>
                        <span id="page-visit"  title="Page Hits"><i class="fa fa-eye animated infinite pulse" aria-hidden="true"></i><span id="busuanzi_value_page_pv"></span>
                        </span>
                    </span>
                
            </div>
        
    </div>
</footer>
    </div>
    
<script data-main="/js/main.js" src="//cdn.bootcss.com/require.js/2.2.0/require.min.js"></script>

    <script>
        $(document).ready(function() {
            var iPad = window.navigator.userAgent.indexOf('iPad');
            if (iPad > -1 || $(".left-col").css("display") === "none") {
                var bgColorList = ["#9db3f4", "#414141", "#e5a859", "#f5dfc6", "#c084a0", "#847e72", "#cd8390", "#996731"];
                var bgColor = Math.ceil(Math.random() * (bgColorList.length - 1));
                $("body").css({"background-color": bgColorList[bgColor], "background-size": "cover"});
            }
            else {
                var backgroundnum = 5;
                var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
                $("body").css({"background": backgroundimg, "background-attachment": "fixed", "background-size": "cover"});
            }
        })
    </script>





<div class="scroll" id="scroll">
    <a href="#" title="Back to Top"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments" onclick="load$hide();" title="Comments"><i class="fa fa-comments-o"></i></a>
    <a href="#footer" title="Go to Bottom"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    // Open in New Window
    
        $("a[target=_blank]").removeAttr("target");
    
</script>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
  </div>
</body>
</html>