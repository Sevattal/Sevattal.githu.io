<!DOCTYPE html>
<html lang="en">
<head>

    <!--[if lt IE 9]>
        <style>body {display: none; background: none !important} </style>
        <meta http-equiv="Refresh" Content="0; url=//outdatedbrowser.com/" />
    <![endif]-->

<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="format-detection" content="telephone=no" />
<meta name="author" content="Sevattal" />



<meta name="description" content="K8S 二进制部署参考：https:&#x2F;&#x2F;blog.csdn.net&#x2F;fanjianhai&#x2F;article&#x2F;details&#x2F;109444648参考：https:&#x2F;&#x2F;www.bilibili.com&#x2F;video&#x2F;BV1PJ411h7Sw?p&#x3D;25 安装部署环境说明（本文实验环境为CentOS7）Linux 内核要求  注：要在3.0以上（Docker 对于Linux的内核要求），只要是内核达到3.0及">
<meta property="og:type" content="article">
<meta property="og:title" content="K8S-Binary-Install">
<meta property="og:url" content="http://yoursite.com/2021/02/18/K8S-Binary-Install/index.html">
<meta property="og:site_name" content="Sevattal">
<meta property="og:description" content="K8S 二进制部署参考：https:&#x2F;&#x2F;blog.csdn.net&#x2F;fanjianhai&#x2F;article&#x2F;details&#x2F;109444648参考：https:&#x2F;&#x2F;www.bilibili.com&#x2F;video&#x2F;BV1PJ411h7Sw?p&#x3D;25 安装部署环境说明（本文实验环境为CentOS7）Linux 内核要求  注：要在3.0以上（Docker 对于Linux的内核要求），只要是内核达到3.0及">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://yoursite.com/2021/02/18/K8S-Binary-Install/1.png">
<meta property="og:image" content="http://yoursite.com/2021/02/18/K8S-Binary-Install/2.png">
<meta property="og:image" content="http://yoursite.com/2021/02/18/K8S-Binary-Install/3.png">
<meta property="og:image" content="http://yoursite.com/2021/02/18/K8S-Binary-Install/4.png">
<meta property="og:image" content="http://yoursite.com/2021/02/18/K8S-Binary-Install/5.png">
<meta property="og:image" content="http://yoursite.com/2021/02/18/K8S-Binary-Install/6.png">
<meta property="og:image" content="http://yoursite.com/2021/02/18/K8S-Binary-Install/7.png">
<meta property="og:image" content="http://yoursite.com/2021/02/18/K8S-Binary-Install/8.png">
<meta property="og:image" content="http://yoursite.com/2021/02/18/K8S-Binary-Install/9.png">
<meta property="og:image" content="http://yoursite.com/2021/02/18/K8S-Binary-Install/10.png">
<meta property="og:image" content="http://yoursite.com/2021/02/18/K8S-Binary-Install/11.png">
<meta property="og:image" content="http://yoursite.com/2021/02/18/K8S-Binary-Install/12.png">
<meta property="og:image" content="http://yoursite.com/2021/02/18/K8S-Binary-Install/13.png">
<meta property="og:image" content="http://yoursite.com/2021/02/18/K8S-Binary-Install/14.png">
<meta property="og:image" content="http://yoursite.com/2021/02/18/K8S-Binary-Install/15.png">
<meta property="og:image" content="http://yoursite.com/2021/02/18/K8S-Binary-Install/16.png">
<meta property="og:image" content="http://yoursite.com/2021/02/18/K8S-Binary-Install/17.png">
<meta property="og:image" content="http://yoursite.com/2021/02/18/K8S-Binary-Install/18.png">
<meta property="og:image" content="http://yoursite.com/2021/02/18/K8S-Binary-Install/19.png">
<meta property="og:image" content="http://yoursite.com/2021/02/18/K8S-Binary-Install/20.png">
<meta property="og:image" content="http://yoursite.com/2021/02/18/K8S-Binary-Install/21.png">
<meta property="og:image" content="http://yoursite.com/2021/02/18/K8S-Binary-Install/22.png">
<meta property="og:image" content="http://yoursite.com/2021/02/18/K8S-Binary-Install/23.png">
<meta property="og:image" content="http://yoursite.com/2021/02/18/K8S-Binary-Install/24.png">
<meta property="og:image" content="http://yoursite.com/2021/02/18/K8S-Binary-Install/25.png">
<meta property="og:image" content="http://yoursite.com/2021/02/18/K8S-Binary-Install/26.png">
<meta property="og:image" content="http://yoursite.com/2021/02/18/K8S-Binary-Install/27.png">
<meta property="og:image" content="http://yoursite.com/2021/02/18/K8S-Binary-Install/28.png">
<meta property="og:image" content="http://yoursite.com/2021/02/18/K8S-Binary-Install/29.png">
<meta property="og:image" content="http://yoursite.com/2021/02/18/K8S-Binary-Install/30.png">
<meta property="og:image" content="http://yoursite.com/2021/02/18/K8S-Binary-Install/31.png">
<meta property="og:image" content="http://yoursite.com/2021/02/18/K8S-Binary-Install/32.png">
<meta property="og:image" content="http://yoursite.com/2021/02/18/K8S-Binary-Install/33.png">
<meta property="og:image" content="http://yoursite.com/2021/02/18/K8S-Binary-Install/34.png">
<meta property="og:image" content="http://yoursite.com/2021/02/18/K8S-Binary-Install/35.png">
<meta property="og:image" content="http://yoursite.com/2021/02/18/K8S-Binary-Install/36.png">
<meta property="og:image" content="http://yoursite.com/2021/02/18/K8S-Binary-Install/37.png">
<meta property="og:image" content="http://yoursite.com/2021/02/18/K8S-Binary-Install/38.png">
<meta property="og:image" content="http://yoursite.com/2021/02/18/K8S-Binary-Install/39.png">
<meta property="og:image" content="http://yoursite.com/2021/02/18/K8S-Binary-Install/40.png">
<meta property="og:image" content="http://yoursite.com/2021/02/18/K8S-Binary-Install/41.png">
<meta property="og:image" content="http://yoursite.com/2021/02/18/K8S-Binary-Install/42.png">
<meta property="og:image" content="http://yoursite.com/2021/02/18/K8S-Binary-Install/43.png">
<meta property="og:image" content="http://yoursite.com/2021/02/18/K8S-Binary-Install/44.png">
<meta property="og:image" content="http://yoursite.com/2021/02/18/K8S-Binary-Install/45.png">
<meta property="article:published_time" content="2021-02-18T06:32:43.000Z">
<meta property="article:modified_time" content="2022-11-18T01:11:42.520Z">
<meta property="article:author" content="Sevattal">
<meta property="article:tag" content="Kubernetes">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://yoursite.com/2021/02/18/K8S-Binary-Install/1.png">

<link rel="apple-touch-icon" href= "/apple-touch-icon.png">


    <link rel="alternate" href="/atom.xml" title="Sevattal" type="application/atom+xml">



    <link rel="shortcut icon" href="/favicon.png">



    <link href="//cdn.bootcss.com/animate.css/3.5.1/animate.min.css" rel="stylesheet">



    <link href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.css" rel="stylesheet">



    <script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
    <link href="//cdn.bootcss.com/pace/1.0.2/themes/blue/pace-theme-minimal.css" rel="stylesheet">



<link rel="stylesheet" href="/css/style.css">




<link href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">


<title>K8S-Binary-Install | Sevattal</title>

<script src="//cdn.bootcss.com/jquery/2.2.4/jquery.min.js"></script>
<script src="//cdn.bootcss.com/clipboard.js/1.5.10/clipboard.min.js"></script>

<script>
    var yiliaConfig = {
        fancybox: true,
        animate: true,
        isHome: false,
        isPost: true,
        isArchive: false,
        isTag: false,
        isCategory: false,
        fancybox_js: "//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.js",
        scrollreveal: "//cdn.bootcss.com/scrollReveal.js/3.1.4/scrollreveal.min.js",
        search: true
    }
</script>


    <script> yiliaConfig.jquery_ui = [false]; </script>



    <script> yiliaConfig.rootUrl = "\/";</script>






<meta name="generator" content="Hexo 6.3.0"></head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        <a href="/" class="profilepic">
            <img src="/img/my_img1.png" class="animated zoomIn">
        </a>
        <hgroup>
          <h1 class="header-author"><a href="/"></a></h1>
        </hgroup>

        

        
            <form id="search-form">
            <input type="text" id="local-search-input" name="q" placeholder="search..." class="search form-control" autocomplete="off" autocorrect="off" searchonload="false" />
            <i class="fa fa-times" onclick="resetSearch()"></i>
            </form>
            <div id="local-search-result"></div>
            <p class='no-result'>No results found <i class='fa fa-spinner fa-pulse'></i></p>
        


        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        <div class="icon-wrap icon-link hide" data-idx="2">
                            <div class="loopback_l"></div>
                            <div class="loopback_r"></div>
                        </div>
                        
                        
                        <div class="icon-wrap icon-me hide" data-idx="3">
                            <div class="user"></div>
                            <div class="shoulder"></div>
                        </div>
                        
                    </div>
                    
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>Menu</li>
                        <li>Tags</li>
                        
                        <li>Friends</li>
                        
                        
                        <li>About Me</li>
                        
                    </ul>
                </div>
            </div>
        

        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a href="/">主页</a></li>
                        
                            <li><a href="/tags/">标签云</a></li>
                        
                            <li><a href="/about_me/">关于我</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa Email" href="mailto:923762269@qq.com" title="Email"></a>
                            
                                <a class="fa GitHub" target="_blank" rel="noopener" href="https://sevattal.github.io" title="GitHub"></a>
                            
                        </ul>
                    </nav>
                </section>
                
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/ACL/" rel="tag">ACL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ASM/" rel="tag">ASM</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Ansible/" rel="tag">Ansible</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Backup/" rel="tag">Backup</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Bus/" rel="tag">Bus</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CRM/" rel="tag">CRM</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Cisco/" rel="tag">Cisco</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Config/" rel="tag">Config</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Consul/" rel="tag">Consul</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Corosync-Pacemaker-CRM/" rel="tag">Corosync-Pacemaker-CRM</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Crontab/" rel="tag">Crontab</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DG/" rel="tag">DG</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DM-Database/" rel="tag">DM Database</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DRBD/" rel="tag">DRBD</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/EIGRP/" rel="tag">EIGRP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/EXP/" rel="tag">EXP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Elasticsearch/" rel="tag">Elasticsearch</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Eureka/" rel="tag">Eureka</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/FFmpeg/" rel="tag">FFmpeg</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/FlashBack/" rel="tag">FlashBack</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Flask-SQLalchemy/" rel="tag">Flask-SQLalchemy</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/GCC/" rel="tag">GCC</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/GateWay/" rel="tag">GateWay</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HTML/" rel="tag">HTML</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HUAWEI/" rel="tag">HUAWEI</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hexo/" rel="tag">Hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hystrix/" rel="tag">Hystrix</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Interview/" rel="tag">Interview</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JMeter/" rel="tag">JMeter</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Job/" rel="tag">Job</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Kubernetes/" rel="tag">Kubernetes</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/LVM/" rel="tag">LVM</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Lightroom/" rel="tag">Lightroom</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Mail/" rel="tag">Mail</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Maven/" rel="tag">Maven</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MongDB/" rel="tag">MongDB</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Mysql/" rel="tag">Mysql</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Mysql-Lock/" rel="tag">Mysql-Lock</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MysqlDump/" rel="tag">MysqlDump</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NAT/" rel="tag">NAT</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NTP/" rel="tag">NTP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Nacos/" rel="tag">Nacos</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Neo4j/" rel="tag">Neo4j</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Netty/" rel="tag">Netty</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NetworkCard/" rel="tag">NetworkCard</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Nginx/" rel="tag">Nginx</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Nmap/" rel="tag">Nmap</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/OSPF/" rel="tag">OSPF</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/OpenFeign/" rel="tag">OpenFeign</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/OpenSSH/" rel="tag">OpenSSH</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Oracle/" rel="tag">Oracle</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Oracle-RAC/" rel="tag">Oracle RAC</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Oracle-Inspection/" rel="tag">Oracle-Inspection</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Oracle-Name/" rel="tag">Oracle-Name</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PGPool-II/" rel="tag">PGPool-II</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Postgres/" rel="tag">Postgres</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Postgres-PGPool-II/" rel="tag">Postgres+PGPool-II</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Postgres-Copy/" rel="tag">Postgres-Copy</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Procedure/" rel="tag">Procedure</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RAC/" rel="tag">RAC</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RMAN/" rel="tag">RMAN</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Rancher/" rel="tag">Rancher</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Redis/" rel="tag">Redis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Redis-AOF/" rel="tag">Redis-AOF</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Redis-Cluster/" rel="tag">Redis-Cluster</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Redis-Copy/" rel="tag">Redis-Copy</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Redis-Memory/" rel="tag">Redis-Memory</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Redis-RDB/" rel="tag">Redis-RDB</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Redis-Sentinel/" rel="tag">Redis-Sentinel</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Regedit/" rel="tag">Regedit</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Restore/" rel="tag">Restore</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Ribbon/" rel="tag">Ribbon</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Route/" rel="tag">Route</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SNMP/" rel="tag">SNMP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SSH/" rel="tag">SSH</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/STP/" rel="tag">STP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Scrapy/" rel="tag">Scrapy</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Sentinel/" rel="tag">Sentinel</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ShareDisk/" rel="tag">ShareDisk</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Sleuth/" rel="tag">Sleuth</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Spring/" rel="tag">Spring</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Spring-Security/" rel="tag">Spring Security</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Stream/" rel="tag">Stream</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Supervisor/" rel="tag">Supervisor</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Swap/" rel="tag">Swap</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Switch/" rel="tag">Switch</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TinyProxy/" rel="tag">TinyProxy</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Tomcat/" rel="tag">Tomcat</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Trigger/" rel="tag">Trigger</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/USB/" rel="tag">USB</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/VLAN/" rel="tag">VLAN</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/VMware/" rel="tag">VMware</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/VTP/" rel="tag">VTP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Video-Clip/" rel="tag">Video-Clip</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/XtraBackup/" rel="tag">XtraBackup</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Yaml/" rel="tag">Yaml</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Zabbix/" rel="tag">Zabbix</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Zookeeper/" rel="tag">Zookeeper</a></li></ul>
                    </div>
                </section>
                
                
                
                <section class="switch-part switch-part3">
                    <div id="js-friends">
                    
                      <a class="main-nav-link switch-friends-link" target="_blank" rel="noopener" href="https://sevattal.github.com/">GitHub</a>
                    
                    </div>
                </section>
                

                
                
                <section class="switch-part switch-part4">
                
                    <div id="js-aboutme">乌拉乌拉乌拉乌拉乌拉乌拉</div>
                </section>
                
            </div>
        </div>
    </header>                
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页"></a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                <img src="/img/my_img1.png" class="animated zoomIn">
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="回到主页"></a></h1>
            </hgroup>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/">主页</a></li>
                
                    <li><a href="/tags/">标签云</a></li>
                
                    <li><a href="/about_me/">关于我</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa Email" target="_blank" href="mailto:923762269@qq.com" title="Email"></a>
                            
                                <a class="fa GitHub" target="_blank" href="https://sevattal.github.io" title="GitHub"></a>
                            
                        </ul>
            </nav>
        </header>                
    </div>
    <link class="menu-list" tags="Tags" friends="Friends" about="About Me"/>
</nav>
      <div class="body-wrap"><article id="post-K8S-Binary-Install" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2021/02/18/K8S-Binary-Install/" class="article-date">
      <time datetime="2021-02-18T06:32:43.000Z" itemprop="datePublished">2021-02-18</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      K8S-Binary-Install
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/Linux/">Linux</a>
    </div>


        
    <div class="article-tag tagcloud">
        <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Kubernetes/" rel="tag">Kubernetes</a></li></ul>
    </div>

        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h1 id="K8S-二进制部署"><a href="#K8S-二进制部署" class="headerlink" title="K8S 二进制部署"></a>K8S 二进制部署</h1><p>参考：<a target="_blank" rel="noopener" href="https://blog.csdn.net/fanjianhai/article/details/109444648">https://blog.csdn.net/fanjianhai/article/details/109444648</a><br>参考：<a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1PJ411h7Sw?p=25">https://www.bilibili.com/video/BV1PJ411h7Sw?p=25</a></p>
<h2 id="安装部署环境说明（本文实验环境为CentOS7）"><a href="#安装部署环境说明（本文实验环境为CentOS7）" class="headerlink" title="安装部署环境说明（本文实验环境为CentOS7）"></a>安装部署环境说明（本文实验环境为CentOS7）</h2><p>Linux 内核要求</p>
<p><img src="/2021/02/18/K8S-Binary-Install/1.png"></p>
<p>注：要在3.0以上（Docker 对于Linux的内核要求），只要是内核达到3.0及其以上的Linux版本都可以，可选择自己熟悉的Linux发行版。由于我比较熟悉CentOS和红帽，本文采用CentOS搭建。</p>
<span id="more"></span>

<h3 id="IP地址分配"><a href="#IP地址分配" class="headerlink" title="IP地址分配"></a>IP地址分配</h3><table>
<thead>
<tr>
<th align="left">主机名称</th>
<th align="left">主机IP</th>
<th align="left">VIP</th>
<th align="left">业务域名</th>
<th align="left">主机域名</th>
<th align="left">容器IP</th>
<th align="left">作用</th>
</tr>
</thead>
<tbody><tr>
<td align="left">Master1</td>
<td align="left">192.168.10.11</td>
<td align="left">192.168.10.10</td>
<td align="left"></td>
<td align="left">sevattal-11.host.com</td>
<td align="left"></td>
<td align="left">Proxy(L4,L7)master，反向代理</td>
</tr>
<tr>
<td align="left">Master2</td>
<td align="left">192.168.10.12</td>
<td align="left">192.168.10.10</td>
<td align="left"></td>
<td align="left">sevattal-12.host.com</td>
<td align="left"></td>
<td align="left">Proxy(L4,L7)standby01，反向代理</td>
</tr>
<tr>
<td align="left">Master3</td>
<td align="left">192.168.10.13</td>
<td align="left">192.168.10.10</td>
<td align="left"></td>
<td align="left">sevattal-13.host.com</td>
<td align="left"></td>
<td align="left">Proxy(L4,L7)standby02，反向代理</td>
</tr>
<tr>
<td align="left">Node1</td>
<td align="left">192.168.10.21</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">sevattal-21.host.com</td>
<td align="left">172.7.21.1&#x2F;24</td>
<td align="left">etcd,apiserver,kube-controller-manager,kube-scheduler,kubelet</td>
</tr>
<tr>
<td align="left">Node2</td>
<td align="left">192.168.10.22</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">sevattal-22.host.com</td>
<td align="left">172.7.22.1&#x2F;24</td>
<td align="left">etcd,apiserver,kube-controller-manager,kube-scheduler,kubelet</td>
</tr>
<tr>
<td align="left">Node3</td>
<td align="left">192.168.10.23</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">sevattal-23.host.com</td>
<td align="left">172.7.23.1&#x2F;24</td>
<td align="left">etcd,apiserver,kube-controller-manager,kube-scheduler,kubelet</td>
</tr>
<tr>
<td align="left">Warehouse</td>
<td align="left">192.168.10.40</td>
<td align="left"></td>
<td align="left">harbor.example.com</td>
<td align="left">sevattal-40.host.com</td>
<td align="left">172.7.40.1&#x2F;24</td>
<td align="left">harbor镜像仓库</td>
</tr>
<tr>
<td align="left">CFSSL</td>
<td align="left">192.168.10.30</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">sevattal-30.host.com</td>
<td align="left"></td>
<td align="left">CFSSL证书认证</td>
</tr>
<tr>
<td align="left">DNS</td>
<td align="left">192.168.10.2</td>
<td align="left"></td>
<td align="left">dns.example.com</td>
<td align="left">dns.host.com</td>
<td align="left"></td>
<td align="left">DNS服务</td>
</tr>
</tbody></table>
<h3 id="网段划分"><a href="#网段划分" class="headerlink" title="网段划分"></a>网段划分</h3><pre><code>Service网络：10.10.0.0/16
Pod网络：172.7.0.0/16
节点网络：192.168.10.0/24
</code></pre>
<h2 id="一、前期服务器准备"><a href="#一、前期服务器准备" class="headerlink" title="一、前期服务器准备"></a>一、前期服务器准备</h2><p>以下操作在所有主机上操作</p>
<h4 id="基于主机名通信：-x2F-etc-x2F-hosts"><a href="#基于主机名通信：-x2F-etc-x2F-hosts" class="headerlink" title="基于主机名通信：&#x2F;etc&#x2F;hosts"></a>基于主机名通信：&#x2F;etc&#x2F;hosts</h4><pre><code>192.168.10.10 master.example.com master
192.168.10.11 master1.example.com master1
192.168.10.12 master2.example.com master2
192.168.10.13 master3.example.com master3
192.168.10.21 node1.example.com node1
192.168.10.22 node2.example.com node2
192.168.10.23 node3.example.com node3
192.168.10.30 tls.example.com tls
192.168.10.40 warehouse.example.com warehouse
</code></pre>
<h4 id="所有K8S主机关闭selinux"><a href="#所有K8S主机关闭selinux" class="headerlink" title="所有K8S主机关闭selinux"></a>所有K8S主机关闭selinux</h4><pre><code>setenforce 0
vim /etc/selinux/config
    SELINUX=disabled
</code></pre>
<h4 id="所有K8S主机关闭防火墙"><a href="#所有K8S主机关闭防火墙" class="headerlink" title="所有K8S主机关闭防火墙"></a>所有K8S主机关闭防火墙</h4><pre><code>systemctl disable firewalld
systemctl stop firewalld
</code></pre>
<h4 id="关闭swapoff分区"><a href="#关闭swapoff分区" class="headerlink" title="关闭swapoff分区"></a>关闭swapoff分区</h4><pre><code>swapoff -a
sed -ri &#39;s/.*swap.*/#&amp;/&#39; /etc/fstab
</code></pre>
<h4 id="时间同步（这边使用的是ntpdate）"><a href="#时间同步（这边使用的是ntpdate）" class="headerlink" title="时间同步（这边使用的是ntpdate）"></a>时间同步（这边使用的是ntpdate）</h4><pre><code>yum install ntpdate
echo &#39;*/30 * * * * /usr/sbin/ntpdate 192.168.10.1 &gt;/dev/null 2&gt;&amp;1&#39; &gt; /tmp/crontab2.tmp
crontab /tmp/crontab2.tmp
systemctl enable crond
systemctl start crond
</code></pre>
<h4 id="时间同步建议使用chronyd"><a href="#时间同步建议使用chronyd" class="headerlink" title="时间同步建议使用chronyd"></a>时间同步建议使用chronyd</h4><p><label style="color: red"><strong>注：我这边192.168.10.1是我的时间服务器</strong></label></p>
<h4 id="调整yum源，安装epel-release"><a href="#调整yum源，安装epel-release" class="headerlink" title="调整yum源，安装epel-release"></a>调整yum源，安装epel-release</h4><pre><code>yum install epel-release -y
</code></pre>
<h4 id="安装必要的工具（用于后期维护）"><a href="#安装必要的工具（用于后期维护）" class="headerlink" title="安装必要的工具（用于后期维护）"></a>安装必要的工具（用于后期维护）</h4><pre><code>yum install wget net-tools telnet tree nmap sysstat lrzsz dos2unix bind-utils -y
</code></pre>
<h2 id="二、在DNS主机上安装DNS服务"><a href="#二、在DNS主机上安装DNS服务" class="headerlink" title="二、在DNS主机上安装DNS服务"></a>二、在DNS主机上安装DNS服务</h2><p>以下操作在DNS主机上运行</p>
<h3 id="1、安装DNS服务"><a href="#1、安装DNS服务" class="headerlink" title="1、安装DNS服务"></a>1、安装DNS服务</h3><pre><code>yum install bind -y
</code></pre>
<h3 id="2、-x2F-etc-x2F-named-conf配置文件修改"><a href="#2、-x2F-etc-x2F-named-conf配置文件修改" class="headerlink" title="2、&#x2F;etc&#x2F;named.conf配置文件修改"></a>2、&#x2F;etc&#x2F;named.conf配置文件修改</h3><p><img src="/2021/02/18/K8S-Binary-Install/2.png"></p>
<h3 id="3、检查配置文件是否正确name-checkconf"><a href="#3、检查配置文件是否正确name-checkconf" class="headerlink" title="3、检查配置文件是否正确name-checkconf"></a>3、检查配置文件是否正确name-checkconf</h3><p><img src="/2021/02/18/K8S-Binary-Install/3.png"></p>
<h3 id="4、配置区域配置文件-x2F-etc-x2F-named-x2F-named-rfc1912-zones"><a href="#4、配置区域配置文件-x2F-etc-x2F-named-x2F-named-rfc1912-zones" class="headerlink" title="4、配置区域配置文件&#x2F;etc&#x2F;named&#x2F;named.rfc1912.zones"></a>4、配置区域配置文件&#x2F;etc&#x2F;named&#x2F;named.rfc1912.zones</h3><p>主机域与业务域最好分开使用，这样方便维护。主机域一般都是使用的假域，用于本地使用。</p>
<pre><code>//
// 主机域
//
zone &quot;host.com&quot; IN &#123;
        type master;
        file &quot;host.com.zone&quot;;
        allow-update &#123; 192.168.10.2; &#125;;
&#125;;
//
// 业务域
//
zone &quot;example.com&quot; IN &#123;
        type master;
        file &quot;example.com.zone&quot;;
        allow-update &#123; 192.168.10.2; &#125;;
&#125;;
</code></pre>
<p><img src="/2021/02/18/K8S-Binary-Install/4.png"></p>
<p><label style="color: red"><strong>注：定义主机域的时候一定要让主机域名与现在跑的业务没有关系，这个方便后期维护。</strong></label></p>
<p>检查配置文件是否正确name-checkconf</p>
<p><img src="/2021/02/18/K8S-Binary-Install/5.png"></p>
<h3 id="6、配置host-com-zone-、example-com-zone文件"><a href="#6、配置host-com-zone-、example-com-zone文件" class="headerlink" title="6、配置host.com.zone 、example.com.zone文件"></a>6、配置host.com.zone 、example.com.zone文件</h3><p>配置主机域&#x2F;var&#x2F;named&#x2F;host.com.zone   (没有这个文件可以复制named.empty进行更改)</p>
<pre><code>$TTL 1D
@       IN SOA  host.com. dnsadmin.host.com. (
                                        0               ; serial
                                        1D              ; refresh
                                        1H              ; retry
                                        1W              ; expire
                                        3H )            ; minimum
@               IN      NS      dns.host.com.
dns             IN      A       192.168.10.2
sevattal-10     IN      A       192.168.10.10
sevattal-11     IN      A       192.168.10.11
sevattal-12     IN      A       192.168.10.12
sevattal-13     IN      A       192.168.10.13
sevattal-21     IN      A       192.168.10.21
sevattal-22     IN      A       192.168.10.22
sevattal-23     IN      A       192.168.10.23
sevattal-30     IN      A       192.168.10.30
sevattal-40     IN      A       192.168.10.40
</code></pre>
<p><img src="/2021/02/18/K8S-Binary-Install/6.png"></p>
<p>配置主机域&#x2F;var&#x2F;named&#x2F;example.com.zone   (没有这个文件可以复制named.empty进行更改)</p>
<pre><code>$TTL 1D
@       IN SOA  example.com. root.example.com. (
                                        0               ; serial
                                        1D              ; refresh
                                        1H              ; retry
                                        1W              ; expire
                                        3H )            ; minimum
@               IN      NS      dns.example.com.
dns             IN      A       192.168.10.2
</code></pre>
<p><label style="color: red"><strong>注：zone文件属主属组为：root:named，否则无法生效。</strong></label></p>
<p>检查配置文件是否正确name-checkconf</p>
<p><img src="/2021/02/18/K8S-Binary-Install/7.png"></p>
<h3 id="7、重启named服务"><a href="#7、重启named服务" class="headerlink" title="7、重启named服务"></a>7、重启named服务</h3><pre><code>systemctl restart named
</code></pre>
<p><label style="color: red"><strong>以下操作在所有主机上操作</strong></label></p>
<h3 id="8、更改其他所有机器的DNS指向"><a href="#8、更改其他所有机器的DNS指向" class="headerlink" title="8、更改其他所有机器的DNS指向"></a>8、更改其他所有机器的DNS指向</h3><p>修改网卡配置文件ifcfg-ens33</p>
<pre><code>vim /etc/sysconfig/network-scripts/ifcfg-ens33
</code></pre>
<p><img src="/2021/02/18/K8S-Binary-Install/8.png"></p>
<p>修改&#x2F;etc&#x2F;resolv.conf</p>
<pre><code>vim /etc/resolv.conf
</code></pre>
<p><img src="/2021/02/18/K8S-Binary-Install/9.png"></p>
<p>重启网卡</p>
<pre><code>systemctl restart network
</code></pre>
<h3 id="9、查看DNS是否生效"><a href="#9、查看DNS是否生效" class="headerlink" title="9、查看DNS是否生效"></a>9、查看DNS是否生效</h3><pre><code>dig -t A sevattal-13.host.com @192.168.10.2
</code></pre>
<p><img src="/2021/02/18/K8S-Binary-Install/10.png"></p>
<h2 id="三、CFSSL安装即签发证书"><a href="#三、CFSSL安装即签发证书" class="headerlink" title="三、CFSSL安装即签发证书"></a>三、CFSSL安装即签发证书</h2><p><label style="color: red"><strong>以下操作在CFSSL主机上执行</strong></label></p>
<h3 id="1、下载CFSSL安装包（网址：http-pkg-cfssl-org-）"><a href="#1、下载CFSSL安装包（网址：http-pkg-cfssl-org-）" class="headerlink" title="1、下载CFSSL安装包（网址：http://pkg.cfssl.org/）"></a>1、下载CFSSL安装包（网址：<a target="_blank" rel="noopener" href="http://pkg.cfssl.org/%EF%BC%89">http://pkg.cfssl.org/）</a></h3><pre><code>wget http://pkg.cfssl.org/R1.2/cfssl_linux-amd64 -O /usr/bin/cfssl
wget http://pkg.cfssl.org/R1.2/cfssljson_linux-amd64 -O /usr/bin/cfssl-json
wget http://pkg.cfssl.org/R1.2/cfssl-certinfo_linux-amd64 -O /usr/bin/cfssl-certinfo
</code></pre>
<h3 id="2、给cfssl文件可执行权限"><a href="#2、给cfssl文件可执行权限" class="headerlink" title="2、给cfssl文件可执行权限"></a>2、给cfssl文件可执行权限</h3><pre><code>chmod +x /usr/bin/cfssl*
</code></pre>
<h3 id="3、创建证书文件目录"><a href="#3、创建证书文件目录" class="headerlink" title="3、创建证书文件目录"></a>3、创建证书文件目录</h3><pre><code>mkdir /opt/certs
</code></pre>
<h3 id="4、创建在CA证书文件-x2F-opt-x2F-certs-x2F-ca-csr-json"><a href="#4、创建在CA证书文件-x2F-opt-x2F-certs-x2F-ca-csr-json" class="headerlink" title="4、创建在CA证书文件&#x2F;opt&#x2F;certs&#x2F;ca-csr.json"></a>4、创建在CA证书文件&#x2F;opt&#x2F;certs&#x2F;ca-csr.json</h3><pre><code>&#123;
    &quot;CN&quot;: &quot;SevattalEdu&quot;,
    &quot;hosts&quot;: [
    ],
    &quot;key&quot;: &#123;
        &quot;algo&quot;: &quot;rsa&quot;,
        &quot;size&quot;: 2048
    &#125;,
    &quot;names&quot;: [
        &#123;
            &quot;C&quot;: &quot;CN&quot;,
            &quot;ST&quot;: &quot;beijing&quot;,
            &quot;L&quot;: &quot;beijing&quot;,
            &quot;O&quot;: &quot;example&quot;,
            &quot;OU&quot;: &quot;ops&quot;
        &#125;
    ],
    &quot;ca&quot;: &#123;
        &quot;expiry&quot;: &quot;175200h&quot;
    &#125;
&#125;

附：
    CN：机构名称，浏览器使用该字段验证网站是否合法，一般写的是域名。
    algo：算法
    size：长度
    C：国家
    ST：州、省
    L：地址、城市
    O：组织名称、公司名称
    OU：组织单位名称、公司部门
    expiry：过期时间
</code></pre>
<p><img src="/2021/02/18/K8S-Binary-Install/11.png"></p>
<h3 id="5、签证书，需要到-x2F-opt-x2F-certs目录下"><a href="#5、签证书，需要到-x2F-opt-x2F-certs目录下" class="headerlink" title="5、签证书，需要到&#x2F;opt&#x2F;certs目录下"></a>5、签证书，需要到&#x2F;opt&#x2F;certs目录下</h3><pre><code>cd /opt/certscfssl gencert -initca /opt/certs/ca-csr.json  | cfssl-json -bare ca
</code></pre>
<p><img src="/2021/02/18/K8S-Binary-Install/12.png"></p>
<h2 id="四、K8S几台机器安装Docker-CE环境"><a href="#四、K8S几台机器安装Docker-CE环境" class="headerlink" title="四、K8S几台机器安装Docker-CE环境"></a>四、K8S几台机器安装Docker-CE环境</h2><p>需要安装docker-ce的主机分别为：node1，node2，node3，warehouse</p>
<h3 id="1、Docker官网的脚本命令（当然也可以使用别的方法-需要装的是Docker-CE）"><a href="#1、Docker官网的脚本命令（当然也可以使用别的方法-需要装的是Docker-CE）" class="headerlink" title="1、Docker官网的脚本命令（当然也可以使用别的方法,需要装的是Docker-CE）"></a>1、Docker官网的脚本命令（当然也可以使用别的方法,需要装的是Docker-CE）</h3><pre><code>curl -fsSL https://get.docker.com | bash -s docker --mirror Aliyun
</code></pre>
<h3 id="2、创建-x2F-etc-x2F-docker-x2F-daemon-json配置文件，若没有该文件即目录，则手动创建"><a href="#2、创建-x2F-etc-x2F-docker-x2F-daemon-json配置文件，若没有该文件即目录，则手动创建" class="headerlink" title="2、创建&#x2F;etc&#x2F;docker&#x2F;daemon.json配置文件，若没有该文件即目录，则手动创建"></a>2、创建&#x2F;etc&#x2F;docker&#x2F;daemon.json配置文件，若没有该文件即目录，则手动创建</h3><pre><code>&#123;
 &quot;graph&quot;: &quot;/data/docker&quot;,
 &quot;storage-driver&quot;: &quot;overlay2&quot;,
 &quot;insecure-registries&quot;: [&quot;registry.access.redhat.com&quot;,&quot;quay.io&quot;,&quot;harbor.example.com&quot;],
 &quot;registry-mirrors&quot;: [&quot;https://docker.mirrors.ustc.edu.cn&quot;,&quot;http://hub-mirror.c.163.com&quot;],
 &quot;bip&quot;: &quot;172.7.40.1/24&quot;,
 &quot;exec-opts&quot;: [&quot;native.cgroupdriver=systemd&quot;],
 &quot;live-restore&quot;: true
&#125;
</code></pre>
<p>docker-daemon.json各配置详解<br>该文件作为 Docker Engine 的配置管理文件, 里面几乎涵盖了所有 docker 命令行启动可以配置的参数。<br>不管是在哪个平台以何种方式启动, Docker 默认都会来这里读取配置。使用户可以统一管理不同系统下的 docker daemon 配置。<br>相关参数的使用说明，可以参阅 man dockerd 帮助信息，或者参阅官方文档。</p>
<pre><code>docker-daemon.json各配置详解
&#123;
    “api-cors-header”:&quot;&quot;, ——————在引擎API中设置CORS标头
    “authorization-plugins”:[], ——————要加载的授权插件
    “bridge”:&quot;&quot;, ————将容器附加到网桥
    “cgroup-parent”:&quot;&quot;, ——————为所有容器设置父cgroup
    “cluster-store”:&quot;&quot;, ——————分布式存储后端的URL
    “cluster-store-opts”:&#123;&#125;, ————————设置集群存储选项（默认map []）
    “cluster-advertise”:&quot;&quot;, ————————要通告的地址或接口名称
    “debug”: true, ————————启用调试模式，启用后，可以看到很多的启动信息。默认false
    “default-gateway”:&quot;&quot;, ——————容器默认网关IPv4地址
    “default-gateway-v6”:&quot;&quot;, ——————容器默认网关IPv6地址
    “default-runtime”:“runc”, ————————容器的默认OCI运行时（默认为“ runc”）
    “default-ulimits”:&#123;&#125;, ——————容器的默认ulimit（默认[]）
    “dns”: [“192.168.1.1”], ——————设定容器DNS的地址，在容器的 /etc/resolv.conf文件中可查看。
    “dns-opts”: [], ————————容器 /etc/resolv.conf 文件，其他设置
    “dns-search”: [], ————————设定容器的搜索域，当设定搜索域为 .example.com 时，在搜索一个名为 host 的 主机时，DNS不仅搜索host，还会搜
    索host.example.com 。 注意：如果不设置， Docker 会默认用主机上的 /etc/resolv.conf 来配置容器。
    “exec-opts”: [], ————————运行时执行选项
    “exec-root”:&quot;&quot;, ————————执行状态文件的根目录（默认为’/var/run/docker‘）
    “fixed-cidr”:&quot;&quot;, ————————固定IP的IPv4子网
    “fixed-cidr-v6”:&quot;&quot;, ————————固定IP的IPv6子网
    “data-root”:&quot;/var/lib/docker&quot;, ————-Docker运行时使用的根路径，默认/var/lib/docker
    “group”: “”, ——————UNIX套接字的组（默认为“docker”）
    “hosts”: [], ——————设置容器hosts
    “icc”: false, ——————启用容器间通信（默认为true）
    “ip”:“0.0.0.0”, ————————绑定容器端口时的默认IP（默认0.0.0.0）
    “iptables”: false, ———————启用iptables规则添加（默认为true）
    “ipv6”: false, ——————启用IPv6网络
    “ip-forward”: false, ————————默认true, 启用 net.ipv4.ip_forward ,进入容器后使用 sysctl -a | grepnet.ipv4.ip_forward 查看
    “ip-masq”:false, ——————启用IP伪装（默认为true）
    “labels”:[“nodeName=node-121”], ————————docker主机的标签，很实用的功能,例如定义：–label nodeName=host-121
    “live-restore”: true, ——————在容器仍在运行时启用docker的实时还原
    “log-driver”:&quot;&quot;, ——————容器日志的默认驱动程序（默认为“ json-file”）
    “log-level”:&quot;&quot;, ——————设置日志记录级别（“调试”，“信息”，“警告”，“错误”，“致命”）（默认为“信息”）
    “max-concurrent-downloads”:3, ——————设置每个请求的最大并发下载量（默认为3）
    “max-concurrent-uploads”:5, ——————设置每次推送的最大同时上传数（默认为5）
    “mtu”: 0, ——————设置容器网络MTU
    “oom-score-adjust”:-500, ——————设置守护程序的oom_score_adj（默认值为-500）
    “pidfile”: “”, ——————Docker守护进程的PID文件
    “raw-logs”: false, ——————全时间戳机制
    “selinux-enabled”: false, ——————默认 false，启用selinux支持
    “storage-driver”:&quot;&quot;, ——————要使用的存储驱动程序
    “swarm-default-advertise-addr”:&quot;&quot;, ——————设置默认地址或群集广告地址的接口
    “tls”: true, ————————默认 false, 启动TLS认证开关
    “tlscacert”: “”, ——————默认 ~/.docker/ca.pem，通过CA认证过的的certificate文件路径
    “tlscert”: “”, ————————默认 ~/.docker/cert.pem ，TLS的certificate文件路径
    “tlskey”: “”, ————————默认~/.docker/key.pem，TLS的key文件路径
    “tlsverify”: true, ————————默认false，使用TLS并做后台进程与客户端通讯的验证
    “userland-proxy”:false, ——————使用userland代理进行环回流量（默认为true）
    “userns-remap”:&quot;&quot;, ————————用户名称空间的用户/组设置
    “bip”:“192.168.88.0/22”, ——————————指定网桥IP
    “registry-mirrors”: [“https://192.498.89.232:89”], ————————设置镜像加速
    “insecure-registries”: [“120.123.122.123:12312”], ———————设置私有仓库地址可以设为http
    “storage-opts”: [
    “overlay2.override_kernel_check=true”,
    “overlay2.size=15G”
    ], ————————存储驱动程序选项
    “log-opts”: &#123;
    “max-file”: “3”,
    “max-size”: “10m”,
    &#125;, ————————容器默认日志驱动程序选项
    “iptables”: false ————————启用iptables规则添加（默认为true）
&#125;
</code></pre>
<p><img src="/2021/02/18/K8S-Binary-Install/13.png"></p>
<p><label style="color: red"><strong>注：我的bip的命名规则为：主机ip的最后一位若为11的话，则bip为172.7.21.1&#x2F;24。<br>harbor.example.com 为我后期要配置的私有镜像仓库。</strong></label></p>
<h3 id="3、创建-x2F-data-x2F-docker目录"><a href="#3、创建-x2F-data-x2F-docker目录" class="headerlink" title="3、创建&#x2F;data&#x2F;docker目录"></a>3、创建&#x2F;data&#x2F;docker目录</h3><pre><code>mkdir -p /data/docker
</code></pre>
<h3 id="4、重启docker服务"><a href="#4、重启docker服务" class="headerlink" title="4、重启docker服务"></a>4、重启docker服务</h3><pre><code>systemctl restart docker
</code></pre>
<h2 id="五、在Warehouse上搭建私有镜像仓库"><a href="#五、在Warehouse上搭建私有镜像仓库" class="headerlink" title="五、在Warehouse上搭建私有镜像仓库"></a>五、在Warehouse上搭建私有镜像仓库</h2><p>harbor官方github地址：<a target="_blank" rel="noopener" href="https://github.com/goharbor/harbor">https://github.com/goharbor/harbor</a><br>我这边已经下载离线包：harbor-offline-installer-v2.0.6.tgz</p>
<h3 id="1、将harbor包放在opt目录下"><a href="#1、将harbor包放在opt目录下" class="headerlink" title="1、将harbor包放在opt目录下"></a>1、将harbor包放在opt目录下</h3><pre><code>cp harbor-offline-installer-v2.0.6.tgz /opt/
</code></pre>
<h3 id="2、解压harbor包"><a href="#2、解压harbor包" class="headerlink" title="2、解压harbor包"></a>2、解压harbor包</h3><pre><code>tar vxf harbor-offline-installer-v2.0.6.tgz
</code></pre>
<h3 id="3、harbor目录改名"><a href="#3、harbor目录改名" class="headerlink" title="3、harbor目录改名"></a>3、harbor目录改名</h3><pre><code>mv harbor harbor-2.0.6
</code></pre>
<h3 id="4、创建harbor软链接"><a href="#4、创建harbor软链接" class="headerlink" title="4、创建harbor软链接"></a>4、创建harbor软链接</h3><pre><code>ln -s /opt/harbor-2.0.6/ /opt/harbor
</code></pre>
<p><label style="color: red"><strong>注：在生产上一般用软连接去管理不同版本的软件包，这是个非常常用的方式</strong></label></p>
<h3 id="5、复制配置文件harbor-yml"><a href="#5、复制配置文件harbor-yml" class="headerlink" title="5、复制配置文件harbor.yml"></a>5、复制配置文件harbor.yml</h3><pre><code>cp harbor.yml.tmpl  harbor.yml
</code></pre>
<h3 id="6、编辑barbor-yml配置文件"><a href="#6、编辑barbor-yml配置文件" class="headerlink" title="6、编辑barbor.yml配置文件"></a>6、编辑barbor.yml配置文件</h3><pre><code>hostname: harbor.example.com
http:
  port: 180
harbor_admin_password: Harbor12345
database:
  password: root123
  max_idle_conns: 50
  max_open_conns: 1000
data_volume: /data/harbor
clair:
  updaters_interval: 12
trivy:
  ignore_unfixed: false
  skip_update: false
  insecure: false
jobservice:
  max_job_workers: 10
notification:
  webhook_job_max_retry: 10
chart:
  absolute_url: disabled
log:
  level: info
  local:
    rotate_count: 50
    rotate_size: 200M
    location: /data/harbor/logs
_version: 2.0.0
proxy:
  http_proxy:
  https_proxy:
  no_proxy:
  components:
    - core
    - jobservice
    - clair
    - trivy
</code></pre>
<p><img src="/2021/02/18/K8S-Binary-Install/14.png"></p>
<p><label style="color: red"><strong>注：这边使用的是180端口，由于后期要用nginx反代。</strong></label></p>
<h3 id="7、创建安装目录"><a href="#7、创建安装目录" class="headerlink" title="7、创建安装目录"></a>7、创建安装目录</h3><pre><code>mkdir /data/harbor/logs -p
</code></pre>
<h3 id="8、安装docker-compose"><a href="#8、安装docker-compose" class="headerlink" title="8、安装docker-compose"></a>8、安装docker-compose</h3><pre><code>yum install docker-compose -y
</code></pre>
<p><label style="color: red"><strong>注：由于harbor本身是一个单机编排的软件，所以它依赖docker-compose</strong></label></p>
<h3 id="9、执行harbor的install-sh安装脚本"><a href="#9、执行harbor的install-sh安装脚本" class="headerlink" title="9、执行harbor的install.sh安装脚本"></a>9、执行harbor的install.sh安装脚本</h3><pre><code>./install.sh
</code></pre>
<p><img src="/2021/02/18/K8S-Binary-Install/15.png"></p>
<p><label style="color: red"><strong>注：这边你可以看到harbor依赖的软件包</strong></label></p>
<h3 id="10、docker-ps查看"><a href="#10、docker-ps查看" class="headerlink" title="10、docker ps查看"></a>10、docker ps查看</h3><p><img src="/2021/02/18/K8S-Binary-Install/16.png"></p>
<h3 id="11、安装nginx"><a href="#11、安装nginx" class="headerlink" title="11、安装nginx"></a>11、安装nginx</h3><pre><code>yum install nginx -y
</code></pre>
<h3 id="12、配置nginx配置文件-x2F-etc-x2F-nginx-x2F-conf-d-x2F-harbor-example-com-conf"><a href="#12、配置nginx配置文件-x2F-etc-x2F-nginx-x2F-conf-d-x2F-harbor-example-com-conf" class="headerlink" title="12、配置nginx配置文件&#x2F;etc&#x2F;nginx&#x2F;conf.d&#x2F;harbor.example.com.conf"></a>12、配置nginx配置文件&#x2F;etc&#x2F;nginx&#x2F;conf.d&#x2F;harbor.example.com.conf</h3><pre><code>server &#123;
        listen                  80;
        server_name             harbor.example.com;
        client_max_body_size    1000m;
        location / &#123;
                proxy_pass http://127.0.0.1:180;
        &#125;
&#125;
</code></pre>
<h3 id="13、启动nginx"><a href="#13、启动nginx" class="headerlink" title="13、启动nginx"></a>13、启动nginx</h3><pre><code>systemctl start nginx
systemctl enable nginx
</code></pre>
<h3 id="14、配置DNS服务器，将harbor业务域加入进去"><a href="#14、配置DNS服务器，将harbor业务域加入进去" class="headerlink" title="14、配置DNS服务器，将harbor业务域加入进去"></a>14、配置DNS服务器，将harbor业务域加入进去</h3><pre><code>vim /var/named/example.com.zone
</code></pre>
<p><img src="/2021/02/18/K8S-Binary-Install/17.png"></p>
<p><label style="color: red"><strong>注：example.com.zone为我这边环境的业务域，要手动serial前滚一个序号！！！！</strong></label></p>
<h3 id="15、重启DNS服务器"><a href="#15、重启DNS服务器" class="headerlink" title="15、重启DNS服务器"></a>15、重启DNS服务器</h3><pre><code>systemctl restart named
</code></pre>
<h3 id="16、用浏览器打开harbor-example-com-打开网站的主机要配置对应的DNS服务器"><a href="#16、用浏览器打开harbor-example-com-打开网站的主机要配置对应的DNS服务器" class="headerlink" title="16、用浏览器打开harbor.example.com (打开网站的主机要配置对应的DNS服务器)"></a>16、用浏览器打开harbor.example.com (打开网站的主机要配置对应的DNS服务器)</h3><p><img src="/2021/02/18/K8S-Binary-Install/18.png"></p>
<p>账号为：admin，密码：Harbor12345<br>密码为之前安装时的harbor.yml配置文件配置的密码。</p>
<h3 id="17、创建一个public项目"><a href="#17、创建一个public项目" class="headerlink" title="17、创建一个public项目"></a>17、创建一个public项目</h3><p><img src="/2021/02/18/K8S-Binary-Install/19.png"></p>
<h3 id="18、pull一个nginx镜像"><a href="#18、pull一个nginx镜像" class="headerlink" title="18、pull一个nginx镜像"></a>18、pull一个nginx镜像</h3><pre><code>docker pull nginx
</code></pre>
<h3 id="19、给这个镜像打标签"><a href="#19、给这个镜像打标签" class="headerlink" title="19、给这个镜像打标签"></a>19、给这个镜像打标签</h3><pre><code>docker tag f6d0b4767a6c harbor.example.com/public/nginx:latest
</code></pre>
<h3 id="20、docker-login登录harbor私有仓库"><a href="#20、docker-login登录harbor私有仓库" class="headerlink" title="20、docker login登录harbor私有仓库"></a>20、docker login登录harbor私有仓库</h3><pre><code>docker login harbor.example.com
</code></pre>
<p><img src="/2021/02/18/K8S-Binary-Install/20.png"></p>
<h3 id="21、将之前打标签的镜像传到私有仓库上"><a href="#21、将之前打标签的镜像传到私有仓库上" class="headerlink" title="21、将之前打标签的镜像传到私有仓库上"></a>21、将之前打标签的镜像传到私有仓库上</h3><pre><code>docker push harbor.example.com/public/nginx
</code></pre>
<p><img src="/2021/02/18/K8S-Binary-Install/21.png"></p>
<h3 id="22、在web端查看，确认是否已经上传"><a href="#22、在web端查看，确认是否已经上传" class="headerlink" title="22、在web端查看，确认是否已经上传"></a>22、在web端查看，确认是否已经上传</h3><p><img src="/2021/02/18/K8S-Binary-Install/22.png"></p>
<h2 id="六、正式搭建K8S"><a href="#六、正式搭建K8S" class="headerlink" title="六、正式搭建K8S"></a>六、正式搭建K8S</h2><h2 id="安装etcd"><a href="#安装etcd" class="headerlink" title="安装etcd"></a>安装etcd</h2><p><label style="color: red"><strong>以下操作在CFSS证书服务器上</strong></label></p>
<h3 id="1、CFSS上配置证书配置文件，-x2F-opt-x2F-certs目录下创建以下配置文件ca-config-json"><a href="#1、CFSS上配置证书配置文件，-x2F-opt-x2F-certs目录下创建以下配置文件ca-config-json" class="headerlink" title="1、CFSS上配置证书配置文件，&#x2F;opt&#x2F;certs目录下创建以下配置文件ca-config.json"></a>1、CFSS上配置证书配置文件，&#x2F;opt&#x2F;certs目录下创建以下配置文件ca-config.json</h3><pre><code>vim /opt/certs/ca-config.json

&#123;
    &quot;signing&quot;: &#123;
        &quot;default&quot;: &#123;
            &quot;expiry&quot;: &quot;175200h&quot;
        &#125;,
        &quot;profiles&quot;: &#123;
            &quot;server&quot;: &#123;
                &quot;expiry&quot;: &quot;175200h&quot;,
                &quot;usages&quot;: [
                    &quot;signing&quot;,
                    &quot;key encipherment&quot;,
                    &quot;server auth&quot;
                ]
            &#125;,
            &quot;client&quot;: &#123;
                &quot;expiry&quot;: &quot;175200h&quot;,
                &quot;usages&quot;: [
                    &quot;signing&quot;,
                    &quot;key encipherment&quot;,
                    &quot;client auth&quot;
                ]
            &#125;,
            &quot;peer&quot;: &#123;
                &quot;expiry&quot;: &quot;175200h&quot;,
                &quot;usages&quot;: [
                    &quot;signing&quot;,
                    &quot;key encipherment&quot;,
                    &quot;server auth&quot;,
                    &quot;client auth&quot;
                ]
            &#125;
        &#125;
    &#125;
&#125;
</code></pre>
<p><img src="/2021/02/18/K8S-Binary-Install/23.png"></p>
<h3 id="2、创建etcd证书请求文件，在-x2F-opt-x2F-certs目录下创建以下配置文件etcd-peer-csr-json"><a href="#2、创建etcd证书请求文件，在-x2F-opt-x2F-certs目录下创建以下配置文件etcd-peer-csr-json" class="headerlink" title="2、创建etcd证书请求文件，在&#x2F;opt&#x2F;certs目录下创建以下配置文件etcd-peer-csr.json"></a>2、创建etcd证书请求文件，在&#x2F;opt&#x2F;certs目录下创建以下配置文件etcd-peer-csr.json</h3><pre><code>vim /opt/certs/etcd-peer-csr.json

&#123;
    &quot;CN&quot;: &quot;k8s-etcd&quot;,
    &quot;hosts&quot;: [
        &quot;192.168.10.11&quot;,
        &quot;192.168.10.12&quot;,
        &quot;192.168.10.13&quot;,
        &quot;192.168.10.21&quot;,
        &quot;192.168.10.22&quot;,
        &quot;192.168.10.23&quot;
    ],
    &quot;key&quot;: &#123;
        &quot;algo&quot;: &quot;rsa&quot;,
        &quot;size&quot;: 2048
    &#125;,
    &quot;names&quot;: [
        &#123;
            &quot;C&quot;: &quot;CN&quot;,
            &quot;ST&quot;: &quot;beijing&quot;,
            &quot;L&quot;: &quot;beijing&quot;,
            &quot;O&quot;: &quot;example&quot;,
            &quot;OU&quot;: &quot;ops&quot;
        &#125;
    ]
&#125;
</code></pre>
<p><img src="/2021/02/18/K8S-Binary-Install/24.png"></p>
<p><label style="color: red"><strong>注：hosts段中在生产环境中，将所有有可能部署的IP地址都添加进去。hosts只能使用IP，不能使用网段。</strong></label></p>
<h3 id="3、开始签发etcd的证书"><a href="#3、开始签发etcd的证书" class="headerlink" title="3、开始签发etcd的证书"></a>3、开始签发etcd的证书</h3><pre><code>cfssl gencert -ca=ca.pem -ca-key=ca-key.pem -config=ca-config.json -profile=peer etcd-peer-csr.json | cfssl-json -bare etcd-peer
</code></pre>
<p><img src="/2021/02/18/K8S-Binary-Install/25.png"></p>
<p><img src="/2021/02/18/K8S-Binary-Install/26.png"></p>
<p><label style="color: red"><strong>以下操作在node1，node2，node3节点操作</strong></label></p>
<h3 id="4、在master节点上创建etcd用户"><a href="#4、在master节点上创建etcd用户" class="headerlink" title="4、在master节点上创建etcd用户"></a>4、在master节点上创建etcd用户</h3><pre><code>useradd -s /sbin/nologin -M etcd
</code></pre>
<p><img src="/2021/02/18/K8S-Binary-Install/27.png"></p>
<h3 id="5、下载etcd软件"><a href="#5、下载etcd软件" class="headerlink" title="5、下载etcd软件"></a>5、下载etcd软件</h3><p>GitHub地址：<a target="_blank" rel="noopener" href="https://github.com/etcd-io/etcd">https://github.com/etcd-io/etcd</a><br>我这边下载的是：etcd-v3.4.14-linux-amd64.tar.gz</p>
<h3 id="6、解压、重命名、软连接"><a href="#6、解压、重命名、软连接" class="headerlink" title="6、解压、重命名、软连接"></a>6、解压、重命名、软连接</h3><pre><code>tar vxf etcd-v3.4.14-linux-amd64.tar.gz -C /opt
mv etcd-v3.4.14-linux-amd64 etcd-v3.4.14
ln -s etcd-v3.4.14 etcd
</code></pre>
<h3 id="7、创建etcd目录及证书目录"><a href="#7、创建etcd目录及证书目录" class="headerlink" title="7、创建etcd目录及证书目录"></a>7、创建etcd目录及证书目录</h3><pre><code>mkdir -p /opt/etcd/certs /data/etcd /data/logs/etcd-server
chown -R etcd.etcd /data/logs/etcd-server/
</code></pre>
<h3 id="8、将CFSS证书服务器上的证书和私钥复制到-x2F-opt-x2F-etcd-x2F-certs目录"><a href="#8、将CFSS证书服务器上的证书和私钥复制到-x2F-opt-x2F-etcd-x2F-certs目录" class="headerlink" title="8、将CFSS证书服务器上的证书和私钥复制到&#x2F;opt&#x2F;etcd&#x2F;certs目录"></a>8、将CFSS证书服务器上的证书和私钥复制到&#x2F;opt&#x2F;etcd&#x2F;certs目录</h3><pre><code>ca.pem,etcd-peer-key.pem,etcd-peer.pem
</code></pre>
<p><label style="color: red"><strong>注：etcd-peer-key.pem为私钥，其他两个是证书，私钥是不能给别人看的需要保密。密钥文件的权限为600</strong></label></p>
<h3 id="9、配置etcd-的启动脚本etcd-server-startup-sh"><a href="#9、配置etcd-的启动脚本etcd-server-startup-sh" class="headerlink" title="9、配置etcd 的启动脚本etcd-server-startup.sh"></a>9、配置etcd 的启动脚本etcd-server-startup.sh</h3><p>10-21服务器启动脚本</p>
<pre><code>#!/bin/sh
./etcd --name etcd-server-10-21 \
       --data-dir /data/etcd/etcd-server \
       --listen-peer-urls https://192.168.10.21:2380 \
       --listen-client-urls https://192.168.10.21:2379,http://127.0.0.1:2379 \
       --quota-backend-bytes 8000000000 \
       --initial-advertise-peer-urls https://192.168.10.21:2380 \
       --advertise-client-urls https://192.168.10.21:2379,http://127.0.0.1:2379 \
       --initial-cluster  etcd-server-10-21=https://192.168.10.21:2380,etcd-server-10-22=https://192.168.10.22:2380,etcd-server-10-23=https://192.168.10.23:2380 \
       --cert-file ./certs/etcd-peer.pem \
       --key-file ./certs/etcd-peer-key.pem \
       --client-cert-auth  \
       --trusted-ca-file ./certs/ca.pem \
       --peer-cert-file ./certs/etcd-peer.pem \
       --peer-key-file ./certs/etcd-peer-key.pem \
       --peer-client-cert-auth \
       --peer-trusted-ca-file ./certs/ca.pem \
       --log-output stdout
</code></pre>
<p>10-22服务器配置文件</p>
<pre><code>#!/bin/sh
./etcd --name etcd-server-10-22 \
       --data-dir /data/etcd/etcd-server \
       --listen-peer-urls https://192.168.10.22:2380 \
       --listen-client-urls https://192.168.10.22:2379,http://127.0.0.1:2379 \
       --quota-backend-bytes 8000000000 \
       --initial-advertise-peer-urls https://192.168.10.22:2380 \
       --advertise-client-urls https://192.168.10.22:2379,http://127.0.0.1:2379 \
       --initial-cluster  etcd-server-10-21=https://192.168.10.21:2380,etcd-server-10-22=https://192.168.10.22:2380,etcd-server-10-23=https://192.168.10.23:2380 \
       --cert-file ./certs/etcd-peer.pem \
       --key-file ./certs/etcd-peer-key.pem \
       --client-cert-auth  \
       --trusted-ca-file ./certs/ca.pem \
       --peer-cert-file ./certs/etcd-peer.pem \
       --peer-key-file ./certs/etcd-peer-key.pem \
       --peer-client-cert-auth \
       --peer-trusted-ca-file ./certs/ca.pem \
       --log-output stdout
</code></pre>
<p>10-23服务器配置文件</p>
<pre><code>#!/bin/sh
./etcd --name etcd-server-10-23 \
       --data-dir /data/etcd/etcd-server \
       --listen-peer-urls https://192.168.10.23:2380 \
       --listen-client-urls https://192.168.10.23:2379,http://127.0.0.1:2379 \
       --quota-backend-bytes 8000000000 \
       --initial-advertise-peer-urls https://192.168.10.23:2380 \
       --advertise-client-urls https://192.168.10.23:2379,http://127.0.0.1:2379 \
       --initial-cluster  etcd-server-10-21=https://192.168.10.21:2380,etcd-server-10-22=https://192.168.10.22:2380,etcd-server-10-23=https://192.168.10.23:2380 \
       --cert-file ./certs/etcd-peer.pem \
       --key-file ./certs/etcd-peer-key.pem \
       --client-cert-auth  \
       --trusted-ca-file ./certs/ca.pem \
       --peer-cert-file ./certs/etcd-peer.pem \
       --peer-key-file ./certs/etcd-peer-key.pem \
       --peer-client-cert-auth \
       --peer-trusted-ca-file ./certs/ca.pem \
       --log-output stdout


配置文件的不同处：
    --name
    --listen-peer-urls
    --listen-client-urls
    --initial-advertise-peer-urls
    --advertise-client-urls
</code></pre>
<p><label style="color: red"><strong>注：这边etcd的命名规则为IP后两位，各个版本的etcd的启动参数不同，请查看具体版本的etcd启动参数。其他的几个需要安装etcd的主机只需要稍微修改IP和名称一下就可以了。</strong></label></p>
<h3 id="10、配置属主属组和启动脚本执行权限"><a href="#10、配置属主属组和启动脚本执行权限" class="headerlink" title="10、配置属主属组和启动脚本执行权限"></a>10、配置属主属组和启动脚本执行权限</h3><pre><code>chown -R etcd.etcd /opt/etcd-v3.4.14/
chown -R etcd.etcd /data/etcd
chmod +x /opt/etcd/etcd-server-startup.sh
</code></pre>
<h3 id="11、安装supervisor管理启动脚本"><a href="#11、安装supervisor管理启动脚本" class="headerlink" title="11、安装supervisor管理启动脚本"></a>11、安装supervisor管理启动脚本</h3><pre><code>yum install supervisor -y
systemctl start supervisord
systemctl enable supervisord
</code></pre>
<h3 id="12、配置的etcd-supervisor的ini配置文件-x2F-etc-x2F-supervisord-d-x2F-etcd-server-ini"><a href="#12、配置的etcd-supervisor的ini配置文件-x2F-etc-x2F-supervisord-d-x2F-etcd-server-ini" class="headerlink" title="12、配置的etcd supervisor的ini配置文件&#x2F;etc&#x2F;supervisord.d&#x2F;etcd-server.ini"></a>12、配置的etcd supervisor的ini配置文件&#x2F;etc&#x2F;supervisord.d&#x2F;etcd-server.ini</h3><pre><code>[program:etcd-server-10-21]
command=/opt/etcd/etcd-server-startup.sh                        ; the program (relative uses PATH, can take args)
numprocs=1                                                      ; number of processes copies to start (def 1)
directory=/opt/etcd                                             ; directory to cwd to before exec (def no cwd)
autostart=true                                                  ; start at supervisord start (default: true)
autorestart=true                                                ; retstart at unexpected quit (default: true)
startsecs=30                                                    ; number of secs prog must stay running (def. 1)
startretries=3                                                  ; max # of serial start failures (default 3)
exitcodes=0,2                                                   ; &#39;expected&#39; exit codes for process (default 0,2)
stopsignal=QUIT                                                 ; signal used to kill process (default TERM)
stopwaitsecs=10                                                 ; max num secs to wait b4 SIGKILL (default 10)
user=etcd                                                       ; setuid to this UNIX account to run the program
redirect_stderr=true                                            ; redirect proc stderr to stdout (default false)
stdout_logfile=/data/logs/etcd-server/etcd.stdout.log           ; stdout log path, NONE for none; default AUTO
stdout_logfile_maxbytes=64MB                                    ; max # logfile bytes b4 rotation (default 50MB)
stdout_logfile_backups=4                                        ; # of stdout logfile backups (default 10)
stdout_capture_maxbytes=1MB                                     ; number of bytes in &#39;capturemode&#39; (default 0)
stdout_events_enabled=false                                     ; emit events on stdout writes (default false)
</code></pre>
<p><img src="/2021/02/18/K8S-Binary-Install/28.png"></p>
<h3 id="13、启动etcd服务并检查"><a href="#13、启动etcd服务并检查" class="headerlink" title="13、启动etcd服务并检查"></a>13、启动etcd服务并检查</h3><pre><code>supervisorctl update
supervisorctl status
</code></pre>
<h3 id="14、启动或者关闭etcd服务"><a href="#14、启动或者关闭etcd服务" class="headerlink" title="14、启动或者关闭etcd服务"></a>14、启动或者关闭etcd服务</h3><pre><code>supervisorctl start etcd-server-10-21
supervisorctl stop etcd-server-10-21
</code></pre>
<h3 id="15、检查etcd是否健康"><a href="#15、检查etcd是否健康" class="headerlink" title="15、检查etcd是否健康"></a>15、检查etcd是否健康</h3><pre><code>./etcdctl --endpoints=https://192.168.10.21:2379 --cacert=/opt/etcd/certs/ca.pem --cert=/opt/etcd/certs/etcd-peer.pem --key=/opt/etcd/certs/etcd-peer-key.pem endpoint health
</code></pre>
<p><img src="/2021/02/18/K8S-Binary-Install/29.png"></p>
<p><label style="color: red"><strong>注： 输出均为 <code>healthy</code> 时表示集群服务正常</strong></label></p>
<h3 id="16、查看当前leader"><a href="#16、查看当前leader" class="headerlink" title="16、查看当前leader"></a>16、查看当前leader</h3><pre><code>./etcdctl  --cacert=/opt/etcd/certs/ca.pem --cert=/opt/etcd/certs/etcd-peer.pem --key=/opt/etcd/certs/etcd-peer-key.pem --endpoints=&quot;https://192.168.10.21:2379,https://192.168.10.22:2379,https://192.168.10.23:2379&quot;   endpoint status
</code></pre>
<p><img src="/2021/02/18/K8S-Binary-Install/30.png"></p>
<h3 id="17、若想移交leader"><a href="#17、若想移交leader" class="headerlink" title="17、若想移交leader"></a>17、若想移交leader</h3><pre><code>./etcdctl  --cacert=/opt/etcd/certs/ca.pem --cert=/opt/etcd/certs/etcd-peer.pem --key=/opt/etcd/certs/etcd-peer-key.pem --endpoints=&quot;https://192.168.10.21:2379,https://192.168.10.22:2379,https://192.168.10.23:2379&quot;   move-leader 22f15f5d46aec4a0

./etcdctl  --cacert=/opt/etcd/certs/ca.pem --cert=/opt/etcd/certs/etcd-peer.pem --key=/opt/etcd/certs/etcd-peer-key.pem --endpoints=&quot;https://192.168.10.21:2379,https://192.168.10.22:2379,https://192.168.10.23:2379&quot;   endpoint status
</code></pre>
<p><img src="/2021/02/18/K8S-Binary-Install/31.png"></p>
<h2 id="安装apiserver"><a href="#安装apiserver" class="headerlink" title="安装apiserver"></a>安装apiserver</h2><p>GIT官方地址：<a target="_blank" rel="noopener" href="https://github.com/kubernetes/kubernetes">https://github.com/kubernetes/kubernetes</a><br>我这边下载的是 kubernetes-server-linux-amd64.tar.gz，这边我用的版本是1.15.12</p>
<h3 id="1、解压kubernetes"><a href="#1、解压kubernetes" class="headerlink" title="1、解压kubernetes"></a>1、解压kubernetes</h3><pre><code>tar -vxf kubernetes-server-linux-amd64.tar.gz - C /opt
</code></pre>
<h3 id="2、查看解压后server目录下的文件"><a href="#2、查看解压后server目录下的文件" class="headerlink" title="2、查看解压后server目录下的文件"></a>2、查看解压后server目录下的文件</h3><p><img src="/2021/02/18/K8S-Binary-Install/32.png"></p>
<p><label style="color: red"><strong>注：我这边删除一些不必要的文件只留下了可执行二进制文件</strong></label></p>
<h3 id="3、创建certs、conf目录"><a href="#3、创建certs、conf目录" class="headerlink" title="3、创建certs、conf目录"></a>3、创建certs、conf目录</h3><pre><code>mkdir /opt/kubernetes/server/bin/certs  /opt/kubernetes/server/bin/conf
</code></pre>
<p><label style="color: red"><strong>以下操作在CFSSL证书服务其上操作</strong></label></p>
<h3 id="4、生成证书csr的json配置文件"><a href="#4、生成证书csr的json配置文件" class="headerlink" title="4、生成证书csr的json配置文件"></a>4、生成证书csr的json配置文件</h3><pre><code>vim /opt/certs/client-csr.json

&#123;
    &quot;CN&quot;: &quot;k8s-node&quot;,
    &quot;hosts&quot;: [
    ],
    &quot;key&quot;: &#123;
        &quot;algo&quot;: &quot;rsa&quot;,
        &quot;size&quot;: 2048
    &#125;,
    &quot;names&quot;: [
        &#123;
            &quot;C&quot;: &quot;CN&quot;,
            &quot;ST&quot;: &quot;beijing&quot;,
            &quot;L&quot;: &quot;beijing&quot;,
            &quot;O&quot;: &quot;example&quot;,
            &quot;OU&quot;: &quot;ops&quot;
        &#125;
    ]
&#125;
</code></pre>
<h3 id="5、生成client证书文件"><a href="#5、生成client证书文件" class="headerlink" title="5、生成client证书文件"></a>5、生成client证书文件</h3><pre><code>cfssl gencert -ca=ca.pem -ca-key=ca-key.pem -config=ca-config.json -profile=client client-csr.json |cfssl-json -bare client
</code></pre>
<h3 id="6、配置kube-apiserver证书csr的json配置文件"><a href="#6、配置kube-apiserver证书csr的json配置文件" class="headerlink" title="6、配置kube-apiserver证书csr的json配置文件"></a>6、配置kube-apiserver证书csr的json配置文件</h3><pre><code>vi /opt/certs/apiserver-csr.json

&#123;
    &quot;CN&quot;: &quot;k8s-apiserver&quot;,
    &quot;hosts&quot;: [
        &quot;127.0.0.1&quot;,
        &quot;192.168.0.1&quot;,
        &quot;kubernetes.default&quot;,
        &quot;kubernetes.default.svc&quot;,
        &quot;kubernetes.default.svc.cluster&quot;,
        &quot;kubernetes.default.svc.cluster.local&quot;,
        &quot;sevattal-11.host.com&quot;,
        &quot;sevattal-12.host.com&quot;,
        &quot;sevattal-13.host.com&quot;,
        &quot;sevattal-21.host.com&quot;,
        &quot;sevattal-22.host.com&quot;,
        &quot;sevattal-23.host.com&quot;,
        &quot;192.168.10.10&quot;,
        &quot;192.168.10.11&quot;,
        &quot;192.168.10.12&quot;,
        &quot;192.168.10.13&quot;,
        &quot;192.168.10.21&quot;,
        &quot;192.168.10.22&quot;,
        &quot;192.168.10.23&quot;
    ],
    &quot;key&quot;: &#123;
        &quot;algo&quot;: &quot;rsa&quot;,
        &quot;size&quot;: 2048
    &#125;,
    &quot;names&quot;: [
        &#123;
            &quot;C&quot;: &quot;CN&quot;,
            &quot;ST&quot;: &quot;beijing&quot;,
            &quot;L&quot;: &quot;beijing&quot;,
            &quot;O&quot;: &quot;example&quot;,
            &quot;OU&quot;: &quot;ops&quot;
        &#125;
    ]
&#125;
</code></pre>
<p><label style="color: red"><strong>注：这里需要将vip地址也要加入进去，以及所有可能用到的地址</strong></label></p>
<h3 id="7、生成kube-apiserver证书文件"><a href="#7、生成kube-apiserver证书文件" class="headerlink" title="7、生成kube-apiserver证书文件"></a>7、生成kube-apiserver证书文件</h3><pre><code>cfssl gencert -ca=ca.pem -ca-key=ca-key.pem -config=ca-config.json -profile=server apiserver-csr.json |cfssl-json -bare apiserver
</code></pre>
<p><label style="color: red"><strong>注：密钥证书的权限为：600</strong></label></p>
<h3 id="8、拷贝证书文件到-x2F-opt-x2F-kubernetes-x2F-server-x2F-bin-x2F-certs目录下"><a href="#8、拷贝证书文件到-x2F-opt-x2F-kubernetes-x2F-server-x2F-bin-x2F-certs目录下" class="headerlink" title="8、拷贝证书文件到&#x2F;opt&#x2F;kubernetes&#x2F;server&#x2F;bin&#x2F;certs目录下"></a>8、拷贝证书文件到&#x2F;opt&#x2F;kubernetes&#x2F;server&#x2F;bin&#x2F;certs目录下</h3><pre><code>apiserver.pem  apiserver-key.pem client.pem client-key.pem ca.pem ca-key.pem
</code></pre>
<h3 id="9、创建apiserver配置文件-x2F-opt-x2F-kubernetes-x2F-server-x2F-bin-x2F-conf-x2F-audit-yaml"><a href="#9、创建apiserver配置文件-x2F-opt-x2F-kubernetes-x2F-server-x2F-bin-x2F-conf-x2F-audit-yaml" class="headerlink" title="9、创建apiserver配置文件 &#x2F;opt&#x2F;kubernetes&#x2F;server&#x2F;bin&#x2F;conf&#x2F;audit.yaml"></a>9、创建apiserver配置文件 &#x2F;opt&#x2F;kubernetes&#x2F;server&#x2F;bin&#x2F;conf&#x2F;audit.yaml</h3><pre><code>apiVersion: audit.k8s.io/v1beta1
kind: Policy
omitStages:
  - &quot;RequestReceived&quot;
rules:
  - level: RequestResponse
    resources:
    - group: &quot;&quot;
      resources: [&quot;pods&quot;]
  - level: Metadata
    resources:
    - group: &quot;&quot;
      resources: [&quot;pods/log&quot;, &quot;pods/status&quot;]
  - level: None
    resources:
    - group: &quot;&quot;
      resources: [&quot;configmaps&quot;]
      resourceNames: [&quot;controller-leader&quot;]
  - level: None
    users: [&quot;system:kube-proxy&quot;]
    verbs: [&quot;watch&quot;]
    resources:
    - group: &quot;&quot;
      resources: [&quot;endpoints&quot;, &quot;services&quot;]
  - level: None
    userGroups: [&quot;system:authenticated&quot;]
    nonResourceURLs:
    - &quot;/api*&quot;
    - &quot;/version&quot;
  - level: Request
    resources:
    - group: &quot;&quot;
      resources: [&quot;configmaps&quot;]
    namespaces: [&quot;kube-system&quot;]
  - level: Metadata
    resources:
    - group: &quot;&quot;
      resources: [&quot;secrets&quot;, &quot;configmaps&quot;]
  - level: Request
    resources:
    - group: &quot;&quot;
    - group: &quot;extensions&quot; 
  - level: Metadata
    omitStages:
      - &quot;RequestReceived&quot;
</code></pre>
<p><label style="color: red"><strong>注：日志审计的功能，资源配置清单</strong></label></p>
<h3 id="10、api启动脚本文件kube-apiserver-sh"><a href="#10、api启动脚本文件kube-apiserver-sh" class="headerlink" title="10、api启动脚本文件kube-apiserver.sh"></a>10、api启动脚本文件kube-apiserver.sh</h3><pre><code>#!/bin/bash
./kube-apiserver \
  --apiserver-count 2 \
  --audit-log-path /data/logs/kubernetes/kube-apiserver/audit-log \
  --audit-policy-file ./conf/audit.yaml \
  --authorization-mode RBAC \
  --client-ca-file ./certs/ca.pem \
  --requestheader-client-ca-file ./certs/ca.pem \
  --enable-admission-plugins NamespaceLifecycle,LimitRanger,ServiceAccount,DefaultStorageClass,DefaultTolerationSeconds,MutatingAdmissionWebhook,ValidatingAdmissionWebhook,ResourceQuota \
  --etcd-cafile ./certs/ca.pem \
  --etcd-certfile ./certs/client.pem \
  --etcd-keyfile ./certs/client-key.pem \
  --etcd-servers https://192.168.10.21:2379,https://192.168.10.22:2379,https://192.168.10.23:2379 \
  --service-account-key-file ./certs/ca-key.pem \
  --service-cluster-ip-range 10.10.0.0/16 \
  --service-node-port-range 3000-29999 \
  --target-ram-mb=1024 \
  --kubelet-client-certificate ./certs/client.pem \
  --kubelet-client-key ./certs/client-key.pem \
  --log-dir  /data/logs/kubernetes/kube-apiserver \
  --tls-cert-file ./certs/apiserver.pem \
  --tls-private-key-file ./certs/apiserver-key.pem \
  --v 2 \
</code></pre>
<h3 id="11、给kube-apiserver-sh-添加可执行权限，即执行目录"><a href="#11、给kube-apiserver-sh-添加可执行权限，即执行目录" class="headerlink" title="11、给kube-apiserver.sh 添加可执行权限，即执行目录"></a>11、给kube-apiserver.sh 添加可执行权限，即执行目录</h3><pre><code>chmod +x kube-apiserver.sh
mkdir -p /data/logs/kubernetes/kube-apiserver
</code></pre>
<h3 id="12、配置supervisord配置文件-x2F-etc-x2F-supervisord-d-x2F-kube-apiserver-ini"><a href="#12、配置supervisord配置文件-x2F-etc-x2F-supervisord-d-x2F-kube-apiserver-ini" class="headerlink" title="12、配置supervisord配置文件&#x2F;etc&#x2F;supervisord.d&#x2F;kube-apiserver.ini"></a>12、配置supervisord配置文件&#x2F;etc&#x2F;supervisord.d&#x2F;kube-apiserver.ini</h3><pre><code>[program:kube-apiserver-10-21]
command=/opt/kubernetes/server/bin/kube-apiserver.sh            ; the program (relative uses PATH, can take args)
numprocs=1                                                      ; number of processes copies to start (def 1)
directory=/opt/kubernetes/server/bin                            ; directory to cwd to before exec (def no cwd)
autostart=true                                                  ; start at supervisord start (default: true)
autorestart=true                                                ; retstart at unexpected quit (default: true)
startsecs=30                                                    ; number of secs prog must stay running (def. 1)
startretries=3                                                  ; max # of serial start failures (default 3)
exitcodes=0,2                                                   ; &#39;expected&#39; exit codes for process (default 0,2)
stopsignal=QUIT                                                 ; signal used to kill process (default TERM)
stopwaitsecs=10                                                 ; max num secs to wait b4 SIGKILL (default 10)
user=root                                                       ; setuid to this UNIX account to run the program
redirect_stderr=true                                            ; redirect proc stderr to stdout (default false)
stdout_logfile=/data/logs/kubernetes/kube-apiserver/apiserver.stdout.log        ; stderr log path, NONE for none; default AUTO
stdout_logfile_maxbytes=64MB                                    ; max # logfile bytes b4 rotation (default 50MB)
stdout_logfile_backups=4                                        ; # of stdout logfile backups (default 10)
stdout_capture_maxbytes=1MB                                     ; number of bytes in &#39;capturemode&#39; (default 0)
stdout_events_enabled=false                                     ; emit events on stdout writes (default false)
</code></pre>
<h3 id="13、启动apiserver服务"><a href="#13、启动apiserver服务" class="headerlink" title="13、启动apiserver服务"></a>13、启动apiserver服务</h3><pre><code>supervisorctl update

附：
若启动时报出如下错误，请查看网卡网关是否有配置，若没有配置请配置网卡网关并重启网卡。
Error: Unable to find suitable network address.error=&#39;no default routes found in &quot;/proc/net/route&quot; or &quot;/proc/net/ipv6_route&quot;&#39;. Try to set the AdvertiseAddress directly or provide a valid BindAddress to fix this.
</code></pre>
<h3 id="14、查看端口"><a href="#14、查看端口" class="headerlink" title="14、查看端口"></a>14、查看端口</h3><pre><code>netstat -lntup  | grep api
</code></pre>
<p><img src="/2021/02/18/K8S-Binary-Install/33.png"></p>
<p><label style="color: red"><strong>注需要看到8080端口和6443端口</strong></label></p>
<h3 id="15、查看日志可以看到当前的master"><a href="#15、查看日志可以看到当前的master" class="headerlink" title="15、查看日志可以看到当前的master"></a>15、查看日志可以看到当前的master</h3><pre><code>tail -f /data/logs/kubernetes/kube-apiserver/apiserver.stdout.log
</code></pre>
<p><img src="/2021/02/18/K8S-Binary-Install/34.png"></p>
<h2 id="Master部署四层反向代理"><a href="#Master部署四层反向代理" class="headerlink" title="Master部署四层反向代理"></a>Master部署四层反向代理</h2><p>集群架构</p>
<table>
<thead>
<tr>
<th align="left">主机名</th>
<th align="left">角色</th>
<th align="left">IP地址</th>
<th align="left">VIP地址</th>
</tr>
</thead>
<tbody><tr>
<td align="left">master1.example.com</td>
<td align="left">L4</td>
<td align="left">192.168.10.11</td>
<td align="left">192.168.10.10</td>
</tr>
<tr>
<td align="left">master2.example.com</td>
<td align="left">L4</td>
<td align="left">192.168.10.12</td>
<td align="left">192.168.10.10</td>
</tr>
<tr>
<td align="left">master3.example.com</td>
<td align="left">L4</td>
<td align="left">192.168.10.13</td>
<td align="left">192.168.10.10</td>
</tr>
</tbody></table>
<p>用nginx的四层反向代理加上keepalived高可用，代理后端的apiserver 6443端口为前端的 7443端口。</p>
<h3 id="1、安装nginx和keepalived"><a href="#1、安装nginx和keepalived" class="headerlink" title="1、安装nginx和keepalived"></a>1、安装nginx和keepalived</h3><pre><code>yum install nginx keepalived -y
</code></pre>
<h3 id="2、修改nginx配置文件-x2F-etc-x2F-nginx-x2F-nginx-conf"><a href="#2、修改nginx配置文件-x2F-etc-x2F-nginx-x2F-nginx-conf" class="headerlink" title="2、修改nginx配置文件&#x2F;etc&#x2F;nginx&#x2F;nginx.conf"></a>2、修改nginx配置文件&#x2F;etc&#x2F;nginx&#x2F;nginx.conf</h3><pre><code>stream &#123;
    upstream kube-apiserver &#123;
        server 192.168.10.21:6443     max_fails=3 fail_timeout=30s;
        server 192.168.10.22:6443     max_fails=3 fail_timeout=30s;
        server 192.168.10.23:6443     max_fails=3 fail_timeout=30s;
    &#125;
    server &#123;
        listen 7443;
        proxy_connect_timeout 2s;
        proxy_timeout 900s;
        proxy_pass kube-apiserver;
    &#125;
&#125;
</code></pre>
<p><label style="color: red"><strong>注：stream是四层的代理，所以上述配置不能放在http中，而是与http平级。</strong></label></p>
<h3 id="3、启动nginx"><a href="#3、启动nginx" class="headerlink" title="3、启动nginx"></a>3、启动nginx</h3><pre><code>nginx -t 
systemctl start nginx 
systemctl enable nginx
</code></pre>
<h3 id="4、查看nginx的7443端口是否已经起来"><a href="#4、查看nginx的7443端口是否已经起来" class="headerlink" title="4、查看nginx的7443端口是否已经起来"></a>4、查看nginx的7443端口是否已经起来</h3><pre><code>netstat -lntp | grep nginx
</code></pre>
<p><img src="/2021/02/18/K8S-Binary-Install/35.png"></p>
<h3 id="5、配置-x2F-etc-x2F-keepalived-x2F-check-port-sh-监控端口脚本"><a href="#5、配置-x2F-etc-x2F-keepalived-x2F-check-port-sh-监控端口脚本" class="headerlink" title="5、配置&#x2F;etc&#x2F;keepalived&#x2F;check_port.sh  监控端口脚本"></a>5、配置&#x2F;etc&#x2F;keepalived&#x2F;check_port.sh  监控端口脚本</h3><pre><code>#!/bin/bash
#keepalived 监控端口脚本
#使用方法：
#在keepalived的配置文件中
#vrrp_script check_port 
CHK_PORT=$1
if [ -n &quot;$CHK_PORT&quot; ];then
        PORT_PROCESS=`ss -lnt|grep $CHK_PORT|wc -l`
        if [ $PORT_PROCESS -eq 0 ];then
                echo &quot;Port $CHK_PORT Is Not Used,End.&quot;
                exit 1
        fi
else
        echo &quot;Check Port Cant Be Empty!&quot;
fi
</code></pre>
<h3 id="6、监听端口脚本添加执行权限"><a href="#6、监听端口脚本添加执行权限" class="headerlink" title="6、监听端口脚本添加执行权限"></a>6、监听端口脚本添加执行权限</h3><pre><code>chmod +x /etc/keepalived/check_port.sh
</code></pre>
<h3 id="7、配置keepalived-配置文件etc-x2F-keepalived-x2F-keepalived-conf"><a href="#7、配置keepalived-配置文件etc-x2F-keepalived-x2F-keepalived-conf" class="headerlink" title="7、配置keepalived 配置文件etc&#x2F;keepalived&#x2F;keepalived.conf"></a>7、配置keepalived 配置文件etc&#x2F;keepalived&#x2F;keepalived.conf</h3><p>10-11节点 (主节点)</p>
<pre><code>! Configuration File for keepalived
global_defs &#123;
    router_id 192.168.10.11
&#125;
vrrp_script chk_nginx &#123;
    script &quot;/etc/keepalived/check_port.sh 7443&quot;
    interval 2
    weight -20
&#125;
vrrp_instance VI_1 &#123;
    state BACKUP
    interface ens33
    virtual_router_id 251
    mcast_src_ip 192.168.10.11
    priority 100
    advert_int 1
    authentication &#123;
        auth_type PASS
        auth_pass 11111111
    &#125;
    track_script &#123;
        chk_nginx
    &#125;
    virtual_ipaddress &#123;
        192.168.10.10
    &#125;
&#125;
</code></pre>
<p>10-12节点</p>
<pre><code>! Configuration File for keepalived
global_defs &#123;
    router_id 192.168.10.12
&#125;
vrrp_script chk_nginx &#123;
    script &quot;/etc/keepalived/check_port.sh 7443&quot;
    interval 2
    weight -20
&#125;
vrrp_instance VI_1 &#123;
    state BACKUP
    interface ens33
    virtual_router_id 251
    mcast_src_ip 192.168.10.12
    priority 90
    advert_int 1
    authentication &#123;
        auth_type PASS
        auth_pass 11111111
    &#125;
    track_script &#123;
        chk_nginx
    &#125;
    virtual_ipaddress &#123;
        192.168.10.10
    &#125;
&#125;
</code></pre>
<p>10-13节点</p>
<pre><code>! Configuration File for keepalived
global_defs &#123;
    router_id 192.168.10.13
&#125;
vrrp_script chk_nginx &#123;
    script &quot;/etc/keepalived/check_port.sh 7443&quot;
    interval 2
    weight -20
&#125;
vrrp_instance VI_1 &#123;
    state BACKUP
    interface ens33
    virtual_router_id 251
    mcast_src_ip 192.168.10.13
    priority 80
    advert_int 1
    authentication &#123;
        auth_type PASS
        auth_pass 11111111
    &#125;
    track_script &#123;
        chk_nginx
    &#125;
    virtual_ipaddress &#123;
        192.168.10.10
    &#125;
&#125;
</code></pre>
<p><label style="color: red"><strong>注：interface  即网卡名一定要与实际系统环境要用的网卡名一致。priority 该参数，次要节点最好都比主节点少</strong></label></p>
<h3 id="8、启动keepalived"><a href="#8、启动keepalived" class="headerlink" title="8、启动keepalived"></a>8、启动keepalived</h3><pre><code>systemctl start keepalived
systemctl enable keepalived
</code></pre>
<h3 id="9、查看虚拟网卡是否已经起来"><a href="#9、查看虚拟网卡是否已经起来" class="headerlink" title="9、查看虚拟网卡是否已经起来"></a>9、查看虚拟网卡是否已经起来</h3><pre><code>ip addr
</code></pre>
<p><img src="/2021/02/18/K8S-Binary-Install/36.png"></p>
<pre><code>注意：
    keepalived 主从绑定的时候要和自己的网络名称保持一致： interface ens33
    查看日志排错：tail -fn 200 /var/log/messages
    生产上vip不能轻易来回飘（故障转移）
    nginx -s stop
    netstat -nltp| grep 7443
    ip addr
</code></pre>
<h2 id="Node部署kube-controller-manager"><a href="#Node部署kube-controller-manager" class="headerlink" title="Node部署kube-controller-manager"></a>Node部署kube-controller-manager</h2><p>集群架构</p>
<table>
<thead>
<tr>
<th align="left">主机名</th>
<th align="left">角色</th>
<th align="left">IP地址</th>
</tr>
</thead>
<tbody><tr>
<td align="left">node1.example.com</td>
<td align="left">controller-manager</td>
<td align="left">192.168.10.21</td>
</tr>
<tr>
<td align="left">node2.example.com</td>
<td align="left">controller-manager</td>
<td align="left">192.168.10.22</td>
</tr>
<tr>
<td align="left">node3.example.com</td>
<td align="left">controller-manager</td>
<td align="left">192.168.10.23</td>
</tr>
</tbody></table>
<h3 id="1、创建启动脚本-x2F-opt-x2F-kubernetes-x2F-server-x2F-bin-x2F-kube-controller-manager-sh"><a href="#1、创建启动脚本-x2F-opt-x2F-kubernetes-x2F-server-x2F-bin-x2F-kube-controller-manager-sh" class="headerlink" title="1、创建启动脚本&#x2F;opt&#x2F;kubernetes&#x2F;server&#x2F;bin&#x2F;kube-controller-manager.sh"></a>1、创建启动脚本&#x2F;opt&#x2F;kubernetes&#x2F;server&#x2F;bin&#x2F;kube-controller-manager.sh</h3><pre><code>vim /opt/kubernetes/server/bin/kube-controller-manager.sh

#!/bin/sh
./kube-controller-manager \
  --cluster-cidr 172.7.0.0/16 \
  --leader-elect true \
  --log-dir /data/logs/kubernetes/kube-controller-manager \
  --master http://127.0.0.1:8080 \
  --service-account-private-key-file ./certs/ca-key.pem \
  --service-cluster-ip-range 10.10.0.0/16 \
  --root-ca-file ./certs/ca.pem \
  --v 2
</code></pre>
<p><label style="color: red"><strong>注：若kube-conntroller-manager 与 kube-apiserver不在同一台机器上，则需要配置client.pem与client-key.pem 证书</strong></label></p>
<h3 id="2、授权文件权限、创建目录"><a href="#2、授权文件权限、创建目录" class="headerlink" title="2、授权文件权限、创建目录"></a>2、授权文件权限、创建目录</h3><pre><code>chmod +x /opt/kubernetes/server/bin/kube-controller-manager.sh 
mkdir -p /data/logs/kubernetes/kube-controller-manager
</code></pre>
<h3 id="3、创建supervisor配置-x2F-etc-x2F-supervisord-d-x2F-kube-conntroller-manager-ini"><a href="#3、创建supervisor配置-x2F-etc-x2F-supervisord-d-x2F-kube-conntroller-manager-ini" class="headerlink" title="3、创建supervisor配置&#x2F;etc&#x2F;supervisord.d&#x2F;kube-conntroller-manager.ini"></a>3、创建supervisor配置&#x2F;etc&#x2F;supervisord.d&#x2F;kube-conntroller-manager.ini</h3><pre><code>vim /etc/supervisord.d/kube-conntroller-manager.ini

[program:kube-controller-manager-10-21]
command=/opt/kubernetes/server/bin/kube-controller-manager.sh                     ; the program (relative uses PATH, can take args)
numprocs=1                                                                        ; number of processes copies to start (def 1)
directory=/opt/kubernetes/server/bin                                              ; directory to cwd to before exec (def no cwd)
autostart=true                                                                    ; start at supervisord start (default: true)
autorestart=true                                                                  ; retstart at unexpected quit (default: true)
startsecs=30                                                                      ; number of secs prog must stay running (def. 1)
startretries=3                                                                    ; max # of serial start failures (default 3)
exitcodes=0,2                                                                     ; &#39;expected&#39; exit codes for process (default 0,2)
stopsignal=QUIT                                                                   ; signal used to kill process (default TERM)
stopwaitsecs=10                                                                   ; max num secs to wait b4 SIGKILL (default 10)
user=root                                                                         ; setuid to this UNIX account to run the program
redirect_stderr=true                                                              ; redirect proc stderr to stdout (default false)
stdout_logfile=/data/logs/kubernetes/kube-controller-manager/controller.stdout.log  ; stderr log path, NONE for none; default AUTO
stdout_logfile_maxbytes=64MB                                                      ; max # logfile bytes b4 rotation (default 50MB)
stdout_logfile_backups=4                                                          ; # of stdout logfile backups (default 10)
stdout_capture_maxbytes=1MB                                                       ; number of bytes in &#39;capturemode&#39; (default 0)
stdout_events_enabled=false                                                       ; emit events on stdout writes (default false)
</code></pre>
<h3 id="4、检查并启动服务"><a href="#4、检查并启动服务" class="headerlink" title="4、检查并启动服务"></a>4、检查并启动服务</h3><pre><code>supervisorctl update
supervisorctl status
</code></pre>
<h2 id="部署kube-scheduler"><a href="#部署kube-scheduler" class="headerlink" title="部署kube-scheduler"></a>部署kube-scheduler</h2><p>集群架构</p>
<table>
<thead>
<tr>
<th align="left">主机名</th>
<th align="left">角色</th>
<th align="left">IP地址</th>
</tr>
</thead>
<tbody><tr>
<td align="left">node1.example.com</td>
<td align="left">kube-scheduler</td>
<td align="left">192.168.10.21</td>
</tr>
<tr>
<td align="left">node2.example.com</td>
<td align="left">kube-scheduler</td>
<td align="left">192.168.10.22</td>
</tr>
<tr>
<td align="left">node3.example.com</td>
<td align="left">kube-scheduler</td>
<td align="left">192.168.10.23</td>
</tr>
</tbody></table>
<h3 id="1、创建kube-scheduler启动脚本"><a href="#1、创建kube-scheduler启动脚本" class="headerlink" title="1、创建kube-scheduler启动脚本"></a>1、创建kube-scheduler启动脚本</h3><pre><code>vi /opt/kubernetes/server/bin/kube-scheduler.sh

#!/bin/sh
./kube-scheduler \
  --leader-elect  \
  --log-dir /data/logs/kubernetes/kube-scheduler \
  --master http://127.0.0.1:8080 \
  --v 2
</code></pre>
<p><label style="color: red"><strong>注：若kube-scheduler 与 kube-apiserver不在同一台机器上，则需要配置client.pem与client-key.pem 证书</strong></label></p>
<h3 id="2、授权文件权限、创建目录-1"><a href="#2、授权文件权限、创建目录-1" class="headerlink" title="2、授权文件权限、创建目录"></a>2、授权文件权限、创建目录</h3><pre><code>chmod +x  /opt/kubernetes/server/bin/kube-scheduler.sh
mkdir -p /data/logs/kubernetes/kube-scheduler
</code></pre>
<h3 id="3、创建supervisor配置-x2F-etc-x2F-supervisord-d-x2F-kube-scheduler-ini"><a href="#3、创建supervisor配置-x2F-etc-x2F-supervisord-d-x2F-kube-scheduler-ini" class="headerlink" title="3、创建supervisor配置&#x2F;etc&#x2F;supervisord.d&#x2F;kube-scheduler.ini"></a>3、创建supervisor配置&#x2F;etc&#x2F;supervisord.d&#x2F;kube-scheduler.ini</h3><pre><code>vi /etc/supervisord.d/kube-scheduler.ini

[program:kube-scheduler-10-21]
command=/opt/kubernetes/server/bin/kube-scheduler.sh                     ; the program (relative uses PATH, can take args)
numprocs=1                                                               ; number of processes copies to start (def 1)
directory=/opt/kubernetes/server/bin                                     ; directory to cwd to before exec (def no cwd)
autostart=true                                                           ; start at supervisord start (default: true)
autorestart=true                                                         ; retstart at unexpected quit (default: true)
startsecs=30                                                             ; number of secs prog must stay running (def. 1)
startretries=3                                                           ; max # of serial start failures (default 3)
exitcodes=0,2                                                            ; &#39;expected&#39; exit codes for process (default 0,2)
stopsignal=QUIT                                                          ; signal used to kill process (default TERM)
stopwaitsecs=10                                                          ; max num secs to wait b4 SIGKILL (default 10)
user=root                                                                ; setuid to this UNIX account to run the program
redirect_stderr=true                                                     ; redirect proc stderr to stdout (default false)
stdout_logfile=/data/logs/kubernetes/kube-scheduler/scheduler.stdout.log ; stderr log path, NONE for none; default AUTO
stdout_logfile_maxbytes=64MB                                             ; max # logfile bytes b4 rotation (default 50MB)
stdout_logfile_backups=4                                                 ; # of stdout logfile backups (default 10)
stdout_capture_maxbytes=1MB                                              ; number of bytes in &#39;capturemode&#39; (default 0)
stdout_events_enabled=false                                              ; emit events on stdout writes (default false)
</code></pre>
<h3 id="4、检查并启动服务-1"><a href="#4、检查并启动服务-1" class="headerlink" title="4、检查并启动服务"></a>4、检查并启动服务</h3><pre><code>supervisorctl update
supervisorctl status
</code></pre>
<h2 id="检查节点kube"><a href="#检查节点kube" class="headerlink" title="检查节点kube"></a>检查节点kube</h2><h3 id="1、将kubectl命令软链接到-x2F-usr-x2F-bin下"><a href="#1、将kubectl命令软链接到-x2F-usr-x2F-bin下" class="headerlink" title="1、将kubectl命令软链接到&#x2F;usr&#x2F;bin下"></a>1、将kubectl命令软链接到&#x2F;usr&#x2F;bin下</h3><pre><code>ln -s /opt/kubernetes/server/bin/kubectl /usr/bin/kubectl
</code></pre>
<p><label style="color: red"><strong>注：方便后期执行命令</strong></label></p>
<h3 id="2、检查节点"><a href="#2、检查节点" class="headerlink" title="2、检查节点"></a>2、检查节点</h3><pre><code>kubectl get cs
</code></pre>
<p><img src="/2021/02/18/K8S-Binary-Install/37.png"></p>
<h2 id="部署kubelet"><a href="#部署kubelet" class="headerlink" title="部署kubelet"></a>部署kubelet</h2><p>集群架构</p>
<table>
<thead>
<tr>
<th align="left">主机名</th>
<th align="left">角色</th>
<th align="left">IP地址</th>
</tr>
</thead>
<tbody><tr>
<td align="left">node1.example.com</td>
<td align="left">kubelet</td>
<td align="left">192.168.10.21</td>
</tr>
<tr>
<td align="left">node2.example.com</td>
<td align="left">kubelet</td>
<td align="left">192.168.10.22</td>
</tr>
<tr>
<td align="left">node3.example.com</td>
<td align="left">kubelet</td>
<td align="left">192.168.10.23</td>
</tr>
</tbody></table>
<h3 id="1、创建生成证书csr的json配置文件kubelet-csr-json"><a href="#1、创建生成证书csr的json配置文件kubelet-csr-json" class="headerlink" title="1、创建生成证书csr的json配置文件kubelet-csr.json"></a>1、创建生成证书csr的json配置文件kubelet-csr.json</h3><pre><code>vi kubelet-csr.json

&#123;
    &quot;CN&quot;: &quot;k8s-kubelet&quot;,
    &quot;hosts&quot;: [
    &quot;127.0.0.1&quot;,
    &quot;192.168.10.10&quot;,
    &quot;192.168.10.11&quot;,
    &quot;192.168.10.12&quot;,
    &quot;192.168.10.13&quot;,
    &quot;192.168.10.21&quot;,
    &quot;192.168.10.22&quot;,
    &quot;192.168.10.23&quot;
    ],
    &quot;key&quot;: &#123;
        &quot;algo&quot;: &quot;rsa&quot;,
        &quot;size&quot;: 2048
    &#125;,
    &quot;names&quot;: [
        &#123;
            &quot;C&quot;: &quot;CN&quot;,
            &quot;ST&quot;: &quot;beijing&quot;,
            &quot;L&quot;: &quot;beijing&quot;,
            &quot;O&quot;: &quot;example&quot;,
            &quot;OU&quot;: &quot;ops&quot;
        &#125;
    ]
&#125;
</code></pre>
<p><label style="color: red"><strong>注：在生产环境中，尽量把可能用到证书的节点列到证书里，否则后期维护非常的麻烦。<br>一定要将VIP地址也加进去，否则kubelet启动时会报错，说这个ip没有证书认证。</strong></label></p>
<h3 id="2、生成kubelet证书文件"><a href="#2、生成kubelet证书文件" class="headerlink" title="2、生成kubelet证书文件"></a>2、生成kubelet证书文件</h3><pre><code>cfssl gencert -ca=ca.pem -ca-key=ca-key.pem -config=ca-config.json -profile=server kubelet-csr.json | cfssl-json -bare kubelet
</code></pre>
<h3 id="3、拷贝证书至各个节点的-x2F-opt-x2F-kubernetes-x2F-server-x2F-bin-x2F-certs目录下"><a href="#3、拷贝证书至各个节点的-x2F-opt-x2F-kubernetes-x2F-server-x2F-bin-x2F-certs目录下" class="headerlink" title="3、拷贝证书至各个节点的&#x2F;opt&#x2F;kubernetes&#x2F;server&#x2F;bin&#x2F;certs目录下"></a>3、拷贝证书至各个节点的&#x2F;opt&#x2F;kubernetes&#x2F;server&#x2F;bin&#x2F;certs目录下</h3><pre><code>kubelet-key.pem kubelet.pem
</code></pre>
<h3 id="4、创建配置"><a href="#4、创建配置" class="headerlink" title="4、创建配置"></a>4、创建配置</h3><p><label style="color: red"><strong>注：以下操作最好在&#x2F;opt&#x2F;kubernetes&#x2F;server&#x2F;bin&#x2F;conf&#x2F;目录下执行，生成kubelet.kubeconfig文件</strong></label><br><label style="color: red"><strong>以下操作只需要在一台节点上执行，之后复制配置文件到其他节点，主要是将kubelet.kubeconfig文件生成。</strong></label></p>
<h4 id="set-cluster"><a href="#set-cluster" class="headerlink" title="set-cluster"></a>set-cluster</h4><pre><code>kubectl config set-cluster myk8s \--certificate-authority=/opt/kubernetes/server/bin/certs/ca.pem \--embed-certs=true \--server=https://192.168.10.10:7443 \--kubeconfig=/opt/kubernetes/server/bin/conf/kubelet.kubeconfig
</code></pre>
<h4 id="set-credentials"><a href="#set-credentials" class="headerlink" title="set-credentials"></a>set-credentials</h4><pre><code>kubectl config set-credentials k8s-node \--client-certificate=/opt/kubernetes/server/bin/certs/client.pem \--client-key=/opt/kubernetes/server/bin/certs/client-key.pem \--embed-certs=true \--kubeconfig=/opt/kubernetes/server/bin/conf/kubelet.kubeconfig
</code></pre>
<h4 id="set-context"><a href="#set-context" class="headerlink" title="set-context"></a>set-context</h4><pre><code>kubectl config set-context myk8s-context \--cluster=myk8s \--user=k8s-node \--kubeconfig=/opt/kubernetes/server/bin/conf/kubelet.kubeconfig
</code></pre>
<h4 id="use-context"><a href="#use-context" class="headerlink" title="use-context"></a>use-context</h4><pre><code>kubectl config use-context myk8s-context --kubeconfig=/opt/kubernetes/server/bin/conf/kubelet.kubeconfig
</code></pre>
<h4 id="k8s-node-yaml-x2F-opt-x2F-kubernetes-x2F-server-x2F-bin-x2F-conf-x2F-k8s-node-yaml"><a href="#k8s-node-yaml-x2F-opt-x2F-kubernetes-x2F-server-x2F-bin-x2F-conf-x2F-k8s-node-yaml" class="headerlink" title="k8s-node.yaml (&#x2F;opt&#x2F;kubernetes&#x2F;server&#x2F;bin&#x2F;conf&#x2F;k8s-node.yaml)"></a>k8s-node.yaml (&#x2F;opt&#x2F;kubernetes&#x2F;server&#x2F;bin&#x2F;conf&#x2F;k8s-node.yaml)</h4><pre><code>vi /opt/kubernetes/server/bin/conf/k8s-node.yaml

apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: k8s-node
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: system:node
subjects:
- apiGroup: rbac.authorization.k8s.io
  kind: User
  name: k8s-node
</code></pre>
<p><label style="color: red"><strong>注：以上配置大致理解，定义了一个集群资源绑定的资源:ClusterRoleBinding,定义了资源的名字叫：k8s-node, 创建了一个k8s-node的集群用户，绑定了一个集群角色，这个角色具备集群里的运算节点的权限，从而使得这个用户拥有运算节点的权限。</strong></label></p>
<h4 id="应用资源配置"><a href="#应用资源配置" class="headerlink" title="应用资源配置"></a>应用资源配置</h4><pre><code>kubectl create -f /opt/kubernetes/server/bin/conf/k8s-node.yaml
</code></pre>
<h4 id="查看集群角色和角色属性"><a href="#查看集群角色和角色属性" class="headerlink" title="查看集群角色和角色属性"></a>查看集群角色和角色属性</h4><pre><code>kubectl get clusterrolebinding k8s-nodekubectl get clusterrolebinding k8s-node -o yaml
</code></pre>
<p><img src="/2021/02/18/K8S-Binary-Install/38.png"></p>
<h3 id="5、复制kubelet-kubeconfig文件至其他节点的-x2F-opt-x2F-kubernetes-x2F-server-x2F-bin-x2F-conf-x2F-目录下"><a href="#5、复制kubelet-kubeconfig文件至其他节点的-x2F-opt-x2F-kubernetes-x2F-server-x2F-bin-x2F-conf-x2F-目录下" class="headerlink" title="5、复制kubelet.kubeconfig文件至其他节点的&#x2F;opt&#x2F;kubernetes&#x2F;server&#x2F;bin&#x2F;conf&#x2F;目录下"></a>5、复制kubelet.kubeconfig文件至其他节点的&#x2F;opt&#x2F;kubernetes&#x2F;server&#x2F;bin&#x2F;conf&#x2F;目录下</h3><pre><code>kubelet.kubeconfig
</code></pre>
<h3 id="6、在私有镜像仓库节点获取pause基础镜像"><a href="#6、在私有镜像仓库节点获取pause基础镜像" class="headerlink" title="6、在私有镜像仓库节点获取pause基础镜像"></a>6、在私有镜像仓库节点获取pause基础镜像</h3><h4 id="登录私有镜像源"><a href="#登录私有镜像源" class="headerlink" title="登录私有镜像源"></a>登录私有镜像源</h4><pre><code>docker login harbor.example.com
</code></pre>
<h4 id="拉取pause镜像源"><a href="#拉取pause镜像源" class="headerlink" title="拉取pause镜像源"></a>拉取pause镜像源</h4><pre><code>docker pull kubernetes/pause
</code></pre>
<h4 id="查看pause镜像"><a href="#查看pause镜像" class="headerlink" title="查看pause镜像"></a>查看pause镜像</h4><pre><code>docker images | grep pause
</code></pre>
<h4 id="给puase镜像打标签"><a href="#给puase镜像打标签" class="headerlink" title="给puase镜像打标签"></a>给puase镜像打标签</h4><pre><code>docker tag f9d5de079539 harbor.example.com/public/pause:latest
</code></pre>
<h4 id="将puase镜像推到私有镜像源harbor中"><a href="#将puase镜像推到私有镜像源harbor中" class="headerlink" title="将puase镜像推到私有镜像源harbor中"></a>将puase镜像推到私有镜像源harbor中</h4><pre><code>docker push harbor.example.com/public/pause:latest
</code></pre>
<h4 id="查看harbor网页端"><a href="#查看harbor网页端" class="headerlink" title="查看harbor网页端"></a>查看harbor网页端</h4><p><img src="/2021/02/18/K8S-Binary-Install/39.png"></p>
<h3 id="7、创建kubelet启动脚本"><a href="#7、创建kubelet启动脚本" class="headerlink" title="7、创建kubelet启动脚本"></a>7、创建kubelet启动脚本</h3><pre><code>vi /opt/kubernetes/server/bin/kubelet.sh

#!/bin/sh
./kubelet \
  --anonymous-auth=false \
  --cgroup-driver systemd \
  --cluster-dns 10.10.0.2 \
  --cluster-domain cluster.local \
  --runtime-cgroups=/systemd/system.slice \
  --kubelet-cgroups=/systemd/system.slice \
  --fail-swap-on=&quot;false&quot; \
  --client-ca-file ./certs/ca.pem \
  --tls-cert-file ./certs/kubelet.pem \
  --tls-private-key-file ./certs/kubelet-key.pem \
  --hostname-override sevattal-21.host.com \
  --image-gc-high-threshold 20 \
  --image-gc-low-threshold 10 \
  --kubeconfig ./conf/kubelet.kubeconfig \
  --log-dir /data/logs/kubernetes/kube-kubelet \
  --pod-infra-container-image harbor.example.com/public/pause:latest \
  --root-dir /data/kubelet
</code></pre>
<p><label style="color: red"><strong>注：其他的节点 –hostname-override参数不同，指定的是当前节点的dns主机域名，我这边的主机域为host.com</strong></label></p>
<h3 id="8、授予可执行权限和创建目录"><a href="#8、授予可执行权限和创建目录" class="headerlink" title="8、授予可执行权限和创建目录"></a>8、授予可执行权限和创建目录</h3><pre><code>chmod +x /opt/kubernetes/server/bin/kubelet.sh
mkdir -p /data/logs/kubernetes/kube-kubelet /data/kubelet
</code></pre>
<h3 id="9、创建supervisor配置文件"><a href="#9、创建supervisor配置文件" class="headerlink" title="9、创建supervisor配置文件"></a>9、创建supervisor配置文件</h3><pre><code>vi /etc/supervisord.d/kube-kubelet.ini

[program:kube-kubelet-10-21]
command=/opt/kubernetes/server/bin/kubelet.sh     ; the program (relative uses PATH, can take args)
numprocs=1                                        ; number of processes copies to start (def 1)
directory=/opt/kubernetes/server/bin              ; directory to cwd to before exec (def no cwd)
autostart=true                                    ; start at supervisord start (default: true)
autorestart=true                                  ; retstart at unexpected quit (default: true)
startsecs=30                                      ; number of secs prog must stay running (def. 1)
startretries=3                                    ; max # of serial start failures (default 3)
exitcodes=0,2                                     ; &#39;expected&#39; exit codes for process (default 0,2)
stopsignal=QUIT                                   ; signal used to kill process (default TERM)
stopwaitsecs=10                                   ; max num secs to wait b4 SIGKILL (default 10)
user=root                                         ; setuid to this UNIX account to run the program
redirect_stderr=true                              ; redirect proc stderr to stdout (default false)
stdout_logfile=/data/logs/kubernetes/kube-kubelet/kubelet.stdout.log   ; stderr log path, NONE for none; default AUTO
stdout_logfile_maxbytes=64MB                      ; max # logfile bytes b4 rotation (default 50MB)
stdout_logfile_backups=4                          ; # of stdout logfile backups (default 10)
stdout_capture_maxbytes=1MB                       ; number of bytes in &#39;capturemode&#39; (default 0)
stdout_events_enabled=false                       ; emit events on stdout writes (default false)
</code></pre>
<h3 id="10、启动服务并检查"><a href="#10、启动服务并检查" class="headerlink" title="10、启动服务并检查"></a>10、启动服务并检查</h3><pre><code>supervisorctl  update
supervisorctl status

附：
    failed to run Kubelet: failed to create kubelet: failed to get docker versionr/run/docker.sock. Is the docker daemon running?
    若kubelet启动时报错以上信息，请启动docker
</code></pre>
<h3 id="11、当所有节点启动后，使用kubectl-get-nodes获取节点信息"><a href="#11、当所有节点启动后，使用kubectl-get-nodes获取节点信息" class="headerlink" title="11、当所有节点启动后，使用kubectl get nodes获取节点信息"></a>11、当所有节点启动后，使用kubectl get nodes获取节点信息</h3><pre><code>kubectl get node
</code></pre>
<p><img src="/2021/02/18/K8S-Binary-Install/40.png"></p>
<h3 id="12、给所有节点打上标签"><a href="#12、给所有节点打上标签" class="headerlink" title="12、给所有节点打上标签"></a>12、给所有节点打上标签</h3><pre><code>kubectl label node sevattal-21.host.com node-role.kubernetes.io/master=sevattal-21.host.com
kubectl label node sevattal-21.host.com node-role.kubernetes.io/node=sevattal-21.host.com
kubectl label node sevattal-22.host.com node-role.kubernetes.io/master=sevattal-22.host.com
kubectl label node sevattal-22.host.com node-role.kubernetes.io/node=sevattal-22.host.com
kubectl label node sevattal-23.host.com node-role.kubernetes.io/master=sevattal-23.host.com
kubectl label node sevattal-23.host.com node-role.kubernetes.io/node=sevattal-23.host.com
</code></pre>
<p><label style="color: red"><strong>注：由于规划的是3个节点都做主库节点和运算节点，所以master和node两个标签都打上。</strong></label></p>
<p><img src="/2021/02/18/K8S-Binary-Install/41.png"></p>
<h2 id="部署kube-proxy"><a href="#部署kube-proxy" class="headerlink" title="部署kube-proxy"></a>部署kube-proxy</h2><p>集群规划</p>
<table>
<thead>
<tr>
<th align="left">主机名</th>
<th align="left">角色</th>
<th align="left">IP地址</th>
</tr>
</thead>
<tbody><tr>
<td align="left">node1.example.com</td>
<td align="left">kube-proxy</td>
<td align="left">192.168.10.21</td>
</tr>
<tr>
<td align="left">node2.example.com</td>
<td align="left">kube-proxy</td>
<td align="left">192.168.10.22</td>
</tr>
<tr>
<td align="left">node3.example.com</td>
<td align="left">kube-proxy</td>
<td align="left">192.168.10.23</td>
</tr>
</tbody></table>
<p><label style="color: red"><strong>注：以下操作在证书服务器上执行</strong></label></p>
<h3 id="1、创建生成证书签名csr的json配置文件"><a href="#1、创建生成证书签名csr的json配置文件" class="headerlink" title="1、创建生成证书签名csr的json配置文件"></a>1、创建生成证书签名csr的json配置文件</h3><pre><code>vi kube-proxy-csr.json

&#123;
    &quot;CN&quot;: &quot;system:kube-proxy&quot;,
    &quot;key&quot;: &#123;
        &quot;algo&quot;: &quot;rsa&quot;,
        &quot;size&quot;: 2048
    &#125;,
    &quot;names&quot;: [
        &#123;
            &quot;C&quot;: &quot;CN&quot;,
            &quot;ST&quot;: &quot;beijing&quot;,
            &quot;L&quot;: &quot;beijing&quot;,
            &quot;O&quot;: &quot;example&quot;,
            &quot;OU&quot;: &quot;ops&quot;
        &#125;
    ]
&#125;
</code></pre>
<p><label style="color: red"><strong>注：CN这个字段，签成K8S中默认角色的名字。这样会让kube-proxy这个用户默认拥有了K8S里面system:kube-proxy这个角色的权限，当然上述的kubelet也可以这样操作。</strong></label></p>
<h3 id="2、生成kube-proxy证书文件"><a href="#2、生成kube-proxy证书文件" class="headerlink" title="2、生成kube-proxy证书文件"></a>2、生成kube-proxy证书文件</h3><pre><code>cfssl gencert -ca=ca.pem -ca-key=ca-key.pem -config=ca-config.json -profile=client kube-proxy-csr.json |cfssl-json -bare kube-proxy-client
</code></pre>
<h3 id="3、将证书文件发送至各个节点-x2F-opt-x2F-kubernetes-x2F-server-x2F-bin-x2F-certs目录下"><a href="#3、将证书文件发送至各个节点-x2F-opt-x2F-kubernetes-x2F-server-x2F-bin-x2F-certs目录下" class="headerlink" title="3、将证书文件发送至各个节点&#x2F;opt&#x2F;kubernetes&#x2F;server&#x2F;bin&#x2F;certs目录下"></a>3、将证书文件发送至各个节点&#x2F;opt&#x2F;kubernetes&#x2F;server&#x2F;bin&#x2F;certs目录下</h3><pre><code>kube-proxy-client.pem  kube-proxy-client-key.pem
</code></pre>
<h3 id="4、创建配置-1"><a href="#4、创建配置-1" class="headerlink" title="4、创建配置"></a>4、创建配置</h3><p><label style="color: red"><strong>注：以下操作最好在&#x2F;opt&#x2F;kubernetes&#x2F;server&#x2F;bin&#x2F;conf&#x2F;目录下执行，生成kube-proxy.kubeconfig文件<br>以下操作只需要在一台节点上执行，之后复制配置文件到其他节点，主要是将kube-proxy.kubeconfig文件生成。</strong></label></p>
<h4 id="set-cluster-1"><a href="#set-cluster-1" class="headerlink" title="set-cluster"></a>set-cluster</h4><pre><code>kubectl config set-cluster myk8s \--certificate-authority=/opt/kubernetes/server/bin/certs/ca.pem \--embed-certs=true \--server=https://192.168.10.10:7443 \--kubeconfig=/opt/kubernetes/server/bin/conf/kube-proxy.kubeconfig
</code></pre>
<h4 id="set-credentials-1"><a href="#set-credentials-1" class="headerlink" title="set-credentials"></a>set-credentials</h4><pre><code>kubectl config set-credentials kube-proxy \  --client-certificate=/opt/kubernetes/server/bin/certs/kube-proxy-client.pem \  --client-key=/opt/kubernetes/server/bin/certs/kube-proxy-client-key.pem \  --embed-certs=true \  --kubeconfig=/opt/kubernetes/server/bin/conf/kube-proxy.kubeconfig
</code></pre>
<h4 id="set-context-1"><a href="#set-context-1" class="headerlink" title="set-context"></a>set-context</h4><pre><code>kubectl config set-context myk8s-context \--cluster=myk8s \--user=kube-proxy \--kubeconfig=/opt/kubernetes/server/bin/conf/kube-proxy.kubeconfig
</code></pre>
<h4 id="use-context-1"><a href="#use-context-1" class="headerlink" title="use-context"></a>use-context</h4><pre><code>kubectl config use-context myk8s-context --kubeconfig=kube-proxy.kubeconfig
</code></pre>
<h3 id="5、复制kube-proxy-kubeconfig文件至其他节点的-x2F-opt-x2F-kubernetes-x2F-server-x2F-bin-x2F-conf-x2F-目录下"><a href="#5、复制kube-proxy-kubeconfig文件至其他节点的-x2F-opt-x2F-kubernetes-x2F-server-x2F-bin-x2F-conf-x2F-目录下" class="headerlink" title="5、复制kube-proxy.kubeconfig文件至其他节点的&#x2F;opt&#x2F;kubernetes&#x2F;server&#x2F;bin&#x2F;conf&#x2F;目录下"></a>5、复制kube-proxy.kubeconfig文件至其他节点的&#x2F;opt&#x2F;kubernetes&#x2F;server&#x2F;bin&#x2F;conf&#x2F;目录下</h3><pre><code>kube-proxy.kubeconfig
</code></pre>
<h3 id="6、创建ipvs脚本"><a href="#6、创建ipvs脚本" class="headerlink" title="6、创建ipvs脚本"></a>6、创建ipvs脚本</h3><pre><code>vi /root/ipvs.sh

#!/bin/bash
ipvs_mods_dir=&quot;/usr/lib/modules/$(uname -r)/kernel/net/netfilter/ipvs&quot;
for i in $(ls $ipvs_mods_dir|grep -o &quot;^[^.]*&quot;)
do
  /sbin/modinfo -F filename $i &amp;&gt;/dev/null
  if [ $? -eq 0 ];then
    /sbin/modprobe $i
  fi
done
</code></pre>
<h3 id="7、执行ipvs脚本"><a href="#7、执行ipvs脚本" class="headerlink" title="7、执行ipvs脚本"></a>7、执行ipvs脚本</h3><pre><code>chmod +x /root/ipvs.sh
. /root/ipvs.sh
</code></pre>
<h3 id="8、查看ipvs模块是否加载"><a href="#8、查看ipvs模块是否加载" class="headerlink" title="8、查看ipvs模块是否加载"></a>8、查看ipvs模块是否加载</h3><pre><code>lsmod | grep ip_vs
</code></pre>
<p><img src="/2021/02/18/K8S-Binary-Install/42.png"></p>
<pre><code>IPVS在内核中的负载均衡调度是以连接为粒度的。在HTTP协议（非持久）中，每个对象从WEB服务器上获取都需要建立一个TCP连接， 同一用户的不同请求会被调度到不同的服务器上，所以这种细粒度的调度在一定程度上可以避免单个用户访问的突发性引起服务器间的负载不平衡。
在内核中的连接调度算法上，IPVS已实现了以下十种调度算法：
轮叫调度（Round-Robin Scheduling）
加权轮叫调度（Weighted Round-Robin Scheduling）
最小连接调度（Least-Connection Scheduling）
加权最小连接调度（Weighted Least-Connection Scheduling）
基于局部性的最少链接（Locality-Based Least Connections Scheduling）
带复制的基于局部性最少链接（Locality-Based Least Connections with Replication Scheduling）
目标地址散列调度（Destination Hashing Scheduling）
源地址散列调度（Source Hashing Scheduling）
最短预期延时调度（Shortest Expected Delay Scheduling）
不排队调度（Never Queue Scheduling）
</code></pre>
<h3 id="9、创建kube-proxy启动脚本"><a href="#9、创建kube-proxy启动脚本" class="headerlink" title="9、创建kube-proxy启动脚本"></a>9、创建kube-proxy启动脚本</h3><pre><code>vi /opt/kubernetes/server/bin/kube-proxy.sh

#!/bin/sh
./kube-proxy \
  --cluster-cidr 172.7.0.0/16 \
  --hostname-override sevattal-21.host.com \
  --proxy-mode=ipvs \
  --ipvs-scheduler=nq \
  --kubeconfig ./conf/kube-proxy.kubeconfig
</code></pre>
<p><label style="color: red"><strong>注：其他的节点–hostname-override 不同</strong></label></p>
<h3 id="10、授权、创建目录"><a href="#10、授权、创建目录" class="headerlink" title="10、授权、创建目录"></a>10、授权、创建目录</h3><pre><code>chmod +x /opt/kubernetes/server/bin/kube-proxy.sh 
mkdir -p /data/logs/kubernetes/kube-proxy
</code></pre>
<h3 id="11、创建supervisor配置"><a href="#11、创建supervisor配置" class="headerlink" title="11、创建supervisor配置"></a>11、创建supervisor配置</h3><pre><code>vi /etc/supervisord.d/kube-proxy.ini

[program:kube-proxy-10-21]
command=/opt/kubernetes/server/bin/kube-proxy.sh                     ; the program (relative uses PATH, can take args)
numprocs=1                                                           ; number of processes copies to start (def 1)
directory=/opt/kubernetes/server/bin                                 ; directory to cwd to before exec (def no cwd)
autostart=true                                                       ; start at supervisord start (default: true)
autorestart=true                                                     ; retstart at unexpected quit (default: true)
startsecs=30                                                         ; number of secs prog must stay running (def. 1)
startretries=3                                                       ; max # of serial start failures (default 3)
exitcodes=0,2                                                        ; &#39;expected&#39; exit codes for process (default 0,2)
stopsignal=QUIT                                                      ; signal used to kill process (default TERM)
stopwaitsecs=10                                                      ; max num secs to wait b4 SIGKILL (default 10)
user=root                                                            ; setuid to this UNIX account to run the program
redirect_stderr=true                                                 ; redirect proc stderr to stdout (default false)
stdout_logfile=/data/logs/kubernetes/kube-proxy/proxy.stdout.log     ; stderr log path, NONE for none; default AUTO
stdout_logfile_maxbytes=64MB                                         ; max # logfile bytes b4 rotation (default 50MB)
stdout_logfile_backups=4                                             ; # of stdout logfile backups (default 10)
stdout_capture_maxbytes=1MB                                          ; number of bytes in &#39;capturemode&#39; (default 0)
stdout_events_enabled=false                                          ; emit events on stdout writes (default false)
</code></pre>
<h3 id="12、启动服务并检查"><a href="#12、启动服务并检查" class="headerlink" title="12、启动服务并检查"></a>12、启动服务并检查</h3><pre><code>supervisorctl  update
supervisorctl status
</code></pre>
<h3 id="13、安装ipvsadm"><a href="#13、安装ipvsadm" class="headerlink" title="13、安装ipvsadm"></a>13、安装ipvsadm</h3><pre><code>yum install ipvsadm -y
</code></pre>
<h3 id="14、使用ipvsadm命令查看路由配置"><a href="#14、使用ipvsadm命令查看路由配置" class="headerlink" title="14、使用ipvsadm命令查看路由配置"></a>14、使用ipvsadm命令查看路由配置</h3><pre><code>ipvsadm -Ln
</code></pre>
<p><img src="/2021/02/18/K8S-Binary-Install/43.png"></p>
<h3 id="15、使用kubectl命令查看"><a href="#15、使用kubectl命令查看" class="headerlink" title="15、使用kubectl命令查看"></a>15、使用kubectl命令查看</h3><pre><code>kubectl get svc
</code></pre>
<p><img src="/2021/02/18/K8S-Binary-Install/44.png"></p>
<h2 id="验证kubernetes集群"><a href="#验证kubernetes集群" class="headerlink" title="验证kubernetes集群"></a>验证kubernetes集群</h2><h3 id="1、在node1中创建一个资源配置清单"><a href="#1、在node1中创建一个资源配置清单" class="headerlink" title="1、在node1中创建一个资源配置清单"></a>1、在node1中创建一个资源配置清单</h3><pre><code>vi /root/nginx-ds.yaml

apiVersion: extensions/v1beta1
kind: DaemonSet
metadata:
  name: nginx-ds
spec:
  template:
    metadata:
      labels:
        app: nginx-ds
    spec:
      containers:
      - name: my-nginx
        image: harbor.example.com/public/nginx:latest
        ports:
        - containerPort: 80
</code></pre>
<h3 id="2、应用资源配置，并检查"><a href="#2、应用资源配置，并检查" class="headerlink" title="2、应用资源配置，并检查"></a>2、应用资源配置，并检查</h3><h4 id="在node1中应用资源配置"><a href="#在node1中应用资源配置" class="headerlink" title="在node1中应用资源配置"></a>在node1中应用资源配置</h4><pre><code>kubectl create -f /root/nginx-ds.yaml
</code></pre>
<p>在node1,2,3中检查</p>
<pre><code>kubectl get pods
kubectl get pods -o wide
</code></pre>
<p><img src="/2021/02/18/K8S-Binary-Install/45.png"></p>
<h2 id="每次重启集群需要启动的地方"><a href="#每次重启集群需要启动的地方" class="headerlink" title="每次重启集群需要启动的地方"></a>每次重启集群需要启动的地方</h2><h3 id="检查配置并启动bind-9"><a href="#检查配置并启动bind-9" class="headerlink" title="检查配置并启动bind 9"></a>检查配置并启动bind 9</h3><pre><code>named-checkconf
systemctl start named
netstat -lntup|grep 53
</code></pre>
<h3 id="启动nginx，链接harbor"><a href="#启动nginx，链接harbor" class="headerlink" title="启动nginx，链接harbor"></a>启动nginx，链接harbor</h3><pre><code>/opt/harbor/install.sh
nginx -t
systemctl start nginx
systemctl enable nginx
</code></pre>
<h3 id="四层反向代理"><a href="#四层反向代理" class="headerlink" title="四层反向代理"></a>四层反向代理</h3><pre><code>systemctl start nginx keepalived
systemctl enable nginx keepalived
netstat -lntup|grep nginx
ip addr
</code></pre>

      
    </div>
    
  </div>
  
    
    <div class="copyright">
        <p><span>Title:</span><a href="/2021/02/18/K8S-Binary-Install/">K8S-Binary-Install</a></p>
        <p><span>Author:</span><a href="/" title="Back to Homepage"></a></p>
        <p><span>Created:</span>2021-02-18, 14:32:43</p>
        <p><span>Updated:</span>2022-11-18, 09:11:42</p>
        <p>
            <span>Full URL:</span><a class="post-url" href="/2021/02/18/K8S-Binary-Install/" title="K8S-Binary-Install">http://yoursite.com/2021/02/18/K8S-Binary-Install/</a>
            <span class="copy-path" data-clipboard-text="From http://yoursite.com/2021/02/18/K8S-Binary-Install/　　By " title="Copy Article&#39;s Link &amp; Author"><i class="fa fa-clipboard"></i></span>
            <script> var clipboard = new Clipboard('.copy-path'); </script>
        </p>
        <p>
            <span>License:</span><i class="fa fa-creative-commons"></i> <a rel="license noopener" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" title="CC BY-NC-SA 4.0 International" target = "_blank">"CC BY-NC-SA 4.0"</a> Keep Link &amp; Author if Distribute.
        </p>
    </div>



    <nav id="article-nav">
        
            <div id="article-nav-newer" class="article-nav-title">
                <a href="/2021/02/21/Java-SprintBoot-Error1/">
                    Java-SprintBoot-Error1
                </a>
            </div>
        
        
            <div id="article-nav-older" class="article-nav-title">
                <a href="/2021/02/15/Oracle-Clean-Archivelog/">
                    Oracle-Clean-Archivelog
                </a>
            </div>
        
    </nav>

  
</article>

    <div id="toc" class="toc-article">
        <strong class="toc-title">Contents</strong>
        
            <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#K8S-%E4%BA%8C%E8%BF%9B%E5%88%B6%E9%83%A8%E7%BD%B2"><span class="toc-number">1.</span> <span class="toc-text">K8S 二进制部署</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E8%A3%85%E9%83%A8%E7%BD%B2%E7%8E%AF%E5%A2%83%E8%AF%B4%E6%98%8E%EF%BC%88%E6%9C%AC%E6%96%87%E5%AE%9E%E9%AA%8C%E7%8E%AF%E5%A2%83%E4%B8%BACentOS7%EF%BC%89"><span class="toc-number">1.1.</span> <span class="toc-text">安装部署环境说明（本文实验环境为CentOS7）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#IP%E5%9C%B0%E5%9D%80%E5%88%86%E9%85%8D"><span class="toc-number">1.1.1.</span> <span class="toc-text">IP地址分配</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BD%91%E6%AE%B5%E5%88%92%E5%88%86"><span class="toc-number">1.1.2.</span> <span class="toc-text">网段划分</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E5%89%8D%E6%9C%9F%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%87%86%E5%A4%87"><span class="toc-number">1.2.</span> <span class="toc-text">一、前期服务器准备</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9F%BA%E4%BA%8E%E4%B8%BB%E6%9C%BA%E5%90%8D%E9%80%9A%E4%BF%A1%EF%BC%9A-x2F-etc-x2F-hosts"><span class="toc-number">1.2.0.1.</span> <span class="toc-text">基于主机名通信：&#x2F;etc&#x2F;hosts</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%80%E6%9C%89K8S%E4%B8%BB%E6%9C%BA%E5%85%B3%E9%97%ADselinux"><span class="toc-number">1.2.0.2.</span> <span class="toc-text">所有K8S主机关闭selinux</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%80%E6%9C%89K8S%E4%B8%BB%E6%9C%BA%E5%85%B3%E9%97%AD%E9%98%B2%E7%81%AB%E5%A2%99"><span class="toc-number">1.2.0.3.</span> <span class="toc-text">所有K8S主机关闭防火墙</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%B3%E9%97%ADswapoff%E5%88%86%E5%8C%BA"><span class="toc-number">1.2.0.4.</span> <span class="toc-text">关闭swapoff分区</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%97%B6%E9%97%B4%E5%90%8C%E6%AD%A5%EF%BC%88%E8%BF%99%E8%BE%B9%E4%BD%BF%E7%94%A8%E7%9A%84%E6%98%AFntpdate%EF%BC%89"><span class="toc-number">1.2.0.5.</span> <span class="toc-text">时间同步（这边使用的是ntpdate）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%97%B6%E9%97%B4%E5%90%8C%E6%AD%A5%E5%BB%BA%E8%AE%AE%E4%BD%BF%E7%94%A8chronyd"><span class="toc-number">1.2.0.6.</span> <span class="toc-text">时间同步建议使用chronyd</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%B0%83%E6%95%B4yum%E6%BA%90%EF%BC%8C%E5%AE%89%E8%A3%85epel-release"><span class="toc-number">1.2.0.7.</span> <span class="toc-text">调整yum源，安装epel-release</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%89%E8%A3%85%E5%BF%85%E8%A6%81%E7%9A%84%E5%B7%A5%E5%85%B7%EF%BC%88%E7%94%A8%E4%BA%8E%E5%90%8E%E6%9C%9F%E7%BB%B4%E6%8A%A4%EF%BC%89"><span class="toc-number">1.2.0.8.</span> <span class="toc-text">安装必要的工具（用于后期维护）</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E5%9C%A8DNS%E4%B8%BB%E6%9C%BA%E4%B8%8A%E5%AE%89%E8%A3%85DNS%E6%9C%8D%E5%8A%A1"><span class="toc-number">1.3.</span> <span class="toc-text">二、在DNS主机上安装DNS服务</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E5%AE%89%E8%A3%85DNS%E6%9C%8D%E5%8A%A1"><span class="toc-number">1.3.1.</span> <span class="toc-text">1、安装DNS服务</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81-x2F-etc-x2F-named-conf%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E4%BF%AE%E6%94%B9"><span class="toc-number">1.3.2.</span> <span class="toc-text">2、&#x2F;etc&#x2F;named.conf配置文件修改</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81%E6%A3%80%E6%9F%A5%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E6%98%AF%E5%90%A6%E6%AD%A3%E7%A1%AEname-checkconf"><span class="toc-number">1.3.3.</span> <span class="toc-text">3、检查配置文件是否正确name-checkconf</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4%E3%80%81%E9%85%8D%E7%BD%AE%E5%8C%BA%E5%9F%9F%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6-x2F-etc-x2F-named-x2F-named-rfc1912-zones"><span class="toc-number">1.3.4.</span> <span class="toc-text">4、配置区域配置文件&#x2F;etc&#x2F;named&#x2F;named.rfc1912.zones</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6%E3%80%81%E9%85%8D%E7%BD%AEhost-com-zone-%E3%80%81example-com-zone%E6%96%87%E4%BB%B6"><span class="toc-number">1.3.5.</span> <span class="toc-text">6、配置host.com.zone 、example.com.zone文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7%E3%80%81%E9%87%8D%E5%90%AFnamed%E6%9C%8D%E5%8A%A1"><span class="toc-number">1.3.6.</span> <span class="toc-text">7、重启named服务</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8%E3%80%81%E6%9B%B4%E6%94%B9%E5%85%B6%E4%BB%96%E6%89%80%E6%9C%89%E6%9C%BA%E5%99%A8%E7%9A%84DNS%E6%8C%87%E5%90%91"><span class="toc-number">1.3.7.</span> <span class="toc-text">8、更改其他所有机器的DNS指向</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9%E3%80%81%E6%9F%A5%E7%9C%8BDNS%E6%98%AF%E5%90%A6%E7%94%9F%E6%95%88"><span class="toc-number">1.3.8.</span> <span class="toc-text">9、查看DNS是否生效</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81CFSSL%E5%AE%89%E8%A3%85%E5%8D%B3%E7%AD%BE%E5%8F%91%E8%AF%81%E4%B9%A6"><span class="toc-number">1.4.</span> <span class="toc-text">三、CFSSL安装即签发证书</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E4%B8%8B%E8%BD%BDCFSSL%E5%AE%89%E8%A3%85%E5%8C%85%EF%BC%88%E7%BD%91%E5%9D%80%EF%BC%9Ahttp-pkg-cfssl-org-%EF%BC%89"><span class="toc-number">1.4.1.</span> <span class="toc-text">1、下载CFSSL安装包（网址：http:&#x2F;&#x2F;pkg.cfssl.org&#x2F;）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81%E7%BB%99cfssl%E6%96%87%E4%BB%B6%E5%8F%AF%E6%89%A7%E8%A1%8C%E6%9D%83%E9%99%90"><span class="toc-number">1.4.2.</span> <span class="toc-text">2、给cfssl文件可执行权限</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81%E5%88%9B%E5%BB%BA%E8%AF%81%E4%B9%A6%E6%96%87%E4%BB%B6%E7%9B%AE%E5%BD%95"><span class="toc-number">1.4.3.</span> <span class="toc-text">3、创建证书文件目录</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4%E3%80%81%E5%88%9B%E5%BB%BA%E5%9C%A8CA%E8%AF%81%E4%B9%A6%E6%96%87%E4%BB%B6-x2F-opt-x2F-certs-x2F-ca-csr-json"><span class="toc-number">1.4.4.</span> <span class="toc-text">4、创建在CA证书文件&#x2F;opt&#x2F;certs&#x2F;ca-csr.json</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5%E3%80%81%E7%AD%BE%E8%AF%81%E4%B9%A6%EF%BC%8C%E9%9C%80%E8%A6%81%E5%88%B0-x2F-opt-x2F-certs%E7%9B%AE%E5%BD%95%E4%B8%8B"><span class="toc-number">1.4.5.</span> <span class="toc-text">5、签证书，需要到&#x2F;opt&#x2F;certs目录下</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B%E3%80%81K8S%E5%87%A0%E5%8F%B0%E6%9C%BA%E5%99%A8%E5%AE%89%E8%A3%85Docker-CE%E7%8E%AF%E5%A2%83"><span class="toc-number">1.5.</span> <span class="toc-text">四、K8S几台机器安装Docker-CE环境</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81Docker%E5%AE%98%E7%BD%91%E7%9A%84%E8%84%9A%E6%9C%AC%E5%91%BD%E4%BB%A4%EF%BC%88%E5%BD%93%E7%84%B6%E4%B9%9F%E5%8F%AF%E4%BB%A5%E4%BD%BF%E7%94%A8%E5%88%AB%E7%9A%84%E6%96%B9%E6%B3%95-%E9%9C%80%E8%A6%81%E8%A3%85%E7%9A%84%E6%98%AFDocker-CE%EF%BC%89"><span class="toc-number">1.5.1.</span> <span class="toc-text">1、Docker官网的脚本命令（当然也可以使用别的方法,需要装的是Docker-CE）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81%E5%88%9B%E5%BB%BA-x2F-etc-x2F-docker-x2F-daemon-json%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%EF%BC%8C%E8%8B%A5%E6%B2%A1%E6%9C%89%E8%AF%A5%E6%96%87%E4%BB%B6%E5%8D%B3%E7%9B%AE%E5%BD%95%EF%BC%8C%E5%88%99%E6%89%8B%E5%8A%A8%E5%88%9B%E5%BB%BA"><span class="toc-number">1.5.2.</span> <span class="toc-text">2、创建&#x2F;etc&#x2F;docker&#x2F;daemon.json配置文件，若没有该文件即目录，则手动创建</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81%E5%88%9B%E5%BB%BA-x2F-data-x2F-docker%E7%9B%AE%E5%BD%95"><span class="toc-number">1.5.3.</span> <span class="toc-text">3、创建&#x2F;data&#x2F;docker目录</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4%E3%80%81%E9%87%8D%E5%90%AFdocker%E6%9C%8D%E5%8A%A1"><span class="toc-number">1.5.4.</span> <span class="toc-text">4、重启docker服务</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94%E3%80%81%E5%9C%A8Warehouse%E4%B8%8A%E6%90%AD%E5%BB%BA%E7%A7%81%E6%9C%89%E9%95%9C%E5%83%8F%E4%BB%93%E5%BA%93"><span class="toc-number">1.6.</span> <span class="toc-text">五、在Warehouse上搭建私有镜像仓库</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E5%B0%86harbor%E5%8C%85%E6%94%BE%E5%9C%A8opt%E7%9B%AE%E5%BD%95%E4%B8%8B"><span class="toc-number">1.6.1.</span> <span class="toc-text">1、将harbor包放在opt目录下</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81%E8%A7%A3%E5%8E%8Bharbor%E5%8C%85"><span class="toc-number">1.6.2.</span> <span class="toc-text">2、解压harbor包</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81harbor%E7%9B%AE%E5%BD%95%E6%94%B9%E5%90%8D"><span class="toc-number">1.6.3.</span> <span class="toc-text">3、harbor目录改名</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4%E3%80%81%E5%88%9B%E5%BB%BAharbor%E8%BD%AF%E9%93%BE%E6%8E%A5"><span class="toc-number">1.6.4.</span> <span class="toc-text">4、创建harbor软链接</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5%E3%80%81%E5%A4%8D%E5%88%B6%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6harbor-yml"><span class="toc-number">1.6.5.</span> <span class="toc-text">5、复制配置文件harbor.yml</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6%E3%80%81%E7%BC%96%E8%BE%91barbor-yml%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-number">1.6.6.</span> <span class="toc-text">6、编辑barbor.yml配置文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7%E3%80%81%E5%88%9B%E5%BB%BA%E5%AE%89%E8%A3%85%E7%9B%AE%E5%BD%95"><span class="toc-number">1.6.7.</span> <span class="toc-text">7、创建安装目录</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8%E3%80%81%E5%AE%89%E8%A3%85docker-compose"><span class="toc-number">1.6.8.</span> <span class="toc-text">8、安装docker-compose</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9%E3%80%81%E6%89%A7%E8%A1%8Charbor%E7%9A%84install-sh%E5%AE%89%E8%A3%85%E8%84%9A%E6%9C%AC"><span class="toc-number">1.6.9.</span> <span class="toc-text">9、执行harbor的install.sh安装脚本</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10%E3%80%81docker-ps%E6%9F%A5%E7%9C%8B"><span class="toc-number">1.6.10.</span> <span class="toc-text">10、docker ps查看</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11%E3%80%81%E5%AE%89%E8%A3%85nginx"><span class="toc-number">1.6.11.</span> <span class="toc-text">11、安装nginx</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12%E3%80%81%E9%85%8D%E7%BD%AEnginx%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6-x2F-etc-x2F-nginx-x2F-conf-d-x2F-harbor-example-com-conf"><span class="toc-number">1.6.12.</span> <span class="toc-text">12、配置nginx配置文件&#x2F;etc&#x2F;nginx&#x2F;conf.d&#x2F;harbor.example.com.conf</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13%E3%80%81%E5%90%AF%E5%8A%A8nginx"><span class="toc-number">1.6.13.</span> <span class="toc-text">13、启动nginx</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#14%E3%80%81%E9%85%8D%E7%BD%AEDNS%E6%9C%8D%E5%8A%A1%E5%99%A8%EF%BC%8C%E5%B0%86harbor%E4%B8%9A%E5%8A%A1%E5%9F%9F%E5%8A%A0%E5%85%A5%E8%BF%9B%E5%8E%BB"><span class="toc-number">1.6.14.</span> <span class="toc-text">14、配置DNS服务器，将harbor业务域加入进去</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#15%E3%80%81%E9%87%8D%E5%90%AFDNS%E6%9C%8D%E5%8A%A1%E5%99%A8"><span class="toc-number">1.6.15.</span> <span class="toc-text">15、重启DNS服务器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#16%E3%80%81%E7%94%A8%E6%B5%8F%E8%A7%88%E5%99%A8%E6%89%93%E5%BC%80harbor-example-com-%E6%89%93%E5%BC%80%E7%BD%91%E7%AB%99%E7%9A%84%E4%B8%BB%E6%9C%BA%E8%A6%81%E9%85%8D%E7%BD%AE%E5%AF%B9%E5%BA%94%E7%9A%84DNS%E6%9C%8D%E5%8A%A1%E5%99%A8"><span class="toc-number">1.6.16.</span> <span class="toc-text">16、用浏览器打开harbor.example.com (打开网站的主机要配置对应的DNS服务器)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#17%E3%80%81%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AApublic%E9%A1%B9%E7%9B%AE"><span class="toc-number">1.6.17.</span> <span class="toc-text">17、创建一个public项目</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#18%E3%80%81pull%E4%B8%80%E4%B8%AAnginx%E9%95%9C%E5%83%8F"><span class="toc-number">1.6.18.</span> <span class="toc-text">18、pull一个nginx镜像</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#19%E3%80%81%E7%BB%99%E8%BF%99%E4%B8%AA%E9%95%9C%E5%83%8F%E6%89%93%E6%A0%87%E7%AD%BE"><span class="toc-number">1.6.19.</span> <span class="toc-text">19、给这个镜像打标签</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#20%E3%80%81docker-login%E7%99%BB%E5%BD%95harbor%E7%A7%81%E6%9C%89%E4%BB%93%E5%BA%93"><span class="toc-number">1.6.20.</span> <span class="toc-text">20、docker login登录harbor私有仓库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#21%E3%80%81%E5%B0%86%E4%B9%8B%E5%89%8D%E6%89%93%E6%A0%87%E7%AD%BE%E7%9A%84%E9%95%9C%E5%83%8F%E4%BC%A0%E5%88%B0%E7%A7%81%E6%9C%89%E4%BB%93%E5%BA%93%E4%B8%8A"><span class="toc-number">1.6.21.</span> <span class="toc-text">21、将之前打标签的镜像传到私有仓库上</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#22%E3%80%81%E5%9C%A8web%E7%AB%AF%E6%9F%A5%E7%9C%8B%EF%BC%8C%E7%A1%AE%E8%AE%A4%E6%98%AF%E5%90%A6%E5%B7%B2%E7%BB%8F%E4%B8%8A%E4%BC%A0"><span class="toc-number">1.6.22.</span> <span class="toc-text">22、在web端查看，确认是否已经上传</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AD%E3%80%81%E6%AD%A3%E5%BC%8F%E6%90%AD%E5%BB%BAK8S"><span class="toc-number">1.7.</span> <span class="toc-text">六、正式搭建K8S</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E8%A3%85etcd"><span class="toc-number">1.8.</span> <span class="toc-text">安装etcd</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81CFSS%E4%B8%8A%E9%85%8D%E7%BD%AE%E8%AF%81%E4%B9%A6%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%EF%BC%8C-x2F-opt-x2F-certs%E7%9B%AE%E5%BD%95%E4%B8%8B%E5%88%9B%E5%BB%BA%E4%BB%A5%E4%B8%8B%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6ca-config-json"><span class="toc-number">1.8.1.</span> <span class="toc-text">1、CFSS上配置证书配置文件，&#x2F;opt&#x2F;certs目录下创建以下配置文件ca-config.json</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81%E5%88%9B%E5%BB%BAetcd%E8%AF%81%E4%B9%A6%E8%AF%B7%E6%B1%82%E6%96%87%E4%BB%B6%EF%BC%8C%E5%9C%A8-x2F-opt-x2F-certs%E7%9B%AE%E5%BD%95%E4%B8%8B%E5%88%9B%E5%BB%BA%E4%BB%A5%E4%B8%8B%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6etcd-peer-csr-json"><span class="toc-number">1.8.2.</span> <span class="toc-text">2、创建etcd证书请求文件，在&#x2F;opt&#x2F;certs目录下创建以下配置文件etcd-peer-csr.json</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81%E5%BC%80%E5%A7%8B%E7%AD%BE%E5%8F%91etcd%E7%9A%84%E8%AF%81%E4%B9%A6"><span class="toc-number">1.8.3.</span> <span class="toc-text">3、开始签发etcd的证书</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4%E3%80%81%E5%9C%A8master%E8%8A%82%E7%82%B9%E4%B8%8A%E5%88%9B%E5%BB%BAetcd%E7%94%A8%E6%88%B7"><span class="toc-number">1.8.4.</span> <span class="toc-text">4、在master节点上创建etcd用户</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5%E3%80%81%E4%B8%8B%E8%BD%BDetcd%E8%BD%AF%E4%BB%B6"><span class="toc-number">1.8.5.</span> <span class="toc-text">5、下载etcd软件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6%E3%80%81%E8%A7%A3%E5%8E%8B%E3%80%81%E9%87%8D%E5%91%BD%E5%90%8D%E3%80%81%E8%BD%AF%E8%BF%9E%E6%8E%A5"><span class="toc-number">1.8.6.</span> <span class="toc-text">6、解压、重命名、软连接</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7%E3%80%81%E5%88%9B%E5%BB%BAetcd%E7%9B%AE%E5%BD%95%E5%8F%8A%E8%AF%81%E4%B9%A6%E7%9B%AE%E5%BD%95"><span class="toc-number">1.8.7.</span> <span class="toc-text">7、创建etcd目录及证书目录</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8%E3%80%81%E5%B0%86CFSS%E8%AF%81%E4%B9%A6%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8A%E7%9A%84%E8%AF%81%E4%B9%A6%E5%92%8C%E7%A7%81%E9%92%A5%E5%A4%8D%E5%88%B6%E5%88%B0-x2F-opt-x2F-etcd-x2F-certs%E7%9B%AE%E5%BD%95"><span class="toc-number">1.8.8.</span> <span class="toc-text">8、将CFSS证书服务器上的证书和私钥复制到&#x2F;opt&#x2F;etcd&#x2F;certs目录</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9%E3%80%81%E9%85%8D%E7%BD%AEetcd-%E7%9A%84%E5%90%AF%E5%8A%A8%E8%84%9A%E6%9C%ACetcd-server-startup-sh"><span class="toc-number">1.8.9.</span> <span class="toc-text">9、配置etcd 的启动脚本etcd-server-startup.sh</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10%E3%80%81%E9%85%8D%E7%BD%AE%E5%B1%9E%E4%B8%BB%E5%B1%9E%E7%BB%84%E5%92%8C%E5%90%AF%E5%8A%A8%E8%84%9A%E6%9C%AC%E6%89%A7%E8%A1%8C%E6%9D%83%E9%99%90"><span class="toc-number">1.8.10.</span> <span class="toc-text">10、配置属主属组和启动脚本执行权限</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11%E3%80%81%E5%AE%89%E8%A3%85supervisor%E7%AE%A1%E7%90%86%E5%90%AF%E5%8A%A8%E8%84%9A%E6%9C%AC"><span class="toc-number">1.8.11.</span> <span class="toc-text">11、安装supervisor管理启动脚本</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12%E3%80%81%E9%85%8D%E7%BD%AE%E7%9A%84etcd-supervisor%E7%9A%84ini%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6-x2F-etc-x2F-supervisord-d-x2F-etcd-server-ini"><span class="toc-number">1.8.12.</span> <span class="toc-text">12、配置的etcd supervisor的ini配置文件&#x2F;etc&#x2F;supervisord.d&#x2F;etcd-server.ini</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13%E3%80%81%E5%90%AF%E5%8A%A8etcd%E6%9C%8D%E5%8A%A1%E5%B9%B6%E6%A3%80%E6%9F%A5"><span class="toc-number">1.8.13.</span> <span class="toc-text">13、启动etcd服务并检查</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#14%E3%80%81%E5%90%AF%E5%8A%A8%E6%88%96%E8%80%85%E5%85%B3%E9%97%ADetcd%E6%9C%8D%E5%8A%A1"><span class="toc-number">1.8.14.</span> <span class="toc-text">14、启动或者关闭etcd服务</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#15%E3%80%81%E6%A3%80%E6%9F%A5etcd%E6%98%AF%E5%90%A6%E5%81%A5%E5%BA%B7"><span class="toc-number">1.8.15.</span> <span class="toc-text">15、检查etcd是否健康</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#16%E3%80%81%E6%9F%A5%E7%9C%8B%E5%BD%93%E5%89%8Dleader"><span class="toc-number">1.8.16.</span> <span class="toc-text">16、查看当前leader</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#17%E3%80%81%E8%8B%A5%E6%83%B3%E7%A7%BB%E4%BA%A4leader"><span class="toc-number">1.8.17.</span> <span class="toc-text">17、若想移交leader</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E8%A3%85apiserver"><span class="toc-number">1.9.</span> <span class="toc-text">安装apiserver</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E8%A7%A3%E5%8E%8Bkubernetes"><span class="toc-number">1.9.1.</span> <span class="toc-text">1、解压kubernetes</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81%E6%9F%A5%E7%9C%8B%E8%A7%A3%E5%8E%8B%E5%90%8Eserver%E7%9B%AE%E5%BD%95%E4%B8%8B%E7%9A%84%E6%96%87%E4%BB%B6"><span class="toc-number">1.9.2.</span> <span class="toc-text">2、查看解压后server目录下的文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81%E5%88%9B%E5%BB%BAcerts%E3%80%81conf%E7%9B%AE%E5%BD%95"><span class="toc-number">1.9.3.</span> <span class="toc-text">3、创建certs、conf目录</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4%E3%80%81%E7%94%9F%E6%88%90%E8%AF%81%E4%B9%A6csr%E7%9A%84json%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-number">1.9.4.</span> <span class="toc-text">4、生成证书csr的json配置文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5%E3%80%81%E7%94%9F%E6%88%90client%E8%AF%81%E4%B9%A6%E6%96%87%E4%BB%B6"><span class="toc-number">1.9.5.</span> <span class="toc-text">5、生成client证书文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6%E3%80%81%E9%85%8D%E7%BD%AEkube-apiserver%E8%AF%81%E4%B9%A6csr%E7%9A%84json%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-number">1.9.6.</span> <span class="toc-text">6、配置kube-apiserver证书csr的json配置文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7%E3%80%81%E7%94%9F%E6%88%90kube-apiserver%E8%AF%81%E4%B9%A6%E6%96%87%E4%BB%B6"><span class="toc-number">1.9.7.</span> <span class="toc-text">7、生成kube-apiserver证书文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8%E3%80%81%E6%8B%B7%E8%B4%9D%E8%AF%81%E4%B9%A6%E6%96%87%E4%BB%B6%E5%88%B0-x2F-opt-x2F-kubernetes-x2F-server-x2F-bin-x2F-certs%E7%9B%AE%E5%BD%95%E4%B8%8B"><span class="toc-number">1.9.8.</span> <span class="toc-text">8、拷贝证书文件到&#x2F;opt&#x2F;kubernetes&#x2F;server&#x2F;bin&#x2F;certs目录下</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9%E3%80%81%E5%88%9B%E5%BB%BAapiserver%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6-x2F-opt-x2F-kubernetes-x2F-server-x2F-bin-x2F-conf-x2F-audit-yaml"><span class="toc-number">1.9.9.</span> <span class="toc-text">9、创建apiserver配置文件 &#x2F;opt&#x2F;kubernetes&#x2F;server&#x2F;bin&#x2F;conf&#x2F;audit.yaml</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10%E3%80%81api%E5%90%AF%E5%8A%A8%E8%84%9A%E6%9C%AC%E6%96%87%E4%BB%B6kube-apiserver-sh"><span class="toc-number">1.9.10.</span> <span class="toc-text">10、api启动脚本文件kube-apiserver.sh</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11%E3%80%81%E7%BB%99kube-apiserver-sh-%E6%B7%BB%E5%8A%A0%E5%8F%AF%E6%89%A7%E8%A1%8C%E6%9D%83%E9%99%90%EF%BC%8C%E5%8D%B3%E6%89%A7%E8%A1%8C%E7%9B%AE%E5%BD%95"><span class="toc-number">1.9.11.</span> <span class="toc-text">11、给kube-apiserver.sh 添加可执行权限，即执行目录</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12%E3%80%81%E9%85%8D%E7%BD%AEsupervisord%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6-x2F-etc-x2F-supervisord-d-x2F-kube-apiserver-ini"><span class="toc-number">1.9.12.</span> <span class="toc-text">12、配置supervisord配置文件&#x2F;etc&#x2F;supervisord.d&#x2F;kube-apiserver.ini</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13%E3%80%81%E5%90%AF%E5%8A%A8apiserver%E6%9C%8D%E5%8A%A1"><span class="toc-number">1.9.13.</span> <span class="toc-text">13、启动apiserver服务</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#14%E3%80%81%E6%9F%A5%E7%9C%8B%E7%AB%AF%E5%8F%A3"><span class="toc-number">1.9.14.</span> <span class="toc-text">14、查看端口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#15%E3%80%81%E6%9F%A5%E7%9C%8B%E6%97%A5%E5%BF%97%E5%8F%AF%E4%BB%A5%E7%9C%8B%E5%88%B0%E5%BD%93%E5%89%8D%E7%9A%84master"><span class="toc-number">1.9.15.</span> <span class="toc-text">15、查看日志可以看到当前的master</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Master%E9%83%A8%E7%BD%B2%E5%9B%9B%E5%B1%82%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86"><span class="toc-number">1.10.</span> <span class="toc-text">Master部署四层反向代理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E5%AE%89%E8%A3%85nginx%E5%92%8Ckeepalived"><span class="toc-number">1.10.1.</span> <span class="toc-text">1、安装nginx和keepalived</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81%E4%BF%AE%E6%94%B9nginx%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6-x2F-etc-x2F-nginx-x2F-nginx-conf"><span class="toc-number">1.10.2.</span> <span class="toc-text">2、修改nginx配置文件&#x2F;etc&#x2F;nginx&#x2F;nginx.conf</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81%E5%90%AF%E5%8A%A8nginx"><span class="toc-number">1.10.3.</span> <span class="toc-text">3、启动nginx</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4%E3%80%81%E6%9F%A5%E7%9C%8Bnginx%E7%9A%847443%E7%AB%AF%E5%8F%A3%E6%98%AF%E5%90%A6%E5%B7%B2%E7%BB%8F%E8%B5%B7%E6%9D%A5"><span class="toc-number">1.10.4.</span> <span class="toc-text">4、查看nginx的7443端口是否已经起来</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5%E3%80%81%E9%85%8D%E7%BD%AE-x2F-etc-x2F-keepalived-x2F-check-port-sh-%E7%9B%91%E6%8E%A7%E7%AB%AF%E5%8F%A3%E8%84%9A%E6%9C%AC"><span class="toc-number">1.10.5.</span> <span class="toc-text">5、配置&#x2F;etc&#x2F;keepalived&#x2F;check_port.sh  监控端口脚本</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6%E3%80%81%E7%9B%91%E5%90%AC%E7%AB%AF%E5%8F%A3%E8%84%9A%E6%9C%AC%E6%B7%BB%E5%8A%A0%E6%89%A7%E8%A1%8C%E6%9D%83%E9%99%90"><span class="toc-number">1.10.6.</span> <span class="toc-text">6、监听端口脚本添加执行权限</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7%E3%80%81%E9%85%8D%E7%BD%AEkeepalived-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6etc-x2F-keepalived-x2F-keepalived-conf"><span class="toc-number">1.10.7.</span> <span class="toc-text">7、配置keepalived 配置文件etc&#x2F;keepalived&#x2F;keepalived.conf</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8%E3%80%81%E5%90%AF%E5%8A%A8keepalived"><span class="toc-number">1.10.8.</span> <span class="toc-text">8、启动keepalived</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9%E3%80%81%E6%9F%A5%E7%9C%8B%E8%99%9A%E6%8B%9F%E7%BD%91%E5%8D%A1%E6%98%AF%E5%90%A6%E5%B7%B2%E7%BB%8F%E8%B5%B7%E6%9D%A5"><span class="toc-number">1.10.9.</span> <span class="toc-text">9、查看虚拟网卡是否已经起来</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Node%E9%83%A8%E7%BD%B2kube-controller-manager"><span class="toc-number">1.11.</span> <span class="toc-text">Node部署kube-controller-manager</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E5%88%9B%E5%BB%BA%E5%90%AF%E5%8A%A8%E8%84%9A%E6%9C%AC-x2F-opt-x2F-kubernetes-x2F-server-x2F-bin-x2F-kube-controller-manager-sh"><span class="toc-number">1.11.1.</span> <span class="toc-text">1、创建启动脚本&#x2F;opt&#x2F;kubernetes&#x2F;server&#x2F;bin&#x2F;kube-controller-manager.sh</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81%E6%8E%88%E6%9D%83%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90%E3%80%81%E5%88%9B%E5%BB%BA%E7%9B%AE%E5%BD%95"><span class="toc-number">1.11.2.</span> <span class="toc-text">2、授权文件权限、创建目录</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81%E5%88%9B%E5%BB%BAsupervisor%E9%85%8D%E7%BD%AE-x2F-etc-x2F-supervisord-d-x2F-kube-conntroller-manager-ini"><span class="toc-number">1.11.3.</span> <span class="toc-text">3、创建supervisor配置&#x2F;etc&#x2F;supervisord.d&#x2F;kube-conntroller-manager.ini</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4%E3%80%81%E6%A3%80%E6%9F%A5%E5%B9%B6%E5%90%AF%E5%8A%A8%E6%9C%8D%E5%8A%A1"><span class="toc-number">1.11.4.</span> <span class="toc-text">4、检查并启动服务</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%83%A8%E7%BD%B2kube-scheduler"><span class="toc-number">1.12.</span> <span class="toc-text">部署kube-scheduler</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E5%88%9B%E5%BB%BAkube-scheduler%E5%90%AF%E5%8A%A8%E8%84%9A%E6%9C%AC"><span class="toc-number">1.12.1.</span> <span class="toc-text">1、创建kube-scheduler启动脚本</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81%E6%8E%88%E6%9D%83%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90%E3%80%81%E5%88%9B%E5%BB%BA%E7%9B%AE%E5%BD%95-1"><span class="toc-number">1.12.2.</span> <span class="toc-text">2、授权文件权限、创建目录</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81%E5%88%9B%E5%BB%BAsupervisor%E9%85%8D%E7%BD%AE-x2F-etc-x2F-supervisord-d-x2F-kube-scheduler-ini"><span class="toc-number">1.12.3.</span> <span class="toc-text">3、创建supervisor配置&#x2F;etc&#x2F;supervisord.d&#x2F;kube-scheduler.ini</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4%E3%80%81%E6%A3%80%E6%9F%A5%E5%B9%B6%E5%90%AF%E5%8A%A8%E6%9C%8D%E5%8A%A1-1"><span class="toc-number">1.12.4.</span> <span class="toc-text">4、检查并启动服务</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A3%80%E6%9F%A5%E8%8A%82%E7%82%B9kube"><span class="toc-number">1.13.</span> <span class="toc-text">检查节点kube</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E5%B0%86kubectl%E5%91%BD%E4%BB%A4%E8%BD%AF%E9%93%BE%E6%8E%A5%E5%88%B0-x2F-usr-x2F-bin%E4%B8%8B"><span class="toc-number">1.13.1.</span> <span class="toc-text">1、将kubectl命令软链接到&#x2F;usr&#x2F;bin下</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81%E6%A3%80%E6%9F%A5%E8%8A%82%E7%82%B9"><span class="toc-number">1.13.2.</span> <span class="toc-text">2、检查节点</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%83%A8%E7%BD%B2kubelet"><span class="toc-number">1.14.</span> <span class="toc-text">部署kubelet</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E5%88%9B%E5%BB%BA%E7%94%9F%E6%88%90%E8%AF%81%E4%B9%A6csr%E7%9A%84json%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6kubelet-csr-json"><span class="toc-number">1.14.1.</span> <span class="toc-text">1、创建生成证书csr的json配置文件kubelet-csr.json</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81%E7%94%9F%E6%88%90kubelet%E8%AF%81%E4%B9%A6%E6%96%87%E4%BB%B6"><span class="toc-number">1.14.2.</span> <span class="toc-text">2、生成kubelet证书文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81%E6%8B%B7%E8%B4%9D%E8%AF%81%E4%B9%A6%E8%87%B3%E5%90%84%E4%B8%AA%E8%8A%82%E7%82%B9%E7%9A%84-x2F-opt-x2F-kubernetes-x2F-server-x2F-bin-x2F-certs%E7%9B%AE%E5%BD%95%E4%B8%8B"><span class="toc-number">1.14.3.</span> <span class="toc-text">3、拷贝证书至各个节点的&#x2F;opt&#x2F;kubernetes&#x2F;server&#x2F;bin&#x2F;certs目录下</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4%E3%80%81%E5%88%9B%E5%BB%BA%E9%85%8D%E7%BD%AE"><span class="toc-number">1.14.4.</span> <span class="toc-text">4、创建配置</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#set-cluster"><span class="toc-number">1.14.4.1.</span> <span class="toc-text">set-cluster</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#set-credentials"><span class="toc-number">1.14.4.2.</span> <span class="toc-text">set-credentials</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#set-context"><span class="toc-number">1.14.4.3.</span> <span class="toc-text">set-context</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#use-context"><span class="toc-number">1.14.4.4.</span> <span class="toc-text">use-context</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#k8s-node-yaml-x2F-opt-x2F-kubernetes-x2F-server-x2F-bin-x2F-conf-x2F-k8s-node-yaml"><span class="toc-number">1.14.4.5.</span> <span class="toc-text">k8s-node.yaml (&#x2F;opt&#x2F;kubernetes&#x2F;server&#x2F;bin&#x2F;conf&#x2F;k8s-node.yaml)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BA%94%E7%94%A8%E8%B5%84%E6%BA%90%E9%85%8D%E7%BD%AE"><span class="toc-number">1.14.4.6.</span> <span class="toc-text">应用资源配置</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B%E9%9B%86%E7%BE%A4%E8%A7%92%E8%89%B2%E5%92%8C%E8%A7%92%E8%89%B2%E5%B1%9E%E6%80%A7"><span class="toc-number">1.14.4.7.</span> <span class="toc-text">查看集群角色和角色属性</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5%E3%80%81%E5%A4%8D%E5%88%B6kubelet-kubeconfig%E6%96%87%E4%BB%B6%E8%87%B3%E5%85%B6%E4%BB%96%E8%8A%82%E7%82%B9%E7%9A%84-x2F-opt-x2F-kubernetes-x2F-server-x2F-bin-x2F-conf-x2F-%E7%9B%AE%E5%BD%95%E4%B8%8B"><span class="toc-number">1.14.5.</span> <span class="toc-text">5、复制kubelet.kubeconfig文件至其他节点的&#x2F;opt&#x2F;kubernetes&#x2F;server&#x2F;bin&#x2F;conf&#x2F;目录下</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6%E3%80%81%E5%9C%A8%E7%A7%81%E6%9C%89%E9%95%9C%E5%83%8F%E4%BB%93%E5%BA%93%E8%8A%82%E7%82%B9%E8%8E%B7%E5%8F%96pause%E5%9F%BA%E7%A1%80%E9%95%9C%E5%83%8F"><span class="toc-number">1.14.6.</span> <span class="toc-text">6、在私有镜像仓库节点获取pause基础镜像</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%99%BB%E5%BD%95%E7%A7%81%E6%9C%89%E9%95%9C%E5%83%8F%E6%BA%90"><span class="toc-number">1.14.6.1.</span> <span class="toc-text">登录私有镜像源</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8B%89%E5%8F%96pause%E9%95%9C%E5%83%8F%E6%BA%90"><span class="toc-number">1.14.6.2.</span> <span class="toc-text">拉取pause镜像源</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8Bpause%E9%95%9C%E5%83%8F"><span class="toc-number">1.14.6.3.</span> <span class="toc-text">查看pause镜像</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%99puase%E9%95%9C%E5%83%8F%E6%89%93%E6%A0%87%E7%AD%BE"><span class="toc-number">1.14.6.4.</span> <span class="toc-text">给puase镜像打标签</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B0%86puase%E9%95%9C%E5%83%8F%E6%8E%A8%E5%88%B0%E7%A7%81%E6%9C%89%E9%95%9C%E5%83%8F%E6%BA%90harbor%E4%B8%AD"><span class="toc-number">1.14.6.5.</span> <span class="toc-text">将puase镜像推到私有镜像源harbor中</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8Bharbor%E7%BD%91%E9%A1%B5%E7%AB%AF"><span class="toc-number">1.14.6.6.</span> <span class="toc-text">查看harbor网页端</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7%E3%80%81%E5%88%9B%E5%BB%BAkubelet%E5%90%AF%E5%8A%A8%E8%84%9A%E6%9C%AC"><span class="toc-number">1.14.7.</span> <span class="toc-text">7、创建kubelet启动脚本</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8%E3%80%81%E6%8E%88%E4%BA%88%E5%8F%AF%E6%89%A7%E8%A1%8C%E6%9D%83%E9%99%90%E5%92%8C%E5%88%9B%E5%BB%BA%E7%9B%AE%E5%BD%95"><span class="toc-number">1.14.8.</span> <span class="toc-text">8、授予可执行权限和创建目录</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9%E3%80%81%E5%88%9B%E5%BB%BAsupervisor%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-number">1.14.9.</span> <span class="toc-text">9、创建supervisor配置文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10%E3%80%81%E5%90%AF%E5%8A%A8%E6%9C%8D%E5%8A%A1%E5%B9%B6%E6%A3%80%E6%9F%A5"><span class="toc-number">1.14.10.</span> <span class="toc-text">10、启动服务并检查</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11%E3%80%81%E5%BD%93%E6%89%80%E6%9C%89%E8%8A%82%E7%82%B9%E5%90%AF%E5%8A%A8%E5%90%8E%EF%BC%8C%E4%BD%BF%E7%94%A8kubectl-get-nodes%E8%8E%B7%E5%8F%96%E8%8A%82%E7%82%B9%E4%BF%A1%E6%81%AF"><span class="toc-number">1.14.11.</span> <span class="toc-text">11、当所有节点启动后，使用kubectl get nodes获取节点信息</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12%E3%80%81%E7%BB%99%E6%89%80%E6%9C%89%E8%8A%82%E7%82%B9%E6%89%93%E4%B8%8A%E6%A0%87%E7%AD%BE"><span class="toc-number">1.14.12.</span> <span class="toc-text">12、给所有节点打上标签</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%83%A8%E7%BD%B2kube-proxy"><span class="toc-number">1.15.</span> <span class="toc-text">部署kube-proxy</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E5%88%9B%E5%BB%BA%E7%94%9F%E6%88%90%E8%AF%81%E4%B9%A6%E7%AD%BE%E5%90%8Dcsr%E7%9A%84json%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-number">1.15.1.</span> <span class="toc-text">1、创建生成证书签名csr的json配置文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81%E7%94%9F%E6%88%90kube-proxy%E8%AF%81%E4%B9%A6%E6%96%87%E4%BB%B6"><span class="toc-number">1.15.2.</span> <span class="toc-text">2、生成kube-proxy证书文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81%E5%B0%86%E8%AF%81%E4%B9%A6%E6%96%87%E4%BB%B6%E5%8F%91%E9%80%81%E8%87%B3%E5%90%84%E4%B8%AA%E8%8A%82%E7%82%B9-x2F-opt-x2F-kubernetes-x2F-server-x2F-bin-x2F-certs%E7%9B%AE%E5%BD%95%E4%B8%8B"><span class="toc-number">1.15.3.</span> <span class="toc-text">3、将证书文件发送至各个节点&#x2F;opt&#x2F;kubernetes&#x2F;server&#x2F;bin&#x2F;certs目录下</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4%E3%80%81%E5%88%9B%E5%BB%BA%E9%85%8D%E7%BD%AE-1"><span class="toc-number">1.15.4.</span> <span class="toc-text">4、创建配置</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#set-cluster-1"><span class="toc-number">1.15.4.1.</span> <span class="toc-text">set-cluster</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#set-credentials-1"><span class="toc-number">1.15.4.2.</span> <span class="toc-text">set-credentials</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#set-context-1"><span class="toc-number">1.15.4.3.</span> <span class="toc-text">set-context</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#use-context-1"><span class="toc-number">1.15.4.4.</span> <span class="toc-text">use-context</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5%E3%80%81%E5%A4%8D%E5%88%B6kube-proxy-kubeconfig%E6%96%87%E4%BB%B6%E8%87%B3%E5%85%B6%E4%BB%96%E8%8A%82%E7%82%B9%E7%9A%84-x2F-opt-x2F-kubernetes-x2F-server-x2F-bin-x2F-conf-x2F-%E7%9B%AE%E5%BD%95%E4%B8%8B"><span class="toc-number">1.15.5.</span> <span class="toc-text">5、复制kube-proxy.kubeconfig文件至其他节点的&#x2F;opt&#x2F;kubernetes&#x2F;server&#x2F;bin&#x2F;conf&#x2F;目录下</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6%E3%80%81%E5%88%9B%E5%BB%BAipvs%E8%84%9A%E6%9C%AC"><span class="toc-number">1.15.6.</span> <span class="toc-text">6、创建ipvs脚本</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7%E3%80%81%E6%89%A7%E8%A1%8Cipvs%E8%84%9A%E6%9C%AC"><span class="toc-number">1.15.7.</span> <span class="toc-text">7、执行ipvs脚本</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8%E3%80%81%E6%9F%A5%E7%9C%8Bipvs%E6%A8%A1%E5%9D%97%E6%98%AF%E5%90%A6%E5%8A%A0%E8%BD%BD"><span class="toc-number">1.15.8.</span> <span class="toc-text">8、查看ipvs模块是否加载</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9%E3%80%81%E5%88%9B%E5%BB%BAkube-proxy%E5%90%AF%E5%8A%A8%E8%84%9A%E6%9C%AC"><span class="toc-number">1.15.9.</span> <span class="toc-text">9、创建kube-proxy启动脚本</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10%E3%80%81%E6%8E%88%E6%9D%83%E3%80%81%E5%88%9B%E5%BB%BA%E7%9B%AE%E5%BD%95"><span class="toc-number">1.15.10.</span> <span class="toc-text">10、授权、创建目录</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11%E3%80%81%E5%88%9B%E5%BB%BAsupervisor%E9%85%8D%E7%BD%AE"><span class="toc-number">1.15.11.</span> <span class="toc-text">11、创建supervisor配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12%E3%80%81%E5%90%AF%E5%8A%A8%E6%9C%8D%E5%8A%A1%E5%B9%B6%E6%A3%80%E6%9F%A5"><span class="toc-number">1.15.12.</span> <span class="toc-text">12、启动服务并检查</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13%E3%80%81%E5%AE%89%E8%A3%85ipvsadm"><span class="toc-number">1.15.13.</span> <span class="toc-text">13、安装ipvsadm</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#14%E3%80%81%E4%BD%BF%E7%94%A8ipvsadm%E5%91%BD%E4%BB%A4%E6%9F%A5%E7%9C%8B%E8%B7%AF%E7%94%B1%E9%85%8D%E7%BD%AE"><span class="toc-number">1.15.14.</span> <span class="toc-text">14、使用ipvsadm命令查看路由配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#15%E3%80%81%E4%BD%BF%E7%94%A8kubectl%E5%91%BD%E4%BB%A4%E6%9F%A5%E7%9C%8B"><span class="toc-number">1.15.15.</span> <span class="toc-text">15、使用kubectl命令查看</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%AA%8C%E8%AF%81kubernetes%E9%9B%86%E7%BE%A4"><span class="toc-number">1.16.</span> <span class="toc-text">验证kubernetes集群</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E5%9C%A8node1%E4%B8%AD%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E8%B5%84%E6%BA%90%E9%85%8D%E7%BD%AE%E6%B8%85%E5%8D%95"><span class="toc-number">1.16.1.</span> <span class="toc-text">1、在node1中创建一个资源配置清单</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81%E5%BA%94%E7%94%A8%E8%B5%84%E6%BA%90%E9%85%8D%E7%BD%AE%EF%BC%8C%E5%B9%B6%E6%A3%80%E6%9F%A5"><span class="toc-number">1.16.2.</span> <span class="toc-text">2、应用资源配置，并检查</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9C%A8node1%E4%B8%AD%E5%BA%94%E7%94%A8%E8%B5%84%E6%BA%90%E9%85%8D%E7%BD%AE"><span class="toc-number">1.16.2.1.</span> <span class="toc-text">在node1中应用资源配置</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%AF%8F%E6%AC%A1%E9%87%8D%E5%90%AF%E9%9B%86%E7%BE%A4%E9%9C%80%E8%A6%81%E5%90%AF%E5%8A%A8%E7%9A%84%E5%9C%B0%E6%96%B9"><span class="toc-number">1.17.</span> <span class="toc-text">每次重启集群需要启动的地方</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A3%80%E6%9F%A5%E9%85%8D%E7%BD%AE%E5%B9%B6%E5%90%AF%E5%8A%A8bind-9"><span class="toc-number">1.17.1.</span> <span class="toc-text">检查配置并启动bind 9</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%AF%E5%8A%A8nginx%EF%BC%8C%E9%93%BE%E6%8E%A5harbor"><span class="toc-number">1.17.2.</span> <span class="toc-text">启动nginx，链接harbor</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%9B%E5%B1%82%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86"><span class="toc-number">1.17.3.</span> <span class="toc-text">四层反向代理</span></a></li></ol></li></ol></li></ol>
        
    </div>
    <style>
        .left-col .switch-btn,
        .left-col .switch-area {
            display: none;
        }
        .toc-level-3 i,
        .toc-level-3 ol {
            display: none !important;
        }
    </style>

    <input type="button" id="tocButton" value="Hide"  title="Show or Hide Table of Contents">

    <script>
        yiliaConfig.toc = ["Hide", "Show", !!"false"];
    </script>



    
<div class="share">
    
        <div class="bdsharebuttonbox">
            <a href="#" class="fa fa-twitter bds_twi" data-cmd="twi" title="分享到推特"></a>
            <a href="#" class="fa fa-weibo bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a>
            <a href="#" class="fa fa-qq bds_sqq" data-cmd="sqq" title="分享给 QQ 好友"></a>
            <a href="#" class="fa fa-files-o bds_copy" data-cmd="copy" title="复制网址"></a>
            <a href="#" class="fa fa fa-envelope-o bds_mail" data-cmd="mail" title="通过邮件分享"></a>
            <a href="#" class="fa fa-weixin bds_weixin" data-cmd="weixin" title="生成文章二维码"></a>
            <a href="#" class="fa fa-share-alt bds_more" data-cmd="more"></i></a>
        </div>
        <script>
            window._bd_share_config={
                "common":{"bdSnsKey":{},"bdText":"K8S-Binary-Install　| Sevattal　","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"0","bdSize":"24"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];
        </script>
    

    
</div>







    




    <div class="scroll" id="post-nav-button">
        
            <a href="/2021/02/21/Java-SprintBoot-Error1/" title="Pre: Java-SprintBoot-Error1">
                <i class="fa fa-angle-left"></i>
            </a>
        

        <a title="Mini Archives"><i class="fa fa-bars"></i><i class="fa fa-times"></i></a>

        
            <a href="/2021/02/15/Oracle-Clean-Archivelog/" title="Next: Oracle-Clean-Archivelog">
                <i class="fa fa-angle-right"></i>
            </a>
        
    </div>

    <ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2023/04/04/Linux-Change-Root-Password-1/">Linux-Change-Root-Password-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2023/04/03/Linux-OpenSSH-Debain-Update-1/">Linux-OpenSSH-Debain-Update-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2023/03/30/Linux-Firewalld-Cmd-1/">Linux-Firewalld-Cmd-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2023/03/30/Linux-Disk-And-Dmsetup-1/">Linux-Disk-And-Dmsetup-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2023/03/13/Ansible-Base-Copy-Module-1/">Ansible-Base-Copy-Module-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2023/03/13/Ansible-Base-Module-1/">Ansible-Base-Module-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2023/03/13/Ansible-Base-Variable-1/">Ansible-Base-Variable-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2023/03/13/Ansible-Base-1/">Ansible-Base-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2023/03/10/Materialized-View-1/">Materialized-View-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2023/03/10/BigLogFile-Cut-1/">BigLogFile-Cut-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2023/01/05/Snmp-Base-1/">Snmp-Base-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/12/14/Linux-Disable-IPV6/">Linux-Disable-IPV6</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/12/14/DmDB-Docker-Install/">DmDB-Docker-Install</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/12/14/Neo4j-12-Python-Driver/">Neo4j-12-Python-Driver</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/12/14/Neo4j-11-Cypher-Function/">Neo4j-11-Cypher-Function</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/12/14/Neo4j-10-Update-Data/">Neo4j-10-Update-Data</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/12/14/Neo4j-9-Match-Data/">Neo4j-9-Match-Data</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/12/14/Neo4j-8-Projection-Filtering/">Neo4j-8-Projection-Filtering</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/12/14/Neo4j-7-Pattern/">Neo4j-7-Pattern</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/12/14/Neo4j-6-Cypher-Base/">Neo4j-6-Cypher-Base</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/12/14/Neo4j-5-BatchUpdate/">Neo4j-5-BatchUpdate</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/12/14/Neo4j-4-Net-Driver/">Neo4j-4-Net-Driver</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/12/14/Neo4j-3-Cypher-Query/">Neo4j-3-Cypher-Query</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/12/14/Neo4j-2-Graph-Theory/">Neo4j-2-Graph-Theory</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/12/14/Neo4j-1-Window-Install/">Neo4j-1-Window-Install</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/12/14/Window-Regedit/">Window-Regedit</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/12/14/CentOS-9-NetworkManger-1/">CentOS-9-NetworkManger-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/11/23/Hacking-Tool-Base-1/">Hacking-Tool-Base-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/11/18/Metasploit-Base-1/">Metasploit-Base-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/11/17/Script-Kiddies-Base-1/">Script-Kiddies-Base-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/11/17/Wireshark-Base-3/">Wireshark-Base-3</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/11/17/Wireshark-Base-2/">Wireshark-Base-2</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/11/17/Wireshark-Base-1/">Wireshark-Base-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/11/17/PE-Base-1/">PE-Base-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/11/17/Dos-Debug-Base-1/">Dos-Debug-Base-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/11/17/Linux-Clean-Log-1/">Linux-Clean-Log-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/11/17/WebSocket-Front-Code-1/">WebSocket-Front-Code-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/11/16/Nasm-Masm-Differ-1/">Nasm-Masm-Differ-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/11/16/Oracle-Linux-SqlPlus-Garbled-Code-1/">Oracle-Linux-SqlPlus-Garbled-Code-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/11/16/Nasm-Masm-Base-1/">Nasm-Masm-Base-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/07/28/Window-Cmd-Garbled-Code-Resolution-1/">Window-Cmd-Garbled-Code-Resolution-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/07/26/Oracle-Sys-Guid-Func-1/">Oracle-Sys_Guid-Func-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/07/26/Oracle-Achive-ORA-00257/">Oracle-Achive-ORA-00257</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/07/26/Oracle-User-Progress-1/">Oracle-User-Progress-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/07/26/Oracle-Container-Base-1/">Oracle-Container-Base-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/07/26/Oracle-Control-File-1/">Oracle-Control-File-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/07/07/Linux-K8S-Openssl-1/">Linux-K8S-Openssl-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/07/07/Linux-K8S-CFSSL-1/">Linux-K8S-CFSSL-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/07/07/Linux-Flannel-1/">Linux-Flannel-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/07/07/Linux-Calico-1/">Linux-Calico-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/07/07/Linux-Nginx-Ingress-1/">Linux-Nginx-Ingress-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/07/07/Linux-ipatables-DNAT-SNAT-1/">Linux-ipatables-DNAT-SNAT-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/07/07/Linux-ipatables-1/">Linux-ipatables-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/07/07/Oracle-Rman-Parameter-1/">Oracle-Rman-Parameter-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/07/07/Sublime-Markdown-1/">Sublime-Markdown-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/07/06/Jaspersoft-Parameter-1/">Jaspersoft-Parameter-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/07/06/Jaspersoft-Element-Details-1/">Jaspersoft-Element-Details-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/06/29/WeiBo-Batch-Delete-1/">WeiBo-Batch-Delete-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/06/29/Jaspersoft-Char-Trunc-1/">Jaspersoft-Char-Trunc-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/06/29/Oracle-RedoLog-Restore-1/">Oracle-RedoLog-Restore-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/06/23/Vue-Bind-Delay-Resolution-1/">Vue-Bind-Delay-Resolution-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/06/23/Java-Generate-Password-Dict-1/">Java-Generate-Password-Dict-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/06/23/Vue-Convert-10-To-34-Example-1/">Vue-Convert-10-To-34-Example-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/06/15/Java-Primordial-Text-File-Handle-1/">Java-Primordial-Text-File-Handle-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/06/15/Winget-Base-1/">Winget-Base-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/05/24/Kali-Brute-Force-Wifi-1/">Kali-Brute-Force-Wifi-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/05/17/Oracle-Func-Table-1/">Oracle-Func-Table-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/05/17/Oracle-ORA-03133-ERROR-1/">Oracle-ORA-03133-ERROR-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/05/14/Jasper-Reports-Server-Install-1/">Jasper-Reports-Server-Install-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/04/30/Video-Clip-Stick-Point-Base-1/">Video-Clip-Stick-Point-Base-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/04/30/Video-Clip-Lens-Length-Base-1/">Video-Clip-Lens-Length-Base-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/04/30/Video-Clip-Structure-Base-1/">Video-Clip-Structure-Base-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/04/26/FFmpeg-Base-1/">FFmpeg-Base-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/04/05/Network-NAT-DHCP-PPP-1/">Network-NAT-DHCP-PPP-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/04/05/Network-Switch-STP-1/">Network-Switch-STP-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/04/04/Network-Switch-VTP-1/">Network-Switch-VTP-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/04/04/Network-Switch-VLAN-1/">Network-Switch-VLAN-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/04/03/Network-Route-ACL-1/">Network-Route-ACL-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/04/03/Network-Route-EIGRP-1/">Network-Route-EIGRP-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/04/03/Network-Route-OSPF-2/">Network-Route-OSPF-2</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/04/03/Network-Route-OSPF-1/">Network-Route-OSPF-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/04/02/Network-Route-Rip-1/">Network-Route-Rip-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/04/02/Network-Route-Base-1/">Network-Route-Base-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/03/30/Oracle-Listener-1/">Oracle-Listener-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/03/22/Google-Hacking-Base-1/">Google-Hacking-Base-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/03/22/Oracle-Job-Base-1/">Oracle-Job-Base-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/03/21/Linux-Crontab-1/">Linux-Crontab-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/03/21/Oracle-Window-SqlPlus-Garbled-Code-1/">Oracle-Window-SqlPlus-Garbled-Code-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/03/21/Docker-Run-Cmd-1/">Docker-Run-Cmd-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/03/19/Linux-Supervisor-Base-1/">Linux-Supervisor-Base-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/03/19/Linux-Swap-Add-1/">Linux-Swap-Add-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/03/19/Oracle-Implementation-Plan-1/">Oracle-Implementation-Plan-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/03/19/Nmap-Tool-Base-1/">Nmap-Tool-Base-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/03/19/Sublime3-Case-Switch-1/">Sublime3-Case-Switch-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/03/19/Oracle-NULL-Value-1/">Oracle-NULL-Value-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/03/19/Oracle-Enter-Line-Feed-1/">Oracle-Enter-Line-Feed-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/03/19/Oracle-Flashback-1/">Oracle-Flashback-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/02/28/Oracle-DML-Performance-1/">Oracle-DML-Performance-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/02/28/Oracle-Trigger-System-1/">Oracle-Trigger-System-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/02/28/Oracle-Trigger-DDL-1/">Oracle-Trigger-DDL-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/02/28/Oracle-Trigger-DML-1/">Oracle-Trigger-DML-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/02/28/Oracle-Trigger-1/">Oracle-Trigger-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/02/25/VIEW-TRANSFER-PARAMETERS-1/">VIEW-TRANSFER-PARAMETERS-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/02/21/Oracle-Start-With-Connect-By-1/">Oracle-Start-With-Connect-By-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/02/21/Oracle-Date-Case-1/">Oracle-Date-Case-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/01/19/Git-Gogs-Window-Install-1/">Git-Gogs-Window-Install-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/01/14/Hexo-Blog-Change-PC-1/">Hexo-Blog-Change-PC-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/01/14/Jboss-Cmd-Line-1/">Jboss-Cmd-Line-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/01/14/Jboss-Standalone-Config-1/">Jboss-Standalone-Config-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/01/13/Oracle-Table-Information-1/">Oracle-Table-Information-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/01/13/Git-Server-Supplement-3/">Git-Server-Supplement-3</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/01/13/AirTest-Introduction-Config-1/">AirTest-Introduction-Config-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/01/10/Window-Nirsoft-Tools-1/">Window-Nirsoft-Tools-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/01/10/SQLite-Introduction-1/">SQLite-Introduction-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/01/07/Git-Server-Supplement-2/">Git-Server-Supplement-2</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/01/07/Report-Data-Type-Conversion-Error-1/">Report-Data-Type-Conversion-Error-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/01/06/Oracle-ROWNUM-1/">Oracle-ROWNUM-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/01/05/Jaspersoft-Studio-Hidden-1/">Jaspersoft-Studio-Hidden-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/01/05/Java-Jboss-EJB-Project-Deploy-1/">Java-Jboss-EJB-Project-Deploy-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/01/05/Oracle-Create-Table-Case-1/">Oracle-Create-Table-Case-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/01/05/Oracle-Row-Column-Conversion-1/">Oracle-Row-Column-Conversion-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/01/05/Oracle-Decode-1/">Oracle-Decode-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/01/05/Git-Server-Supplement-1/">Git-Server-Supplement-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/01/05/Oracle-Table-Connection-1/">Oracle-Table-Connection-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/01/05/Window-Kill-Process-1/">Window-Kill-Process-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/01/05/JavaSourceCode-SearchMethod-1/">JavaSourceCode-SearchMethod-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/12/18/Lightroom-Base-3/">Lightroom-Base-3</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/12/18/Lightroom-Base-2/">Lightroom-Base-2</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/12/18/Lightroom-Base-1/">Lightroom-Base-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/12/04/Scrapy-Basics-1/">Scrapy-Basics-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/12/04/Ireport-Install-1/">Ireport-Install-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/12/04/Jaspersoft-Studio-Master-Child-Table-2/">Jaspersoft-Studio-Master-Child-Table-2</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/12/04/Jaspersoft-Studio-Master-Child-Table-1/">Jaspersoft-Studio-Master-Child-Table-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/12/04/Jaspersoft-Studio-Install-1/">Jaspersoft-Studio-Install-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/12/04/Oracle-Type-Table-1/">Oracle-Type-Table-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/12/04/Oracle-Exists-And-In-1/">Oracle-Exists-And-In-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/11/12/Linux-Kali-Install-1/">Linux-Kali-Install-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/11/12/Oracle-19c-Debain-Install/">Oracle-19c-Debain-Install</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/11/12/Linux-DPKG-BUG-1/">Linux-DPKG-BUG-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/11/12/SQL-Interview-Questions2/">SQL-Interview-Questions2</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/10/31/Photography-Introduction-1/">Photography-Introduction-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/10/31/Graduation-Thesis-Guidance-2/">Graduation-Thesis-Guidance-2</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/09/22/Graduation-Thesis-Guidance-1/">Graduation-Thesis-Guidance-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/06/13/Rogue-Software-Process/">Rogue-Software-Process</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/06/13/House-Lease-Contract-Template/">House-Lease-Contract-Template</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/06/05/Linux-Start-Fail-1/">Linux-Start-Fail-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/06/02/JAVA-Thread-Base-8/">JAVA-Thread-Base-8</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/06/02/JAVA-Thread-Base-7/">JAVA-Thread-Base-7</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/06/02/JAVA-Thread-Base-6/">JAVA-Thread-Base-6</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/06/01/JAVA-Thread-Base-5/">JAVA-Thread-Base-5</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/06/01/JAVA-Thread-Base-4/">JAVA-Thread-Base-4</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/31/JAVA-Thread-Base-3/">JAVA-Thread-Base-3</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/31/JAVA-Thread-Base-2/">JAVA-Thread-Base-2</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/31/JAVA-Thread-Base-1/">JAVA-Thread-Base-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/30/JAVA-Actual-Combat-6/">JAVA-Actual-Combat-6</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/28/JAVA-Actual-Combat-5/">JAVA-Actual-Combat-5</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/28/JAVA-Actual-Combat-4/">JAVA-Actual-Combat-4</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/28/JAVA-Actual-Combat-3/">JAVA-Actual-Combat-3</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/28/JAVA-Actual-Combat-2/">JAVA-Actual-Combat-2</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/28/JAVA-Actual-Combat-1/">JAVA-Actual-Combat-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/27/Spring-Security-BASE-3/">Spring-Security-BASE-3</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/27/Spring-Security-BASE-2/">Spring-Security-BASE-2</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/24/Spring-Security-BASE-1/">Spring-Security-BASE-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/24/Netty-BASE-3/">Netty-BASE-3</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/22/Netty-BASE-2/">Netty-BASE-2</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/20/Netty-BASE-1/">Netty-BASE-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/20/SpringBoot2-BASE-8/">SpringBoot2-BASE-8</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/20/SpringBoot2-BASE-7/">SpringBoot2-BASE-7</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/20/SpringBoot2-BASE-6/">SpringBoot2-BASE-6</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/20/SpringBoot2-BASE-5/">SpringBoot2-BASE-5</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/20/SpringBoot2-BASE-4/">SpringBoot2-BASE-4</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/20/SpringBoot2-BASE-3/">SpringBoot2-BASE-3</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/19/SpringBoot2-BASE-2/">SpringBoot2-BASE-2</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/19/SpringBoot2-BASE-1/">SpringBoot2-BASE-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/16/Spring-BASE-7/">Spring-BASE-7</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/16/Spring-BASE-6/">Spring-BASE-6</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/16/Spring-BASE-5/">Spring-BASE-5</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/16/Spring-BASE-4/">Spring-BASE-4</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/16/Spring-BASE-3/">Spring-BASE-3</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/16/Spring-BASE-2/">Spring-BASE-2</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/16/Spring-BASE-1/">Spring-BASE-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/12/JAVA-Stack-1/">JAVA-Stack-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/12/JAVA-Linked-List-1/">JAVA-Linked-List-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/12/JAVA-Arrays-Queues-1/">JAVA-Arrays-Queues-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/12/JAVA-SE-1/">JAVA-SE-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/12/JAVA-Spring-AOP-1/">JAVA-Spring-AOP-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/12/JAVA-Spring/">JAVA-Spring</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/12/JAVA-SpringMVC-1/">JAVA-SpringMVC-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/11/JAVA-RabbitMQ-1/">JAVA-RabbitMQ-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/11/SpringCloud-Snowflake-Algorithm/">SpringCloud-Snowflake-Algorithm</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/11/SpringCloud-Alibaba-Seata-1/">SpringCloud-Alibaba-Seata-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/10/SpringCloud-Alibaba-Sentinel-1/">SpringCloud-Alibaba-Sentinel-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/09/SpringCloud-Alibaba-Nacos-1/">SpringCloud-Alibaba-Nacos-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/09/SpringCloud-Alibaba-1/">SpringCloud-Alibaba-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/08/SpringCloud-Sleuth-1/">SpringCloud-Sleuth-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/08/SpringCloud-Stream-1/">SpringCloud-Stream-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/08/SpringCloud-Bus-1/">SpringCloud-Bus-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/08/SpringCloud-Config-1/">SpringCloud-Config-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/07/SpringCloud-GateWay-1/">SpringCloud-GateWay-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/07/SpringCloud-Hystrix-1/">SpringCloud-Hystrix-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/06/SpringCloud-OpenFeign-1/">SpringCloud-OpenFeign-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/06/SpringCloud-Ribbon-1/">SpringCloud-Ribbon-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/06/SpringCloud-RegistrySummary-1/">SpringCloud-RegistrySummary-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/06/SpringCloud-Consul-1/">SpringCloud-Consul-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/06/Zookeeper-Command-1/">Zookeeper-Command-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/06/SpringCloud-Zookeeper-1/">SpringCloud-Zookeeper-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/04/SpringCloud-Eureka-1/">SpringCloud-Eureka-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/03/Java-Interview-Questions/">Java-Interview-Questions</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/04/21/Maven-Import-NotOpenJar/">Maven-Import-NotOpenJar</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/04/21/OpenFeign-And-Sentinel/">OpenFeign-And-Sentinel</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/04/21/Nacos-Install/">Nacos-Install</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/04/21/Apache-JMeter-Simple-Use/">Apache-JMeter-Simple-Use</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/03/07/Spring-Boot-Start-Extension/">Spring-Boot-Start-Extension</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/03/07/Spring-Boot-Cycle1/">Spring-Boot-Cycle1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/03/07/Mysql-Usage-Habit/">Mysql-Usage-Habit</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/03/06/Mysql-Procedure-HTML-Report/">Mysql-Procedure-HTML-Report</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/03/06/K8S-Dashboard/">K8S-Dashboard</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/02/27/K8S-Coredns-1/">K8S-Coredns-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/02/27/K8S-Flannel/">K8S-Flannel</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/02/27/Nginx-ShareFile/">Nginx-ShareFile</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/02/21/Mysql-Install/">Mysql-Install</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/02/21/K8S-Kubectl-Command/">K8S-Kubectl-Command</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/02/21/Java-Apache-Maven/">Java-Apache-Maven</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/02/21/Java-SprintBoot-Error1/">Java-SprintBoot-Error1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/02/18/K8S-Binary-Install/">K8S-Binary-Install</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/02/15/Oracle-Clean-Archivelog/">Oracle-Clean-Archivelog</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/02/15/Docker-Harbor/">Docker-Harbor</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/02/15/Docker-Compose/">Docker-Compose</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/02/15/Yaml-Language/">Yaml_Language</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/02/12/Docker-Network-Operation/">Docker-Network-Operation</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/02/11/Docker-Add-New-Volume/">Docker-Add-New-Volume</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/02/11/Docker-Auto-Start/">Docker-Auto-Start</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/02/11/Docker-Registry/">Docker-Registry</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/02/11/Docker-Dockerfile/">Docker-Dockerfile</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/02/11/Docker-NetworkMode/">Docker-NetworkMode</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/02/11/Docker-Volume/">Docker-Volume</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/02/11/Docker-PortMapping/">Docker-PortMapping</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/02/11/Docker-Command1/">Docker-Command1</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/02/10/Docker-Mirror-Acceleration/">Docker-Mirror-Acceleration</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/02/10/Linux-NetworkCard-Rename/">Linux-NetworkCard-Rename</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/02/06/Rancher-Install/">Rancher-Install</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/02/06/Hexo-Blog-Character-Escape/">Hexo-Blog-Character-Escape</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/02/06/Mysql-Procedure-HTML/">Mysql-Procedure-HTML</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/02/06/Mysql-Procedure-Leave/">Mysql-Procedure-Leave</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/01/17/UsbEAmHostsEditor/">UsbEAmHostsEditor</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/01/02/Postgres-Command/">Postgres-Command</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/01/02/Mysql-Storage-Engine/">Mysql-Storage-Engine</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/01/02/Elasticsearch-Cluster-Node-Parameters/">Elasticsearch-Cluster-Node-Parameters</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/01/02/Linux-Elasticsearch-Install/">Linux-Elasticsearch-Install</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/01/02/Linux-Python-File-Sync/">Linux-Python-File-Sync</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/01/02/Window-Process/">Window-Process</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/01/02/Mysql-Lock-1205/">Mysql-Lock-1205</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/12/26/Hexo-Blog-1/">Hexo-Blog-1</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/12/26/Python-SQLalchemy1/">Python-SQLalchemy1</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/12/26/Window-Regedit-Server/">Window-Regedit-Server</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/12/26/Linux-TinyProxy/">Linux-TinyProxy</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/12/26/Mysql-Procedure3/">Mysql-Procedure3</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/12/26/Mysql-Procedure2/">Mysql-Procedure2</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/11/22/Git-Server/">Git-Server</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/11/22/Git-Local/">Git-Local</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/11/22/Mysql-History/">Mysql-History</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/11/21/Mysql-Procedure1/">Mysql-Procedure1</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/11/21/Mysql-Log-Restore/">Mysql-Log-Restore</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/11/21/Tomcat-Configuration/">Tomcat-Configuration</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/11/21/Spring-Boot-Packing/">Spring-Boot-Packing</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/10/31/Spring-Boot-BestProject/">Spring-Boot-BestProject</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/10/06/Mysql-Windows-Install/">Mysql-Windows-Install</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/10/04/MongoDB-Install/">MongoDB-Install</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/10/02/Oracle-Name-Explain/">Oracle-Name-Explain</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/10/02/Oracle-LimitConnection/">Oracle-LimitConnection</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/10/02/Oracle-ConnResource1/">Oracle-ConnResource1</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/10/02/Redis-Cluster/">Redis-Cluster</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/10/02/Redis-Sentinel/">Redis-Sentinel</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/10/02/Redis-Part-Copy-Principle/">Redis-Part-Copy-Principle</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/10/02/Redis-Copy-Principle/">Redis-Copy-Principle</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/10/02/Redis-Copy/">Redis-Copy</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/10/02/Redis-Memory-Mode/">Redis-Memory-Mode</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/10/02/Redis-Persistence-Principle/">Redis-Persistence-Principle</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/10/02/Redis-Persistence/">Redis-Persistence</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/10/02/Redis-Install/">Redis-Install</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/09/26/Postgres-PGPool-II/">Postgres-PGPool-II</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/09/26/Postgres-Copy/">Postgres-Copy</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/09/26/Postgres-Backup/">Postgres-Backup</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/09/26/Postgres-Install/">Postgres-Install</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/07/18/SQL-Interview-Questions1/">SQL-Interview-Questions1</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/07/18/Linux-Update-GCC9-3-0/">Linux-Update-GCC9.3.0</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/07/18/Mysql-XtraBackup/">Mysql-XtraBackup</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/07/18/Mysql-MysqlDump/">Mysql-MysqlDump</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/07/12/Window-USB-Disk/">Window-USB-Disk</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/07/12/Window-NTP/">Window-NTP</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/07/12/MongDB-Backup/">MongDB-Backup</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/07/12/MongDB-Copy-Cluster/">MongDB-Copy-Cluster</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/07/11/Oracle-RAC-CmdSimple/">Oracle-RAC-CmdSimple</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/07/11/Oracle-RAC1/">Oracle-RAC1</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/07/11/Oracle-DG2/">Oracle-DG2</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/07/08/Linux-OpenSSH-Update/">Linux-OpenSSH-Update</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/04/04/Corosync-Pacemaker-CRM/">Corosync-Pacemaker-CRM</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/04/04/CRM-Parameter/">CRM-Parameter</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/04/04/CentOS-Mail-Client/">CentOS-Mail-Client</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/04/04/CentOS-Mail-Address/">CentOS-Mail-Address</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/04/04/Oracle-Backup-RMAN/">Oracle-Backup-RMAN</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/04/04/Oracle-Backup-EXP/">Oracle-Backup-EXP</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/04/04/Oracle-DG-Multiple-Nodes/">Oracle-DG-Multiple-Nodes</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/04/04/Zabbix-Install/">Zabbix-Install</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/04/04/Linux-NTP/">Linux-NTP</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/04/04/Oracle-Patrol-Other/">Oracle-Patrol-Other</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/04/04/Oracle-Patrol-Security/">Oracle-Patrol-Security</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/04/04/Oracle-Patrol-CPU-IO-MEM/">Oracle-Patrol-CPU-IO-MEM</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/04/04/Oracle-Patrol-Performance/">Oracle-Patrol-Performance</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/04/04/Oracle-Patrol-Backup/">Oracle-Patrol-Backup</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/04/04/Oracle-Patrol-Use/">Oracle-Patrol-Use</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/04/04/Oracle-Patrol-Base/">Oracle-Patrol-Base</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/04/04/Oracle-Fragment/">Oracle-Fragment</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/04/04/Oracle-RAC-Summary/">Oracle-RAC-Summary</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/04/04/VMware-ShareDisk/">VMware-ShareDisk</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/04/04/Oracle-DG1/">Oracle-DG1</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/04/04/Mariadb-Copy/">Mariadb-Copy</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/04/04/Linux-SSH/">Linux-SSH</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/04/04/Linux-DRBD/">Linux-DRBD</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/04/04/Linux-LVM/">Linux_LVM</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/04/03/MyFirstBlog/">MyFirstBlog</a></li></ul>




    <script>
        
    </script>
</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                <i class="fa fa-copyright"></i> 
                2016-2023 Sevattal
            </div>
            <!--<div class="footer-right">
                <a href="http://hexo.io/" target="_blank" title="A fast, simple &amp; powerful blog framework">Hexo</a>  Theme <a href="https://github.com/MOxFIVE/hexo-theme-yelee" target="_blank" title="Another simple and elegant theme for Hexo  v3.5">Yelee</a> by MOxFIVE <i class="fa fa-heart animated infinite pulse"></i>
            </div>-->
        </div>
        
            <div class="visit">
                
                    <span id="busuanzi_container_site_pv" style='display:none'>
                        <span id="site-visit" title="Site Visitors"><i class="fa fa-user" aria-hidden="true"></i><span id="busuanzi_value_site_uv"></span>
                        </span>
                    </span>
                
                
                    <span>| </span>
                
                
                    <span id="busuanzi_container_page_pv" style='display:none'>
                        <span id="page-visit"  title="Page Hits"><i class="fa fa-eye animated infinite pulse" aria-hidden="true"></i><span id="busuanzi_value_page_pv"></span>
                        </span>
                    </span>
                
            </div>
        
    </div>
</footer>
    </div>
    
<script data-main="/js/main.js" src="//cdn.bootcss.com/require.js/2.2.0/require.min.js"></script>

    <script>
        $(document).ready(function() {
            var iPad = window.navigator.userAgent.indexOf('iPad');
            if (iPad > -1 || $(".left-col").css("display") === "none") {
                var bgColorList = ["#9db3f4", "#414141", "#e5a859", "#f5dfc6", "#c084a0", "#847e72", "#cd8390", "#996731"];
                var bgColor = Math.ceil(Math.random() * (bgColorList.length - 1));
                $("body").css({"background-color": bgColorList[bgColor], "background-size": "cover"});
            }
            else {
                var backgroundnum = 5;
                var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
                $("body").css({"background": backgroundimg, "background-attachment": "fixed", "background-size": "cover"});
            }
        })
    </script>





<div class="scroll" id="scroll">
    <a href="#" title="Back to Top"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments" onclick="load$hide();" title="Comments"><i class="fa fa-comments-o"></i></a>
    <a href="#footer" title="Go to Bottom"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    // Open in New Window
    
        $("a[target=_blank]").removeAttr("target");
    
</script>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
  </div>
</body>
</html>